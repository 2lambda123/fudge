<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>resonances Package &mdash; Fudge and GND 1.3 beta documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.3 beta',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../_static/gnd-20121206-favicon.ico"/>
    <link rel="top" title="Fudge and GND 1.3 beta documentation" href="../index.html" />
    <link rel="up" title="processing Package" href="fudge.processing.html" />
    <link rel="next" title="structure Package" href="fudge.structure.html" />
    <link rel="prev" title="montecarlo Package" href="fudge.processing.montecarlo.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="fudge.structure.html" title="structure Package"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="fudge.processing.montecarlo.html" title="montecarlo Package"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Fudge and GND 1.3 beta documentation</a> &raquo;</li>
          <li><a href="index.html" >fudge Package</a> &raquo;</li>
          <li><a href="fudge.processing.html" accesskey="U">processing Package</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="resonances-package">
<h1>resonances Package<a class="headerlink" href="#resonances-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id1">
<h2><tt class="xref py py-mod docutils literal"><span class="pre">resonances</span></tt> Package<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-fudge.processing.resonances"></span></div>
<div class="section" id="module-fudge.processing.resonances.fudgeReconstructResonances">
<span id="fudgereconstructresonances-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">fudgeReconstructResonances</span></tt> Module<a class="headerlink" href="#module-fudge.processing.resonances.fudgeReconstructResonances" title="Permalink to this headline">¶</a></h2>
<p>reconstruct resonance region
cmattoon, 12/1/2010</p>
<p>See ENDF-102 (endf documentation) appendix D for equations</p>
<div class="section" id="basic-usage">
<h3>Basic usage:<a class="headerlink" href="#basic-usage" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>if x is a reactionSuite instance,:</p>
<div class="highlight-python"><div class="highlight"><pre>&gt;&gt;xsecs = fudgeReconstructResonances.reconstructResonances(x, tolerance=0.01)
</pre></div>
</div>
<p>This reconstructs all resolved/unresolved resonance sections. In each section,
the results are accurate under linear interpolation to tolerance of 1% or better.
All sections are summed together.:</p>
<div class="highlight-python"><div class="highlight"><pre>* xsecs = dictionary containing cross sections: {&#39;total&#39;:XYs, &#39;elastic&#39;:XYs, ...}
</pre></div>
</div>
<p>each cross section is an XYs class instance, containing data and also axes with units</p>
</div></blockquote>
</div>
<div class="section" id="alternate-use">
<h3>Alternate use:<a class="headerlink" href="#alternate-use" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>If desired, reconstruct a single section:</p>
<div class="highlight-python"><div class="highlight"><pre>&gt;&gt; resCls = fudgeReconstructResonances.RMcrossSection(x)   # for Reich_Moore
&gt;&gt; energy_grid = s.generateEnergyGrid()
&gt;&gt; crossSections = s.getCrossSection( energy_grid )
# the input to getCrossSection is the energy (or list of energies) in eV
# crossSections are returned as a dictionary {&#39;total&#39;:,&#39;elastic&#39;:,&#39;capture&#39;:,&#39;fission&#39;:,}

# improve grid to desired tolerance for linear interpolation:
&gt;&gt; new_energy_grid, new_crossSections, messages = s.refineInterpolation(energy_grid, crossSections, tolerance=0.01)
</pre></div>
</div>
</div></blockquote>
<dl class="class">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.ChannelDesignator">
<em class="property">class </em><tt class="descclassname">fudge.processing.resonances.fudgeReconstructResonances.</tt><tt class="descname">ChannelDesignator</tt><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.ChannelDesignator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">tuple</span></tt></p>
<p>ChannelDesignator(l, J, reaction, index, s, gfact, particleA, particleB, useCoulomb, useRelativistic, eliminated)</p>
<dl class="attribute">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.ChannelDesignator.J">
<tt class="descname">J</tt><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.ChannelDesignator.J" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.ChannelDesignator.eliminated">
<tt class="descname">eliminated</tt><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.ChannelDesignator.eliminated" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 10</p>
</dd></dl>

<dl class="attribute">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.ChannelDesignator.gfact">
<tt class="descname">gfact</tt><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.ChannelDesignator.gfact" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="attribute">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.ChannelDesignator.index">
<tt class="descname">index</tt><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.ChannelDesignator.index" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="attribute">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.ChannelDesignator.l">
<tt class="descname">l</tt><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.ChannelDesignator.l" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.ChannelDesignator.particleA">
<tt class="descname">particleA</tt><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.ChannelDesignator.particleA" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

<dl class="attribute">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.ChannelDesignator.particleB">
<tt class="descname">particleB</tt><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.ChannelDesignator.particleB" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="attribute">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.ChannelDesignator.reaction">
<tt class="descname">reaction</tt><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.ChannelDesignator.reaction" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="attribute">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.ChannelDesignator.s">
<tt class="descname">s</tt><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.ChannelDesignator.s" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="attribute">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.ChannelDesignator.useCoulomb">
<tt class="descname">useCoulomb</tt><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.ChannelDesignator.useCoulomb" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 8</p>
</dd></dl>

<dl class="attribute">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.ChannelDesignator.useRelativistic">
<tt class="descname">useRelativistic</tt><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.ChannelDesignator.useRelativistic" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 9</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.MLBWcrossSection">
<em class="property">class </em><tt class="descclassname">fudge.processing.resonances.fudgeReconstructResonances.</tt><tt class="descname">MLBWcrossSection</tt><big>(</big><em>reactionSuite</em>, <em>sectionIndex=None</em>, <em>enableAngDists=False</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#MLBWcrossSection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.MLBWcrossSection" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass" title="fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass"><tt class="xref py py-class docutils literal"><span class="pre">fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass</span></tt></a></p>
<p>Given a resonance region in MLBW format,
create a class with all data required to reconstruct</p>
<p>Only the elastic channel differs from SLBW</p>
<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.MLBWcrossSection.getChannelConstantsBc">
<tt class="descname">getChannelConstantsBc</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#MLBWcrossSection.getChannelConstantsBc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.MLBWcrossSection.getChannelConstantsBc" title="Permalink to this definition">¶</a></dt>
<dd><p>For ENDF&#8217;s MLBW, should be</p>
<blockquote>
<div><dl class="docutils">
<dt>..math::</dt>
<dd>B_c = <a href="#id8"><span class="problematic" id="id9">S_</span></a>ell(<a href="#id2"><span class="problematic" id="id3">|E_\lambda|</span></a>)</dd>
</dl>
</div></blockquote>
<p>where $ell$ is the channel angular momentum and $lambda$ is the resonances index for the channel</p>
</dd></dl>

<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.MLBWcrossSection.getCrossSection">
<tt class="descname">getCrossSection</tt><big>(</big><em>E</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#MLBWcrossSection.getCrossSection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.MLBWcrossSection.getCrossSection" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.MLBWcrossSection.getScatteringMatrixU">
<tt class="descname">getScatteringMatrixU</tt><big>(</big><em>Ein</em>, <em>useTabulatedScatteringRadius=True</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#MLBWcrossSection.getScatteringMatrixU"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.MLBWcrossSection.getScatteringMatrixU" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the scattering matrix.  We could have used the generic U function in the base class, 
but Froehner has &#8220;simplifications&#8221; that we took advantage of here (that and I don&#8217;t know what the 
R matrix is exactly in the case of MLBW).</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.RMatrixLimitedcrossSection">
<em class="property">class </em><tt class="descclassname">fudge.processing.resonances.fudgeReconstructResonances.</tt><tt class="descname">RMatrixLimitedcrossSection</tt><big>(</big><em>reactionSuite</em>, <em>sectionIndex=None</em>, <em>enableAngDists=False</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#RMatrixLimitedcrossSection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.RMatrixLimitedcrossSection" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass" title="fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass"><tt class="xref py py-class docutils literal"><span class="pre">fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass</span></tt></a></p>
<p>extended Reich_Moore (LRF=7 in ENDF)
Here, resonances are sorted primarily by J: within each &#8216;spin group&#8217;, total J is conserved
One or more competitive channels may be used in this case.
Also, each resonance may have contributions from multiple l-waves</p>
<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.RMatrixLimitedcrossSection.coulombPenetrationFactor">
<tt class="descname">coulombPenetrationFactor</tt><big>(</big><em>L</em>, <em>rho</em>, <em>eta</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#RMatrixLimitedcrossSection.coulombPenetrationFactor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.RMatrixLimitedcrossSection.coulombPenetrationFactor" title="Permalink to this definition">¶</a></dt>
<dd><p>for competitive channels with 2 charged particles, 
calculate coulomb wavefunctions and penetrability.
Here we use an external subroutine &#8216;coulfg2&#8217; from Thompson et al, converted to c and wrapped</p>
</dd></dl>

<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.RMatrixLimitedcrossSection.eta">
<tt class="descname">eta</tt><big>(</big><em>E</em>, <em>pA</em>, <em>pB</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#RMatrixLimitedcrossSection.eta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.RMatrixLimitedcrossSection.eta" title="Permalink to this definition">¶</a></dt>
<dd><p>for competitive channels with 2 charged particles,
parameter eta used to find penetrability. eq D.79 in ENDF manual:</p>
</dd></dl>

<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.RMatrixLimitedcrossSection.getChannelConstantsBc">
<tt class="descname">getChannelConstantsBc</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#RMatrixLimitedcrossSection.getChannelConstantsBc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.RMatrixLimitedcrossSection.getChannelConstantsBc" title="Permalink to this definition">¶</a></dt>
<dd><p>For ENDF&#8217;s Reich-Moore, should be</p>
<blockquote>
<div><dl class="docutils">
<dt>..math::</dt>
<dd>B_c = -ell</dd>
</dl>
</div></blockquote>
<p>where $ell$ is the channel angular momentum</p>
</dd></dl>

<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.RMatrixLimitedcrossSection.getCrossSection">
<tt class="descname">getCrossSection</tt><big>(</big><em>E</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#RMatrixLimitedcrossSection.getCrossSection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.RMatrixLimitedcrossSection.getCrossSection" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.RMatrixLimitedcrossSection.k_competitive">
<tt class="descname">k_competitive</tt><big>(</big><em>E</em>, <em>pA</em>, <em>pB</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#RMatrixLimitedcrossSection.k_competitive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.RMatrixLimitedcrossSection.k_competitive" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate k for any 2-body output channel. Note that if pA and pB are target and neutron,
this reduces to self.k(E) as defined above in the resonanceReconstructionBaseClass</p>
</dd></dl>

<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.RMatrixLimitedcrossSection.rho">
<tt class="descname">rho</tt><big>(</big><em>E</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#RMatrixLimitedcrossSection.rho"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.RMatrixLimitedcrossSection.rho" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.RMcrossSection">
<em class="property">class </em><tt class="descclassname">fudge.processing.resonances.fudgeReconstructResonances.</tt><tt class="descname">RMcrossSection</tt><big>(</big><em>reactionSuite</em>, <em>sectionIndex=None</em>, <em>enableAngDists=False</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#RMcrossSection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.RMcrossSection" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass" title="fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass"><tt class="xref py py-class docutils literal"><span class="pre">fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass</span></tt></a></p>
<p>simplified Reich_Moore (LRF=3 in ENDF)
More complex than Breit-Wigner approximations, but we can still use same __init__</p>
<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.RMcrossSection.getChannelConstantsBc">
<tt class="descname">getChannelConstantsBc</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#RMcrossSection.getChannelConstantsBc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.RMcrossSection.getChannelConstantsBc" title="Permalink to this definition">¶</a></dt>
<dd><p>For ENDF&#8217;s Reich-Moore, should be</p>
<blockquote>
<div><dl class="docutils">
<dt>..math::</dt>
<dd>B_c = -ell</dd>
</dl>
</div></blockquote>
<p>where $ell$ is the channel angular momentum</p>
<p>what is not clearly stated in the ENDF manual is that Bc = 0 for this case</p>
</dd></dl>

<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.RMcrossSection.getCrossSection">
<tt class="descname">getCrossSection</tt><big>(</big><em>E</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#RMcrossSection.getCrossSection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.RMcrossSection.getCrossSection" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.RMcrossSection.getL0Matrix">
<tt class="descname">getL0Matrix</tt><big>(</big><em>Ein</em>, <em>Bc=None</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#RMcrossSection.getL0Matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.RMcrossSection.getL0Matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the L0 matrix of Froehner:</p>
<blockquote>
<div><p>..math:</p>
<div class="highlight-python"><div class="highlight"><pre>{f L^0}_{cc&#39;} = \delta_{cc&#39;} (L_c-B_c) 
</pre></div>
</div>
</div></blockquote>
<p>where</p>
<blockquote>
<div><p>..math:</p>
<div class="highlight-python"><div class="highlight"><pre>L_c = S_c + i P_c
</pre></div>
</div>
</div></blockquote>
<p>But.... ENDF&#8217;s RM formulation uses a shift of 0 and a Bc of 0!!!</p>
</dd></dl>

<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.RMcrossSection.getRMatrix">
<tt class="descname">getRMatrix</tt><big>(</big><em>Ein</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#RMcrossSection.getRMatrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.RMcrossSection.getRMatrix" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>The R matrix in the Reich-Moore approximation:</p>
<blockquote>
<div><p>..math:</p>
<div class="highlight-python"><div class="highlight"><pre>R_{cc&#39;} = \sum_\lambda 
</pre></div>
</div>
</div></blockquote>
</div></blockquote>
<p>rac{gamma_{lambda c}gamma_{lambda c&#8217;}{<a href="#id10"><span class="problematic" id="id11">E_</span></a>lambda - E - iGamma_{lambdagamma}/2}</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass">
<em class="property">class </em><tt class="descclassname">fudge.processing.resonances.fudgeReconstructResonances.</tt><tt class="descname">RRBaseClass</tt><big>(</big><em>reactionSuite</em>, <em>sectionIndex=None</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#RRBaseClass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#fudge.processing.resonances.fudgeReconstructResonances.resonanceReconstructionBaseClass" title="fudge.processing.resonances.fudgeReconstructResonances.resonanceReconstructionBaseClass"><tt class="xref py py-class docutils literal"><span class="pre">fudge.processing.resonances.fudgeReconstructResonances.resonanceReconstructionBaseClass</span></tt></a></p>
<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass.generateEnergyGrid">
<tt class="descname">generateEnergyGrid</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#RRBaseClass.generateEnergyGrid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass.generateEnergyGrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an initial energy grid by merging a rough mesh for the entire region (~10 points / decade)
with a denser grid around each resonance. For the denser grid, multiply the total resonance width by
the &#8216;resonancePos&#8217; array defined below.</p>
</dd></dl>

<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass.getAMatrix">
<tt class="descname">getAMatrix</tt><big>(</big><em>Ein</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#RRBaseClass.getAMatrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass.getAMatrix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass.getAngularDistribution">
<tt class="descname">getAngularDistribution</tt><big>(</big><em>E</em>, <em>keepL0Term=True</em>, <em>renormalize=True</em>, <em>reaction1='elastic'</em>, <em>reaction2='elastic'</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#RRBaseClass.getAngularDistribution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass.getAngularDistribution" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass.getChannelConstantsBc">
<tt class="descname">getChannelConstantsBc</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#RRBaseClass.getChannelConstantsBc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass.getChannelConstantsBc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass.getEiPhis">
<tt class="descname">getEiPhis</tt><big>(</big><em>Ein</em>, <em>useTabulatedScatteringRadius=True</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#RRBaseClass.getEiPhis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass.getEiPhis" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>The phase factor for the collision matrix:</p>
<blockquote>
<div><p>..math:</p>
<div class="highlight-python"><div class="highlight"><pre>\Omega_c = e^{-
</pre></div>
</div>
</div></blockquote>
</div></blockquote>
<p>arphi_c}</p>
</dd></dl>

<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass.getKMatrix">
<tt class="descname">getKMatrix</tt><big>(</big><em>Ein</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#RRBaseClass.getKMatrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass.getKMatrix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass.getL0Matrix">
<tt class="descname">getL0Matrix</tt><big>(</big><em>Ein</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#RRBaseClass.getL0Matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass.getL0Matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the L0 matrix of Froehner:</p>
<blockquote>
<div><p>..math:</p>
<div class="highlight-python"><div class="highlight"><pre>{f L^0}_{cc&#39;} = \delta_{cc&#39;} (L_c-B_c) 
</pre></div>
</div>
</div></blockquote>
<p>where</p>
<blockquote>
<div><p>..math:</p>
<div class="highlight-python"><div class="highlight"><pre>L_c = S_c + i P_c
</pre></div>
</div>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass.getRMatrix">
<tt class="descname">getRMatrix</tt><big>(</big><em>Ein</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#RRBaseClass.getRMatrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass.getRMatrix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass.getScatteringMatrixU">
<tt class="descname">getScatteringMatrixU</tt><big>(</big><em>Ein</em>, <em>useTabulatedScatteringRadius=True</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#RRBaseClass.getScatteringMatrixU"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass.getScatteringMatrixU" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the scattering matrix using</p>
</dd></dl>

<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass.getWMatrix">
<tt class="descname">getWMatrix</tt><big>(</big><em>Ein</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#RRBaseClass.getWMatrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass.getWMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the W matrix for use in computing U.  W is:</p>
<blockquote>
<div><p>..math:</p>
<div class="highlight-python"><div class="highlight"><pre>{f W} = {f I} + 2i{f X}
</pre></div>
</div>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass.getXMatrix">
<tt class="descname">getXMatrix</tt><big>(</big><em>Ein</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#RRBaseClass.getXMatrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass.getXMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the X matrix for use in computing W.  X is:</p>
<blockquote>
<div><p>..math:</p>
<div class="highlight-python"><div class="highlight"><pre>{f X}_{cc&#39;} = P^{-1/2}_c ( ( {f I} - {f R}{f L^0} )^{-1}{f R} )_{cc&#39;} P_{c&#39;}^{-1/2}\delta_{JJ&#39;}
</pre></div>
</div>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass.rho">
<tt class="descname">rho</tt><big>(</big><em>E</em>, <em>L=None</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#RRBaseClass.rho"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass.rho" title="Permalink to this definition">¶</a></dt>
<dd><p>get the channel radius, rho. If L is specified try to get L-dependent value</p>
</dd></dl>

<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass.setResonanceParametersByChannel">
<tt class="descname">setResonanceParametersByChannel</tt><big>(</big><em>multipleSScheme='NJOY'</em>, <em>useReichMooreApproximation=False</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#RRBaseClass.setResonanceParametersByChannel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass.setResonanceParametersByChannel" title="Permalink to this definition">¶</a></dt>
<dd><p>Reorganize member data into channels (relies heavily on groundwork in sortLandJ).</p>
</dd></dl>

<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass.sortLandJ">
<tt class="descname">sortLandJ</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#RRBaseClass.sortLandJ"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass.sortLandJ" title="Permalink to this definition">¶</a></dt>
<dd><p>SLBW, MLBW and Reich_Moore formalisms have similar structure
it&#8217;s convenient to sort their resonances by L and J
This method should NOT be used for R-Matrix Limited</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.SLBWcrossSection">
<em class="property">class </em><tt class="descclassname">fudge.processing.resonances.fudgeReconstructResonances.</tt><tt class="descname">SLBWcrossSection</tt><big>(</big><em>reactionSuite</em>, <em>sectionIndex=None</em>, <em>enableAngDists=False</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#SLBWcrossSection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.SLBWcrossSection" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass" title="fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass"><tt class="xref py py-class docutils literal"><span class="pre">fudge.processing.resonances.fudgeReconstructResonances.RRBaseClass</span></tt></a></p>
<p>given a resonance region in SLBW format,
create a class with all data required to reconstruct</p>
<p>Note, the resonances in the SLBW format each correspond to different &#8220;levels&#8221; and so do not
interfere.  This is unlike all of the other RRR formats.  So, while one resonance energy 
and one width go with one channel and all the channels associated with one resonance energy 
go together to make one reaction, the reactions for each resonance are added incoherently (no
interference effects at all).</p>
<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.SLBWcrossSection.getAngularDistribution">
<tt class="descname">getAngularDistribution</tt><big>(</big><em>E</em>, <em>keepL0Term=True</em>, <em>renormalize=True</em>, <em>reaction1='elastic'</em>, <em>reaction2='elastic'</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#SLBWcrossSection.getAngularDistribution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.SLBWcrossSection.getAngularDistribution" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.SLBWcrossSection.getCrossSection">
<tt class="descname">getCrossSection</tt><big>(</big><em>E</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#SLBWcrossSection.getCrossSection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.SLBWcrossSection.getCrossSection" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.SLBWcrossSection.getScatteringMatrixU">
<tt class="descname">getScatteringMatrixU</tt><big>(</big><em>Ein</em>, <em>useTabulatedScatteringRadius=True</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#SLBWcrossSection.getScatteringMatrixU"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.SLBWcrossSection.getScatteringMatrixU" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the scattering matrix</p>
<p>Note, unlike the getScatteringMatrixU() function in other resonance classes, 
the fact that different resonances are entirely different reactions means that the 
channelDicts have to have an additional layer of sorting that corresponds to the SLBW &#8220;level&#8221;.</p>
</dd></dl>

<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.SLBWcrossSection.setResonanceParametersByChannel">
<tt class="descname">setResonanceParametersByChannel</tt><big>(</big><em>multipleSScheme='NJOY'</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#SLBWcrossSection.setResonanceParametersByChannel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.SLBWcrossSection.setResonanceParametersByChannel" title="Permalink to this definition">¶</a></dt>
<dd><p>Reorganize member data into channels (relies heavily on groundwork in sortLandJ).</p>
<p>Note, unlike the getResonanceParametersByChannel() function in MLBW, RM or RML, 
the fact that different resonances are entirely different reactions means that the 
channelDicts have to have an additional layer of sorting that corresponds to the SLBW &#8220;level&#8221;.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.URRcrossSection">
<em class="property">class </em><tt class="descclassname">fudge.processing.resonances.fudgeReconstructResonances.</tt><tt class="descname">URRcrossSection</tt><big>(</big><em>reactionSuite</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#URRcrossSection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.URRcrossSection" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#fudge.processing.resonances.fudgeReconstructResonances.resonanceReconstructionBaseClass" title="fudge.processing.resonances.fudgeReconstructResonances.resonanceReconstructionBaseClass"><tt class="xref py py-class docutils literal"><span class="pre">fudge.processing.resonances.fudgeReconstructResonances.resonanceReconstructionBaseClass</span></tt></a></p>
<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.URRcrossSection.generateEnergyGrid">
<tt class="descname">generateEnergyGrid</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#URRcrossSection.generateEnergyGrid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.URRcrossSection.generateEnergyGrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the energy grid for reconstructing unresolved resonances. Usually this is just the energy grid
chosen by the evaluator for storing energy-dependent widths.</p>
</dd></dl>

<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.URRcrossSection.getCrossSection">
<tt class="descname">getCrossSection</tt><big>(</big><em>interpolateWidths=False</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#URRcrossSection.getCrossSection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.URRcrossSection.getCrossSection" title="Permalink to this definition">¶</a></dt>
<dd><p>Get unresolved region cross section for each incident energy in E.
By default, calculate on the energy grid supplied and then interpolate the resulting cross section.
If interpolateWidths==True, interpolate the average widths during reconstruction instead.</p>
</dd></dl>

<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.URRcrossSection.getFluctuationIntegrals">
<tt class="descname">getFluctuationIntegrals</tt><big>(</big><em>widths</em>, <em>DOF</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#URRcrossSection.getFluctuationIntegrals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.URRcrossSection.getFluctuationIntegrals" title="Permalink to this definition">¶</a></dt>
<dd><p>from subroutine GNRL3 in RECENT. If possible, this will be replaced
with more basic approach (rather than using lookup table)... not finding 
appropriate equations right now</p>
</dd></dl>

<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.URRcrossSection.rho">
<tt class="descname">rho</tt><big>(</big><em>E</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#URRcrossSection.rho"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.URRcrossSection.rho" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.blockwise">
<tt class="descclassname">fudge.processing.resonances.fudgeReconstructResonances.</tt><tt class="descname">blockwise</tt><big>(</big><em>function</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#blockwise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.blockwise" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.getAllowedTotalSpins">
<tt class="descclassname">fudge.processing.resonances.fudgeReconstructResonances.</tt><tt class="descname">getAllowedTotalSpins</tt><big>(</big><em>L</em>, <em>S</em>, <em>useFactor2Trick=True</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#getAllowedTotalSpins"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.getAllowedTotalSpins" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><dl class="docutils">
<dt>Returns a list of allowed J values from summing angular momenta L and S, where </dt>
<dd><div class="first last math">
</div>
</dd>
</dl>
</div></blockquote>
<p>ec{J}=
ec{L}+
ec{S}</p>
<blockquote>
<div><dl class="docutils">
<dt>which implies</dt>
<dd><dl class="first last docutils">
<dt>..math::</dt>
<dd><a href="#id4"><span class="problematic" id="id5">|L-S|</span></a> leq J leq L+S</dd>
</dl>
</dd>
</dl>
<p>The useFactor2Trick flag tells the routine whether we are summing real angular momenta or momenta * 2.
If the useFactor2Trick flag is true, then momenta are really momenta*2, meaning they can be pure integers, 
even if the real momenta refer to 1/2-integer values (e.g. spin).  The default is to useFactor2Trick because
most C/C++/Fortran codes that compute angular momentum-stuff use the trick so they can use integer math.  
Also, it makes the use of the Python range() function possible.</p>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.getRI_SI">
<tt class="descclassname">fudge.processing.resonances.fudgeReconstructResonances.</tt><tt class="descname">getRI_SI</tt><big>(</big><em>E</em>, <em>Eres</em>, <em>captureWidth</em>, <em>widths</em>, <em>penetrabilities</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#getRI_SI"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.getRI_SI" title="Permalink to this definition">¶</a></dt>
<dd><p>Both versions of Reich_Moore formalisms (LRF=3 and 7) rely on building matrices R and S,
which represent symmetric and anti-symmetric scattering respectively</p>
<p>matrix elements R[i,j] and S[i,j] =</p>
<p>(summed over resonances) partialWidth[i]*partialWidth[j] * coefficient/(dE**2+captureWidth**2),</p>
<p>for the ith/jth open channel. For S, the coefficient is &#8216;dE&#8217;, for R &#8216;captureWidth&#8217;
and partialWidth[i] = widths[i] * penetrabilities[i]</p>
<blockquote>
<div>( widths[i] is a row vector of resonance widths, and penetrabilities[i] is a column vector 
of the penetrability for each incident energy )</div></blockquote>
<p>Then, invert to find RI and SI such that (I+R+jS)*(I+RI+jSI) = I
where I is the identity matrix, and j = sqrt(-1)</p>
<p>Incident energy dependence appears in both in E and the penetrabilities</p>
<p>Additional documentation from RECENT:</p>
<div class="highlight-python"><div class="highlight"><pre>THE CROSS SECTIONS ARE DEFINED TO BE,

TOTAL        =2*GJ*REAL(I - U(N,N))
ABSORPTION   =4*GJ*(REAL(RHO(N,N)) - RHO(N,N)**2)
             =  GJ*(I - U(N,N)**2)
ELASTIC      =  GJ*(I - U(N,N))**2
FISSION      =4*GJ*(SUM OVER C)(RHO(N,C)**2)
CAPTURE      = ABSORPTION - FISSION

WHICH ARE COMPLETELY DEFINED IN TERMS OF U(N,N) AND RHO(N,C),

RHO(N,C)     =I - INVERSE(I - K)
U(N,N)       =EXP(-I*2*PS)*(2*INVERSE(I - K) - I)
             =(COS(2*PS) - I*SIN(2*PS))*(2*INVERSE(I - K) - I)
             =(COS(2*PS) - I*SIN(2*PS))*(1 - 2*RHO(N,N))

             =COS(2*PS)*(I-2*REAL(RHO)) - I*2*SIN(2*PS)*IM(RHO)

... (cmattoon: cutting some of the documentation here) ...

(I - K)      = (R + I) - I*S

R            = SQRT(GAM(C)/2*GAM(C*)/2)*(GAM/2)/DEN
S            = SQRT(GAM(C)/2*GAM(C*)/2)*(ER-E)/DEN
GAM(R)       = ELIMINATED RADIATIVE WIDTH
GAM(C)       = PARTIAL WIDE FOR CHANNEL C FOR A RESONANCE
DEN          = ((ER - E)**2 + (GAM/2)**2)

SUMMED OVER RESONANCES FOR EACH (L,J) SEQUENCE.
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.reconstructResonances">
<tt class="descclassname">fudge.processing.resonances.fudgeReconstructResonances.</tt><tt class="descname">reconstructResonances</tt><big>(</big><em>reactionSuite</em>, <em>tolerance=None</em>, <em>enableAngDists=False</em>, <em>verbose=True</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#reconstructResonances"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.reconstructResonances" title="Permalink to this definition">¶</a></dt>
<dd><p>reconstruct all resonance sections (resolved/unresolved) in reactionSuite, 
add results together for full (resonance region) pointwise cross section.
If tolerance is specified, refine grid to required tolerance for (lin-lin) interpolation</p>
</dd></dl>

<dl class="class">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.resonanceReconstructionBaseClass">
<em class="property">class </em><tt class="descclassname">fudge.processing.resonances.fudgeReconstructResonances.</tt><tt class="descname">resonanceReconstructionBaseClass</tt><big>(</big><em>reactionSuite</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#resonanceReconstructionBaseClass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.resonanceReconstructionBaseClass" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.resonanceReconstructionBaseClass.k">
<tt class="descname">k</tt><big>(</big><em>energy</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#resonanceReconstructionBaseClass.k"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.resonanceReconstructionBaseClass.k" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>For an incident neutron, with energy in eV, the ENDF manual states</p>
<blockquote>
<div><dl class="docutils">
<dt>..math ::</dt>
<dd>k =</dd>
</dl>
</div></blockquote>
</div></blockquote>
<p>rac{sqrt{2m_n}}{hbar}
rac{AWRI}{AWRI+1}sqrt{<a href="#id6"><span class="problematic" id="id7">|E|</span></a>}</p>
<blockquote>
<div>sqrt(2*neutronMass)/hbar == 2.196807e-3 (eV*barn)**-1/2. Thus for energy in eV, k is in b**-1/2</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.resonanceReconstructionBaseClass.penetrationFactor">
<tt class="descname">penetrationFactor</tt><big>(</big><em>L</em>, <em>rho</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#resonanceReconstructionBaseClass.penetrationFactor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.resonanceReconstructionBaseClass.penetrationFactor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.resonanceReconstructionBaseClass.phi">
<tt class="descname">phi</tt><big>(</big><em>L</em>, <em>rho</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#resonanceReconstructionBaseClass.phi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.resonanceReconstructionBaseClass.phi" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.resonanceReconstructionBaseClass.refineInterpolation">
<tt class="descname">refineInterpolation</tt><big>(</big><em>egrid</em>, <em>xsecs</em>, <em>tolerance=0.01</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#resonanceReconstructionBaseClass.refineInterpolation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.resonanceReconstructionBaseClass.refineInterpolation" title="Permalink to this definition">¶</a></dt>
<dd><p>generateEnergyGrid may not give a fine enough grid to linearly interpolate to desired tolerance.
My solution to that: for all consecutive points (x0,y0), (x1,y1) and (x2,y2) do a linear interpolation between
(x0,y0) and (x2,y2). If the interpolation doesn&#8217;t agree with (x1,y1) within tolerance,
subdivide up the region by adding two more calculated points.  Keep iterating until interpolation agrees within tolerance.</p>
<p>This means that in the end we will have more points than required for given tolerance.
The results can be thinned (implemented in XYs)</p>
</dd></dl>

<dl class="method">
<dt id="fudge.processing.resonances.fudgeReconstructResonances.resonanceReconstructionBaseClass.shiftFactor">
<tt class="descname">shiftFactor</tt><big>(</big><em>L</em>, <em>rho</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/fudgeReconstructResonances.html#resonanceReconstructionBaseClass.shiftFactor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.fudgeReconstructResonances.resonanceReconstructionBaseClass.shiftFactor" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate shift factor used in SLBW and MLBW formalisms</p>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-fudge.processing.resonances.getCoulombWavefunctions">
<span id="getcoulombwavefunctions-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">getCoulombWavefunctions</span></tt> Module<a class="headerlink" href="#module-fudge.processing.resonances.getCoulombWavefunctions" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="fudge.processing.resonances.getCoulombWavefunctions.getCoulombWavefunctions">
<tt class="descclassname">fudge.processing.resonances.getCoulombWavefunctions.</tt><tt class="descname">getCoulombWavefunctions</tt><big>(</big><em>rho</em>, <em>eta</em>, <em>L</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/getCoulombWavefunctions.html#getCoulombWavefunctions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.getCoulombWavefunctions.getCoulombWavefunctions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="fudge.processing.resonances.getCoulombWavefunctions.test_getCoulombWavefunctions">
<tt class="descclassname">fudge.processing.resonances.getCoulombWavefunctions.</tt><tt class="descname">test_getCoulombWavefunctions</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/getCoulombWavefunctions.html#test_getCoulombWavefunctions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.getCoulombWavefunctions.test_getCoulombWavefunctions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-fudge.processing.resonances.getScatteringMatrices">
<span id="getscatteringmatrices-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">getScatteringMatrices</span></tt> Module<a class="headerlink" href="#module-fudge.processing.resonances.getScatteringMatrices" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="fudge.processing.resonances.getScatteringMatrices.getScatteringMatrices">
<tt class="descclassname">fudge.processing.resonances.getScatteringMatrices.</tt><tt class="descname">getScatteringMatrices</tt><big>(</big><em>E</em>, <em>Eres</em>, <em>captureWidth</em>, <em>widths</em>, <em>penetrabilities</em><big>)</big><a class="reference internal" href="../_modules/fudge/processing/resonances/getScatteringMatrices.html#getScatteringMatrices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.processing.resonances.getScatteringMatrices.getScatteringMatrices" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/gnd.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">resonances Package</a><ul>
<li><a class="reference internal" href="#id1"><tt class="docutils literal"><span class="pre">resonances</span></tt> Package</a></li>
<li><a class="reference internal" href="#module-fudge.processing.resonances.fudgeReconstructResonances"><tt class="docutils literal"><span class="pre">fudgeReconstructResonances</span></tt> Module</a><ul>
<li><a class="reference internal" href="#basic-usage">Basic usage:</a></li>
<li><a class="reference internal" href="#alternate-use">Alternate use:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-fudge.processing.resonances.getCoulombWavefunctions"><tt class="docutils literal"><span class="pre">getCoulombWavefunctions</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-fudge.processing.resonances.getScatteringMatrices"><tt class="docutils literal"><span class="pre">getScatteringMatrices</span></tt> Module</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="fudge.processing.montecarlo.html"
                        title="previous chapter">montecarlo Package</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="fudge.structure.html"
                        title="next chapter">structure Package</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/fudge/fudge.processing.resonances.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="fudge.structure.html" title="structure Package"
             >next</a> |</li>
        <li class="right" >
          <a href="fudge.processing.montecarlo.html" title="montecarlo Package"
             >previous</a> |</li>
        <li><a href="../index.html">Fudge and GND 1.3 beta documentation</a> &raquo;</li>
          <li><a href="index.html" >fudge Package</a> &raquo;</li>
          <li><a href="fudge.processing.html" >processing Package</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, B.Beck, D. Brown, C. Mattoon, N. Patel, N. Summers.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>