<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>math Package &mdash; Fudge and GND 1.3 beta documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.3 beta',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../_static/gnd-20121206-favicon.ico"/>
    <link rel="top" title="Fudge and GND 1.3 beta documentation" href="../index.html" />
    <link rel="up" title="core Package" href="fudge.core.html" />
    <link rel="next" title="test Package" href="fudge.core.math.test.html" />
    <link rel="prev" title="core Package" href="fudge.core.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="fudge.core.math.test.html" title="test Package"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="fudge.core.html" title="core Package"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Fudge and GND 1.3 beta documentation</a> &raquo;</li>
          <li><a href="index.html" >fudge Package</a> &raquo;</li>
          <li><a href="fudge.core.html" accesskey="U">core Package</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="math-package">
<h1>math Package<a class="headerlink" href="#math-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id1">
<h2><tt class="xref py py-mod docutils literal"><span class="pre">math</span></tt> Package<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-fudge.core.math"></span></div>
<div class="section" id="endl1dmathclasses-module">
<h2><tt class="xref py py-mod docutils literal"><span class="pre">endl1dmathClasses</span></tt> Module<a class="headerlink" href="#endl1dmathclasses-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="endl1dmathmisc-module">
<h2><tt class="xref py py-mod docutils literal"><span class="pre">endl1dmathmisc</span></tt> Module<a class="headerlink" href="#endl1dmathmisc-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="endl2dmathclasses-module">
<h2><tt class="xref py py-mod docutils literal"><span class="pre">endl2dmathClasses</span></tt> Module<a class="headerlink" href="#endl2dmathclasses-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="endl2dmathmisc-module">
<h2><tt class="xref py py-mod docutils literal"><span class="pre">endl2dmathmisc</span></tt> Module<a class="headerlink" href="#endl2dmathmisc-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="endl3dmathclasses-module">
<h2><tt class="xref py py-mod docutils literal"><span class="pre">endl3dmathClasses</span></tt> Module<a class="headerlink" href="#endl3dmathclasses-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="endl3dmathmisc-module">
<h2><tt class="xref py py-mod docutils literal"><span class="pre">endl3dmathmisc</span></tt> Module<a class="headerlink" href="#endl3dmathmisc-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="endl4dmathclasses-module">
<h2><tt class="xref py py-mod docutils literal"><span class="pre">endl4dmathClasses</span></tt> Module<a class="headerlink" href="#endl4dmathclasses-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="endl4dmathmisc-module">
<h2><tt class="xref py py-mod docutils literal"><span class="pre">endl4dmathmisc</span></tt> Module<a class="headerlink" href="#endl4dmathmisc-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-fudge.core.math.fudge2dGrouping">
<span id="fudge2dgrouping-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">fudge2dGrouping</span></tt> Module<a class="headerlink" href="#module-fudge.core.math.fudge2dGrouping" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="fudge.core.math.fudge2dGrouping.groupedData">
<em class="property">class </em><tt class="descclassname">fudge.core.math.fudge2dGrouping.</tt><tt class="descname">groupedData</tt><big>(</big><em>data</em>, <em>axes_=None</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/fudge2dGrouping.html#groupedData"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.fudge2dGrouping.groupedData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<dl class="method">
<dt id="fudge.core.math.fudge2dGrouping.groupedData.getData">
<tt class="descname">getData</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/fudge2dGrouping.html#groupedData.getData"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.fudge2dGrouping.groupedData.getData" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the data of self.</p>
</dd></dl>

<dl class="method">
<dt id="fudge.core.math.fudge2dGrouping.groupedData.getEnd">
<tt class="descname">getEnd</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/fudge2dGrouping.html#groupedData.getEnd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.fudge2dGrouping.groupedData.getEnd" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the index of the last non-zero data in self.</p>
</dd></dl>

<dl class="method">
<dt id="fudge.core.math.fudge2dGrouping.groupedData.getStart">
<tt class="descname">getStart</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/fudge2dGrouping.html#groupedData.getStart"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.fudge2dGrouping.groupedData.getStart" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the index of the first non-zero data in self.</p>
</dd></dl>

<dl class="classmethod">
<dt id="fudge.core.math.fudge2dGrouping.groupedData.parseXMLNode">
<em class="property">classmethod </em><tt class="descname">parseXMLNode</tt><big>(</big><em>element</em>, <em>xPath=</em>, <span class="optional">[</span><span class="optional">]</span><em>linkData={}</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/fudge2dGrouping.html#groupedData.parseXMLNode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.fudge2dGrouping.groupedData.parseXMLNode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fudge.core.math.fudge2dGrouping.groupedData.toString">
<tt class="descname">toString</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/fudge2dGrouping.html#groupedData.toString"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.fudge2dGrouping.groupedData.toString" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fudge.core.math.fudge2dGrouping.groupedData.toXMLList">
<tt class="descname">toXMLList</tt><big>(</big><em>indent=''</em>, <em>floatFormat='%16.9e'</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/fudge2dGrouping.html#groupedData.toXMLList"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.fudge2dGrouping.groupedData.toXMLList" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-fudge.core.math.fudgemath">
<span id="fudgemath-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">fudgemath</span></tt> Module<a class="headerlink" href="#module-fudge.core.math.fudgemath" title="Permalink to this headline">¶</a></h2>
<p>This module contains useful fudge math routines that do not fit into any other module.</p>
<dl class="function">
<dt id="fudge.core.math.fudgemath.checkForNaN">
<tt class="descclassname">fudge.core.math.fudgemath.</tt><tt class="descname">checkForNaN</tt><big>(</big><em>v</em>, <em>str</em>, <em>printErrors=True</em>, <em>indentation=''</em>, <em>messages=None</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/fudgemath.html#checkForNaN"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.fudgemath.checkForNaN" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="fudge.core.math.fudgemath.checkNumber">
<tt class="descclassname">fudge.core.math.fudgemath.</tt><tt class="descname">checkNumber</tt><big>(</big><em>v</em>, <em>str=''</em>, <em>printErrors=True</em>, <em>indentation=''</em>, <em>messages=None</em>, <em>maxAbsFloatValue=None</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/fudgemath.html#checkNumber"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.fudgemath.checkNumber" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="fudge.core.math.fudgemath.getValue">
<tt class="descclassname">fudge.core.math.fudgemath.</tt><tt class="descname">getValue</tt><big>(</big><em>n</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/fudgemath.html#getValue"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.fudgemath.getValue" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="fudge.core.math.fudgemath.isNumber">
<tt class="descclassname">fudge.core.math.fudgemath.</tt><tt class="descname">isNumber</tt><big>(</big><em>n</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/fudgemath.html#isNumber"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.fudgemath.isNumber" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="fudge.core.math.fudgemath.thickenXYList">
<tt class="descclassname">fudge.core.math.fudgemath.</tt><tt class="descname">thickenXYList</tt><big>(</big><em>list</em>, <em>tester</em>, <em>biSectionMax=6</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/fudgemath.html#thickenXYList"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.fudgemath.thickenXYList" title="Permalink to this definition">¶</a></dt>
<dd><p>This functions takes a list of (x,y) points and a function, tester.evaluateAtX, and bi-sectionally adds points to 
obtain linear-linear tolerance of the returned list and tester.evaluateAtX to tester.relativeTolerance. At most 
biSectionMax bi-sections are performed between each consecutive pair of inputted points. It is assumed that the 
initial list of points and the function tester.evaluateAtX agree to tolerance tester.relativeTolerance. The instance
tester must contain the members relativeTolerance and absoluteTolerance as well as the method evaluateAtX. The
method evaluateAtX takes an x-value and returns its y-value.</p>
</dd></dl>

<dl class="function">
<dt id="fudge.core.math.fudgemath.toFloat">
<tt class="descclassname">fudge.core.math.fudgemath.</tt><tt class="descname">toFloat</tt><big>(</big><em>value</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/fudgemath.html#toFloat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.fudgemath.toFloat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="fudge.core.math.fudgemath.toInt">
<tt class="descclassname">fudge.core.math.fudgemath.</tt><tt class="descname">toInt</tt><big>(</big><em>value</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/fudgemath.html#toInt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.fudgemath.toInt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="parameters-module">
<h2><tt class="xref py py-mod docutils literal"><span class="pre">parameters</span></tt> Module<a class="headerlink" href="#parameters-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-fudge.core.math.pointwiseXY">
<span id="pointwisexy-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">pointwiseXY</span></tt> Module<a class="headerlink" href="#module-fudge.core.math.pointwiseXY" title="Permalink to this headline">¶</a></h2>
<p>This module defines &#8216;pointwiseXY&#8217; in pure python. Users will generally prefer to use &#8216;pointwiseXY_C&#8217;,
which is a faster and more capable C implementation.
If the C version is not available, fudge will revert to this version.</p>
<dl class="class">
<dt id="fudge.core.math.pointwiseXY.pointwiseXY">
<em class="property">class </em><tt class="descclassname">fudge.core.math.pointwiseXY.</tt><tt class="descname">pointwiseXY</tt><big>(</big><em>initialSize=0</em>, <em>overflowSize=0</em>, <em>data=None</em>, <em>dataForm='xys'</em>, <em>accuracy=None</em>, <em>biSectionMax=4</em>, <em>interpolation=None</em>, <em>infill=True</em>, <em>safeDivide=False</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/pointwiseXY.html#pointwiseXY"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.pointwiseXY.pointwiseXY" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">fudge.legacy.endl.endl2dmathClasses.endl2dmath</span></tt></p>
<dl class="method">
<dt id="fudge.core.math.pointwiseXY.pointwiseXY.changeInterpolation">
<tt class="descname">changeInterpolation</tt><big>(</big><em>interpolation</em>, <em>accuracy=None</em>, <em>lowerEps=0</em>, <em>upperEps=0</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/pointwiseXY.html#pointwiseXY.changeInterpolation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.pointwiseXY.pointwiseXY.changeInterpolation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fudge.core.math.pointwiseXY.pointwiseXY.copy">
<tt class="descname">copy</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/pointwiseXY.html#pointwiseXY.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.pointwiseXY.pointwiseXY.copy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fudge.core.math.pointwiseXY.pointwiseXY.copyDataToXYs">
<tt class="descname">copyDataToXYs</tt><big>(</big><em>xScale=None</em>, <em>yScale=None</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/pointwiseXY.html#pointwiseXY.copyDataToXYs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.pointwiseXY.pointwiseXY.copyDataToXYs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fudge.core.math.pointwiseXY.pointwiseXY.getAccuracy">
<tt class="descname">getAccuracy</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/pointwiseXY.html#pointwiseXY.getAccuracy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.pointwiseXY.pointwiseXY.getAccuracy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fudge.core.math.pointwiseXY.pointwiseXY.getBiSectionMax">
<tt class="descname">getBiSectionMax</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/pointwiseXY.html#pointwiseXY.getBiSectionMax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.pointwiseXY.pointwiseXY.getBiSectionMax" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fudge.core.math.pointwiseXY.pointwiseXY.getInfill">
<tt class="descname">getInfill</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/pointwiseXY.html#pointwiseXY.getInfill"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.pointwiseXY.pointwiseXY.getInfill" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fudge.core.math.pointwiseXY.pointwiseXY.getSafeDivide">
<tt class="descname">getSafeDivide</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/pointwiseXY.html#pointwiseXY.getSafeDivide"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.pointwiseXY.pointwiseXY.getSafeDivide" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fudge.core.math.pointwiseXY.pointwiseXY.thin">
<tt class="descname">thin</tt><big>(</big><em>accuracy</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/pointwiseXY.html#pointwiseXY.thin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.pointwiseXY.pointwiseXY.thin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fudge.core.math.pointwiseXY.pointwiseXY.union">
<tt class="descname">union</tt><big>(</big><em>other</em>, <em>fillWithSelf</em>, <em>trim</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/pointwiseXY.html#pointwiseXY.union"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.pointwiseXY.pointwiseXY.union" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fudge.core.math.pointwiseXY.pointwiseXY.xSlice">
<tt class="descname">xSlice</tt><big>(</big><em>xMin</em>, <em>xMax</em>, <em>fill=None</em>, <em>dullEps=None</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/pointwiseXY.html#pointwiseXY.xSlice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.pointwiseXY.pointwiseXY.xSlice" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-fudge.core.math.table">
<span id="table-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">table</span></tt> Module<a class="headerlink" href="#module-fudge.core.math.table" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="fudge.core.math.table.blank">
<em class="property">class </em><tt class="descclassname">fudge.core.math.table.</tt><tt class="descname">blank</tt><a class="reference internal" href="../_modules/fudge/core/math/table.html#blank"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.table.blank" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>Blank table entry, to indicate missing data</p>
</dd></dl>

<dl class="class">
<dt id="fudge.core.math.table.columnHeader">
<em class="property">class </em><tt class="descclassname">fudge.core.math.table.</tt><tt class="descname">columnHeader</tt><big>(</big><em>index</em>, <em>name</em>, <em>units=None</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/table.html#columnHeader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.table.columnHeader" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>defines one column in a table</p>
<dl class="method">
<dt id="fudge.core.math.table.columnHeader.toXMLList">
<tt class="descname">toXMLList</tt><big>(</big><em>indent=''</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/table.html#columnHeader.toXMLList"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.table.columnHeader.toXMLList" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="fudge.core.math.table.parseXMLNode">
<tt class="descclassname">fudge.core.math.table.</tt><tt class="descname">parseXMLNode</tt><big>(</big><em>element</em>, <em>xPath=</em>, <span class="optional">[</span><span class="optional">]</span><em>conversionTable={}</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/table.html#parseXMLNode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.table.parseXMLNode" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a table element from xml into python. To convert a column or attribute from string to some other type,
enter the new type in the conversionTable: {&#8216;index&#8217;:int, &#8216;scatteringRadius&#8217;:PhysicalQuantityWithUncertainty, etc}.</p>
</dd></dl>

<dl class="class">
<dt id="fudge.core.math.table.table">
<em class="property">class </em><tt class="descclassname">fudge.core.math.table.</tt><tt class="descname">table</tt><big>(</big><em>columns=None</em>, <em>data=None</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/table.html#table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.table.table" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="fudge.core.html#fudge.core.ancestry.ancestry" title="fudge.core.ancestry.ancestry"><tt class="xref py py-class docutils literal"><span class="pre">fudge.core.ancestry.ancestry</span></tt></a></p>
<dl class="method">
<dt id="fudge.core.math.table.table.addColumn">
<tt class="descname">addColumn</tt><big>(</big><em>columnHeader</em>, <em>index=None</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/table.html#table.addColumn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.table.table.addColumn" title="Permalink to this definition">¶</a></dt>
<dd><p>add another column, either at &#8216;index&#8217; or at the end of the table</p>
</dd></dl>

<dl class="method">
<dt id="fudge.core.math.table.table.addRow">
<tt class="descname">addRow</tt><big>(</big><em>dataRow</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/table.html#table.addRow"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.table.table.addRow" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fudge.core.math.table.table.getColumn">
<tt class="descname">getColumn</tt><big>(</big><em>columnName</em>, <em>units=None</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/table.html#table.getColumn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.table.table.getColumn" title="Permalink to this definition">¶</a></dt>
<dd><p>get data from one column, identified by the column &#8216;name&#8217; attribute.
Convert results to unit if units are specified</p>
</dd></dl>

<dl class="attribute">
<dt id="fudge.core.math.table.table.nColumns">
<tt class="descname">nColumns</tt><a class="reference internal" href="../_modules/fudge/core/math/table.html#table.nColumns"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.table.table.nColumns" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="fudge.core.math.table.table.nRows">
<tt class="descname">nRows</tt><a class="reference internal" href="../_modules/fudge/core/math/table.html#table.nRows"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.table.table.nRows" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fudge.core.math.table.table.removeColumn">
<tt class="descname">removeColumn</tt><big>(</big><em>columnName</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/table.html#table.removeColumn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.table.table.removeColumn" title="Permalink to this definition">¶</a></dt>
<dd><p>remove one column from the table</p>
</dd></dl>

<dl class="method">
<dt id="fudge.core.math.table.table.toXMLList">
<tt class="descname">toXMLList</tt><big>(</big><em>indent=''</em>, <em>prettyPrint=True</em>, <em>addHeader=True</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/table.html#table.toXMLList"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.table.table.toXMLList" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-fudge.core.math.matrix">
<span id="matrix-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">matrix</span></tt> Module<a class="headerlink" href="#module-fudge.core.math.matrix" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="fudge.core.math.matrix.matrix">
<em class="property">class </em><tt class="descclassname">fudge.core.math.matrix.</tt><tt class="descname">matrix</tt><big>(</big><em>data</em>, <em>form=None</em>, <em>precision=None</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/matrix.html#matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.matrix.matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="fudge.core.html#fudge.core.ancestry.ancestry" title="fudge.core.ancestry.ancestry"><tt class="xref py py-class docutils literal"><span class="pre">fudge.core.ancestry.ancestry</span></tt></a></p>
<p>Class for storing a matrix or two-dimensional array.
This class supports diagonal, symmetric, asymmetric, and sparse matrices.
Matrix data is stored as a list of lists, which is easily converted into a numpy array.</p>
<dl class="method">
<dt id="fudge.core.math.matrix.matrix.check">
<tt class="descname">check</tt><big>(</big><em>info</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/matrix.html#matrix.check"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.matrix.matrix.check" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Run some simple checks on covariance matrices: </dt>
<dd><ul class="first last simple">
<li>look for negative eigenvals,</li>
<li>check ratio of smallest/largest eigenvals</li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="fudge.core.math.matrix.matrix.fix">
<tt class="descname">fix</tt><big>(</big><em>**kw</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/matrix.html#matrix.fix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.matrix.matrix.fix" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Fix common eigenvalue problems: </dt>
<dd><ul class="first last simple">
<li>negative eigenvals,</li>
<li>bad ratio of smallest/largest eigenvals</li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="fudge.core.math.matrix.matrix.ncols">
<tt class="descname">ncols</tt><a class="reference internal" href="../_modules/fudge/core/math/matrix.html#matrix.ncols"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.matrix.matrix.ncols" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="fudge.core.math.matrix.matrix.nrows">
<tt class="descname">nrows</tt><a class="reference internal" href="../_modules/fudge/core/math/matrix.html#matrix.nrows"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.matrix.matrix.nrows" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fudge.core.math.matrix.matrix.plot">
<tt class="descname">plot</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/matrix.html#matrix.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.matrix.matrix.plot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fudge.core.math.matrix.matrix.toXMLList">
<tt class="descname">toXMLList</tt><big>(</big><em>flags=None</em>, <em>indent=''</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/matrix.html#matrix.toXMLList"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.matrix.matrix.toXMLList" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="fudge.core.math.matrix.parseXMLNode">
<tt class="descclassname">fudge.core.math.matrix.</tt><tt class="descname">parseXMLNode</tt><big>(</big><em>mat</em>, <em>xPath=</em>, <span class="optional">[</span><span class="optional">]</span><em>linkData={}</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/matrix.html#parseXMLNode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.matrix.parseXMLNode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-fudge.core.math.linearAlgebra">
<span id="linearalgebra-module"></span><h2><tt class="xref py py-mod docutils literal"><span class="pre">linearAlgebra</span></tt> Module<a class="headerlink" href="#module-fudge.core.math.linearAlgebra" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="fudge.core.math.linearAlgebra.affine_transform_covariance">
<tt class="descclassname">fudge.core.math.linearAlgebra.</tt><tt class="descname">affine_transform_covariance</tt><big>(</big><em>covarianceMatrix</em>, <em>transformMatrix</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/linearAlgebra.html#affine_transform_covariance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.linearAlgebra.affine_transform_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform an affine transformation to a covariance matrix, namely 
<span class="math">\(new = A^T \cdot old \cdot A\)</span>, where <span class="math">\(A\)</span> is a orthogonal matrix.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">not implemented</p>
</div>
</dd></dl>

<dl class="function">
<dt id="fudge.core.math.linearAlgebra.cglsqrSolve">
<tt class="descclassname">fudge.core.math.linearAlgebra.</tt><tt class="descname">cglsqrSolve</tt><big>(</big><em>data</em>, <em>dataUnc=None</em>, <em>dataCov=None</em>, <em>kernel=None</em>, <em>prior=None</em>, <em>priorCov=None</em>, <em>constraintVector=None</em>, <em>constraintMatrix=None</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/linearAlgebra.html#cglsqrSolve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.linearAlgebra.cglsqrSolve" title="Permalink to this definition">¶</a></dt>
<dd><p>Constrainted Generalized Least-Squares Solver, based on CorAL routines.
We are minimizing the following <tt class="docutils literal"><span class="pre">chi^2</span></tt> (assuming Gaussian statistics)</p>
<div class="highlight-python"><div class="highlight"><pre>chi^2 = ( data - kernel * model ) * ( dataCov )^-1 * ( data - kernel * model )^T +
        ( prior - model ) * ( priorCov )^2 * ( prior - model )^T
</pre></div>
</div>
<p>subject to the constraint</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">constraintVector</span> <span class="o">=</span> <span class="n">constraintMatrix</span> <span class="o">*</span> <span class="n">model</span>
</pre></div>
</div>
<p>Here, <tt class="docutils literal"><span class="pre">^T</span></tt> means matrix transpose and <tt class="docutils literal"><span class="pre">^-1</span></tt> means a (generalized) matrix inverse.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a tuple: <tt class="docutils literal"><span class="pre">(model,</span> <span class="pre">modelCovariance)</span></tt>:<ul class="simple">
<li><tt class="docutils literal"><span class="pre">model</span></tt> : a M x 1 numpy.mat containing the extracted model parameter</li>
<li><tt class="docutils literal"><span class="pre">modelCovariance</span></tt> : a M x M numpy.mat containing the covariance on the extracted model paremeters</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p><strong>Manditory arguments:</strong></p>
<blockquote>
<div><ul class="simple">
<li><strong>data</strong> : a N x 1 <tt class="docutils literal"><span class="pre">numpy.mat</span></tt> (a vector!) containing the data to fit</li>
</ul>
</div></blockquote>
<p><strong>Optional arguments:</strong></p>
<blockquote>
<div><ul>
<li><dl class="first docutils">
<dt><strong>kernel</strong> <span class="classifier-delimiter">:</span> <span class="classifier">a N x M <tt class="docutils literal"><span class="pre">numpy.mat</span></tt> that maps the model parameters into the data space.  If this </span></dt>
<dd><p class="first last">is not given, it is assumed that <tt class="docutils literal"><span class="pre">kernel</span></tt> = the identity matrix and N == M.</p>
</dd>
</dl>
</li>
<li><p class="first">either</p>
<blockquote>
<div><dl class="docutils">
<dt>&#8211; <strong>dataUnc</strong> <span class="classifier-delimiter">:</span> <span class="classifier">a N x 1 <tt class="docutils literal"><span class="pre">numpy.mat</span></tt> (a vector) of uncertianties on the data vector.</span></dt>
<dd><p class="first last">This will be converted to the <tt class="docutils literal"><span class="pre">dataCov</span></tt> if the <tt class="docutils literal"><span class="pre">dataCov</span></tt> is not specified.</p>
</dd>
</dl>
<p class="attribution">&mdash;<strong>dataCov</strong> : a N x N <tt class="docutils literal"><span class="pre">numpy.mat</span></tt> containing the data&#8217;s covariance
If this is specified, the <tt class="docutils literal"><span class="pre">dataUnc</span></tt> will be ignored.</p>
</div></blockquote>
<blockquote>
<div><p>If neither the <tt class="docutils literal"><span class="pre">dataUnc</span></tt> or <tt class="docutils literal"><span class="pre">dataCov</span></tt> are specified, we will set the covariance to the 
identity matrix. Instead of minimizing the <tt class="docutils literal"><span class="pre">chi^2</span></tt>, you will minimize</p>
<div class="highlight-python"><div class="highlight"><pre>| data - kernel * model |^2
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">both of</p>
<blockquote>
<div><p>&#8211; <strong>prior</strong>    : a M x 1 <tt class="docutils literal"><span class="pre">numpy.mat</span></tt> containing the fitting model&#8217;s apriori values</p>
<p class="attribution">&mdash;<strong>priorCov</strong> : a M x M <tt class="docutils literal"><span class="pre">numpy.mat</span></tt> containing the fitting model&#8217;s apriori covariance</p>
</div></blockquote>
<blockquote>
<div><p>If either one is not included, the second term in the <tt class="docutils literal"><span class="pre">chi^2</span></tt> will be ignored.</p>
</div></blockquote>
</li>
<li><p class="first">both of</p>
<blockquote>
<div><p>&#8211; <strong>constraintVector</strong> : a L x 1 <tt class="docutils literal"><span class="pre">numpy.mat</span></tt> containing values to constrain the model to match</p>
<p class="attribution">&mdash;<strong>constraintMatrix</strong> : a L x M <tt class="docutils literal"><span class="pre">numpy.mat</span></tt> relating the model parameters to the <tt class="docutils literal"><span class="pre">constraintVector</span></tt> values</p>
</div></blockquote>
<blockquote>
<div><p>If either one is not included, the constraint equation will be ignored.</p>
</div></blockquote>
</li>
</ul>
</div></blockquote>
<p class="rubric">HOW IT WORKS</p>
<p>Because the data and the prior are independent and not correlated, we will solve the minimization problem by
stacking the prior part and the data part to construct a new <tt class="docutils literal"><span class="pre">chi^2</span></tt> to minimize</p>
<div class="highlight-python"><div class="highlight"><pre>          [ data  ]             [ dataCov |     0    ]                [ kernel ]
newData = [ ----- ],   newCov = [ --------|--------- ],   newKernel = [ ------ ]
          [ prior ]             [    0    | priorCov ]                [    1   ]
</pre></div>
</div>
<p>With these, the <tt class="docutils literal"><span class="pre">chi^2</span></tt> may be rewritten as</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">chi</span><span class="o">^</span><span class="mi">2</span> <span class="o">=</span> <span class="p">(</span> <span class="n">newData</span> <span class="o">-</span> <span class="n">newKernel</span> <span class="o">*</span> <span class="n">model</span> <span class="p">)</span><span class="o">^</span><span class="n">T</span> <span class="o">*</span> <span class="n">newCov</span><span class="o">^-</span><span class="mi">1</span> <span class="o">*</span> <span class="p">(</span> <span class="n">newData</span> <span class="o">-</span> <span class="n">newKernel</span> <span class="o">*</span> <span class="n">model</span> <span class="p">)</span>
</pre></div>
</div>
<p>The solution to the minimization problem is the well known normal equation</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">modelCov</span> <span class="o">=</span> <span class="p">(</span> <span class="n">newKernel</span> <span class="o">*</span> <span class="n">newCov</span><span class="o">^-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">newKernel</span><span class="o">^</span><span class="n">T</span> <span class="p">)</span><span class="o">^-</span><span class="mi">1</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">modelCov</span> <span class="o">*</span> <span class="n">newKernel</span><span class="o">^</span><span class="n">T</span> <span class="o">*</span> <span class="n">newCov</span><span class="o">^-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">newData</span>
</pre></div>
</div>
<p>Implementing this case where no uncertainty or covariance is given on the data vector is straightforward.
In this case, we are solving the simple least-squares problem</p>
<div class="highlight-python"><div class="highlight"><pre>minimize:   | data - kernel * model |^2 + ( model - prior )*( priorCov )^-1*( model - prior )^T
</pre></div>
</div>
<p>In other words, we use a <tt class="docutils literal"><span class="pre">dataCov</span> <span class="pre">=</span> <span class="pre">1</span></tt>, the identity matrix.</p>
<p>We comment that the equality constraints can be added in much this same way by adding the constraint 
vector as a fake data set, with infinitesimal uncertainties</p>
<div class="highlight-python"><div class="highlight"><pre>chi^2 += lambda * ( constraintVector - constraintMatrix * model )^2    
</pre></div>
</div>
<p>with lambda <span class="math">\(\rightarrow\infty\)</span>.  This approach works, but can lead to numerical instabilities by 
adding big number to the original covariances, then taking inverses.</p>
<p>So, rather than doing this, we will do something different (using Lagrange multipliers).  
We use the &#8220;newData&#8221; etc. above and the corresponding <tt class="docutils literal"><span class="pre">chi^2</span></tt></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">chi</span><span class="o">^</span><span class="mi">2</span> <span class="o">=</span> <span class="p">(</span> <span class="n">newData</span> <span class="o">-</span> <span class="n">newKernel</span> <span class="o">*</span> <span class="n">model</span> <span class="p">)</span><span class="o">^</span><span class="n">T</span> <span class="o">*</span> <span class="n">newCov</span><span class="o">^-</span><span class="mi">1</span> <span class="o">*</span> <span class="p">(</span> <span class="n">newData</span> <span class="o">-</span> <span class="n">newKernel</span> <span class="o">*</span> <span class="n">model</span> <span class="p">)</span>
</pre></div>
</div>
<p>subject to the constraint</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">constraintMatrix</span> <span class="o">*</span> <span class="n">model</span> <span class="o">=</span> <span class="n">constraintVector</span>
</pre></div>
</div>
<p>Here we are really solving the quadratic optimization problem here and the way to solve it is with 
Lagrange multipliers.  So, extend the model thusly</p>
<div class="highlight-python"><div class="highlight"><pre>           [   model  ]
newModel = [ ---------]
           [  lambda  ]
</pre></div>
</div>
<p>Here lambda is the vector of Lagrange multipliers ( there are L of them ).  
Minimizing the chi^2, we find the usual normal equation</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">(</span> <span class="n">newKernel</span> <span class="o">*</span> <span class="n">newCov</span><span class="o">^-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">newKernel</span><span class="o">^</span><span class="n">T</span> <span class="p">)</span> <span class="o">*</span> <span class="n">model</span> <span class="o">=</span> <span class="n">newKernel</span><span class="o">^</span><span class="n">T</span> <span class="o">*</span> <span class="n">newCov</span><span class="o">^-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">newData</span>
</pre></div>
</div>
<p>So, we&#8217;ll stack the normal and constraint equations:</p>
<div class="highlight-python"><div class="highlight"><pre>    [ newKernel * newCov^-1 * newKernel^T | constraintMatrix^T ]
A = [ ------------------------------------|------------------- ]
    [          constraintMatrix           |         0          ]

and

    [ newKernel^T * newCov^-1 * newData ]
y = [ --------------------------------- ]
    [         constraintVector          ]

giving,

A * newModel = y
</pre></div>
</div>
<p>We can solve this a few ways:</p>
<blockquote>
<div><ol class="arabic">
<li><p class="first">Performing a QR decomposition on <span class="math">\(A\)</span> gives <span class="math">\(A = QR\)</span> (using <tt class="docutils literal"><span class="pre">numpy.linalg.qr</span></tt>) and</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">R</span> <span class="o">*</span> <span class="n">newModel</span> <span class="o">=</span> <span class="n">Q</span><span class="o">^</span><span class="n">T</span> <span class="o">*</span> <span class="n">y</span>
</pre></div>
</div>
<p>We can then use the <tt class="docutils literal"><span class="pre">numpy.linalg.tensorsolve</span></tt> for the <tt class="docutils literal"><span class="pre">newModel</span></tt></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">newModel</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">tensorsolve</span><span class="p">(</span> <span class="n">R</span><span class="p">,</span> <span class="n">Q</span><span class="o">^</span><span class="n">T</span> <span class="o">*</span> <span class="n">y</span> <span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first">Just doing a Moore-Penrose inversion (uses SVD)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">newModel</span> <span class="o">=</span> <span class="n">A</span><span class="o">^-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">y</span>
</pre></div>
</div>
</li>
</ol>
</div></blockquote>
<p>But now the meaning of A is clear: it is an &#8220;extended&#8221; covariance where the first 
M x M block is the covariance of the model and the rest are the covariance of the 
Lagrange multipliers (which are disposable).</p>
<p class="rubric">TESTING</p>
<dl class="docutils">
<dt>Note on construction of dataCov with uncertainty:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">unc</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span> <span class="p">[</span> <span class="p">[</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span> <span class="p">]</span> <span class="p">]</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diagCov</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span> <span class="p">[</span> <span class="n">unc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">unc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="n">unc</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="p">]</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diagCov</span>
<span class="go">array([ [ 1.,  0.,  0.],</span>
<span class="go">        [ 0.,  1.,  0.],</span>
<span class="go">        [ 0.,  0.,  4.]])</span>
</pre></div>
</div>
</dd>
<dt>Also, without specifying an uncertainty or covariance, one finds:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">dataCov</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataCov</span>
<span class="go">array([ [ 1.,  0.,  0.],</span>
<span class="go">        [ 0.,  1.,  0.],</span>
<span class="go">        [ 0.,  0.,  1.]])</span>
</pre></div>
</div>
</dd>
</dl>
<p>So, both alternate methods of defining the data covariance function correctly.</p>
<p><strong>Define the problem</strong></p>
<dl class="docutils">
<dt>Define a test problem:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">answer</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span> <span class="mf">1.34883721</span><span class="p">,</span><span class="o">-</span><span class="mf">0.69767442</span><span class="p">,</span> <span class="mf">0.34883721</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">42.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span> <span class="p">[</span> <span class="p">[</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">],</span> <span class="p">[</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">],</span> <span class="p">[</span> <span class="mf">4.5</span><span class="p">,</span> <span class="mf">5.4</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">]</span> <span class="p">]</span> <span class="p">)</span> <span class="c"># Note: lower two subspaces map to 0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel</span> <span class="o">*</span> <span class="n">answer</span><span class="o">.</span><span class="n">T</span> 
<span class="go">    matrix([[ 1.],</span>
<span class="go">            [ 2.],</span>
<span class="go">            [ 3.]])</span>
</pre></div>
</div>
</dd>
<dt>Test data:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mat</span><span class="p">([</span> <span class="p">[</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.89</span><span class="p">,</span> <span class="mf">3.05</span> <span class="p">]</span> <span class="p">]</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataCov</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mat</span><span class="p">([</span> <span class="p">[</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span> <span class="p">],</span> <span class="p">[</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.1</span> <span class="p">]</span> <span class="p">,</span> <span class="p">[</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span> <span class="p">]</span> <span class="p">]</span> <span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Constrain the last two elements of the model to add to 42.1:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">constraintVector</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span> <span class="p">[[</span> <span class="mf">42.1</span> <span class="p">]]</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">constraintMatrix</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span> <span class="p">[[</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span> <span class="p">]]</span> <span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>A apriori guess to the result (good to &lt; 5% in all 4 dimensions):</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">prior</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span> <span class="mf">1.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.11</span><span class="p">,</span> <span class="mf">42.2</span> <span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">priorCov</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">matrix</span><span class="p">([</span>
<span class="go">    [  0.07      ,   0.        ,   0.        ,   0.        ,   0.        ],</span>
<span class="go">    [  0.        ,   0.5       ,   0.        ,   0.        ,   0.        ],</span>
<span class="go">    [  0.        ,   0.        ,   0.4       ,   0.        ,   0.        ],</span>
<span class="go">    [  0.        ,   0.        ,   0.        ,   0.1       ,   0.        ],</span>
<span class="go">    [  0.        ,   0.        ,   0.        ,   0.        ,  20.        ]])</span>
</pre></div>
</div>
</dd>
</dl>
<p>This might be a little too good...</p>
<p><strong>A data only solution</strong></p>
<dl class="docutils">
<dt>Using data only, we get:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">modelCov</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span> <span class="n">kernel</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span> <span class="n">dataCov</span> <span class="p">)</span> <span class="o">*</span> <span class="n">kernel</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">modelCov</span>
<span class="go">matrix([[ 19.2436993 , -17.66414278,   4.23904813,   0.        ,   0.        ],</span>
<span class="go">        [-17.66414278,  16.28177393,  -3.95484045,   0.        ,   0.        ],</span>
<span class="go">        [  4.23904813,  -3.95484045,   1.03439697,   0.        ,   0.        ],</span>
<span class="go">        [  0.        ,   0.        ,   0.        ,   0.        ,   0.        ],</span>
<span class="go">        [  0.        ,   0.        ,   0.        ,   0.        ,   0.        ]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">modelCov</span> <span class="o">*</span> <span class="n">kernel</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span> <span class="n">dataCov</span> <span class="p">)</span> <span class="o">*</span> <span class="n">data</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span>
<span class="go">matrix([[ 0.66232558],</span>
<span class="go">        [-0.05465116],</span>
<span class="go">        [ 0.18232558],</span>
<span class="go">        [ 0.        ],</span>
<span class="go">        [ 0.        ]])</span>
</pre></div>
</div>
</dd>
</dl>
<p>Note: the last to elements in the model are zero because there was no way to control them given the kernel in play.  
Without a handle on the last two elements, the fitting cannot do better than this.</p>
<p><strong>A data+prior solution</strong></p>
<dl class="docutils">
<dt>With data+prior, we first repack things:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">newData</span> <span class="o">=</span> <span class="n">stackHorizontal</span><span class="p">(</span> <span class="p">[</span> <span class="n">data</span><span class="p">,</span> <span class="n">prior</span> <span class="p">]</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newData</span>
<span class="go">matrix([[  1.1 ,   1.89,   3.05,   1.3 ,  -0.7 ,   0.3 ,   0.11,  42.2 ]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newKernel</span> <span class="o">=</span> <span class="n">stackVertical</span><span class="p">(</span> <span class="p">[</span> <span class="n">kernel</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span> <span class="n">prior</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="p">]</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newKernel</span>
<span class="go">matrix([[ 1. ,  2. ,  3. ,  0. ,  0. ],</span>
<span class="go">        [ 2. ,  3. ,  4. ,  0. ,  0. ],</span>
<span class="go">        [ 4.5,  5.4,  2. ,  0. ,  0. ],</span>
<span class="go">        [ 1. ,  0. ,  0. ,  0. ,  0. ],</span>
<span class="go">        [ 0. ,  1. ,  0. ,  0. ,  0. ],</span>
<span class="go">        [ 0. ,  0. ,  1. ,  0. ,  0. ],</span>
<span class="go">        [ 0. ,  0. ,  0. ,  1. ,  0. ],</span>
<span class="go">        [ 0. ,  0. ,  0. ,  0. ,  1. ]])</span>
</pre></div>
</div>
</dd>
<dt>Now, we can rework the algorithm above:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">newCov</span> <span class="o">=</span> <span class="n">stackVertical</span><span class="p">(</span> <span class="p">[</span> <span class="n">stackHorizontal</span><span class="p">(</span> <span class="p">[</span> <span class="n">dataCov</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span> <span class="p">(</span> <span class="n">dataCov</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">priorCov</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">]</span> <span class="p">),</span> <span class="n">stackHorizontal</span><span class="p">(</span> <span class="p">[</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span> <span class="p">(</span> <span class="n">priorCov</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dataCov</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="p">),</span> <span class="n">priorCov</span> <span class="p">]</span> <span class="p">)</span> <span class="p">]</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newCov</span>
<span class="go">matrix([[  1.  ,   0.1 ,   0.1 ,   0.  ,   0.  ,   0.  ,   0.  ,   0.  ],</span>
<span class="go">        [  0.1 ,   1.  ,   0.1 ,   0.  ,   0.  ,   0.  ,   0.  ,   0.  ],</span>
<span class="go">        [  0.1 ,   0.1 ,   1.  ,   0.  ,   0.  ,   0.  ,   0.  ,   0.  ],</span>
<span class="go">        [  0.  ,   0.  ,   0.  ,   0.07,   0.  ,   0.  ,   0.  ,   0.  ],</span>
<span class="go">        [  0.  ,   0.  ,   0.  ,   0.  ,   0.5 ,   0.  ,   0.  ,   0.  ],</span>
<span class="go">        [  0.  ,   0.  ,   0.  ,   0.  ,   0.  ,   0.4 ,   0.  ,   0.  ],</span>
<span class="go">        [  0.  ,   0.  ,   0.  ,   0.  ,   0.  ,   0.  ,   0.1 ,   0.  ],</span>
<span class="go">        [  0.  ,   0.  ,   0.  ,   0.  ,   0.  ,   0.  ,   0.  ,  20.  ]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">modelCov</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span> <span class="n">newKernel</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span> <span class="n">newCov</span> <span class="p">)</span> <span class="o">*</span> <span class="n">newKernel</span> <span class="p">)</span> <span class="c"># use Moore-Penrose generalized inverse (ie SVD inversion)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">modelCov</span>
<span class="go">matrix([[  6.30909610e-02,  -5.01795451e-02,   5.99338297e-03,  0.00000000e+00,   0.00000000e+00],</span>
<span class="go">        [ -5.01795451e-02,   9.30182090e-02,  -5.02878134e-02,  0.00000000e+00,   0.00000000e+00],</span>
<span class="go">        [  5.99338297e-03,  -5.02878134e-02,   7.63220083e-02,  0.00000000e+00,   0.00000000e+00],</span>
<span class="go">        [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,  1.00000000e-01,   0.00000000e+00],</span>
<span class="go">        [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,  0.00000000e+00,   2.00000000e+01]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">modelCov</span> <span class="o">*</span> <span class="n">newKernel</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span> <span class="n">newCov</span> <span class="p">)</span> <span class="o">*</span> <span class="n">newData</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span>
<span class="go">matrix([[  1.30359097],</span>
<span class="go">        [ -0.64662084],</span>
<span class="go">        [  0.32428234],</span>
<span class="go">        [  0.11      ],</span>
<span class="go">        [ 42.2       ]])</span>
</pre></div>
</div>
</dd>
<dt>A good prior gives a good result:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">residual</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">T</span> <span class="o">-</span> <span class="n">kernel</span> <span class="o">*</span> <span class="n">model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">residual</span>
<span class="go">matrix([[ 0.11680368],</span>
<span class="go">        [-0.0744488 ],</span>
<span class="go">        [ 0.02702848]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">error</span> <span class="o">=</span> <span class="n">answer</span><span class="o">.</span><span class="n">T</span> <span class="o">-</span> <span class="n">model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">error</span>
<span class="go">matrix([[ 0.04524624],</span>
<span class="go">        [-0.05105358],</span>
<span class="go">        [ 0.02455487],</span>
<span class="go">        [-0.01      ],</span>
<span class="go">        [-0.2       ]])</span>
</pre></div>
</div>
</dd>
<dt>The final uncertainty is not bad:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">uncertainty</span> <span class="o">=</span> <span class="p">[</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">modelCov</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="n">modelCov</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uncertainty</span>
<span class="go">    [0.25117914115531315, 0.30498886706247513, 0.2762643810785747, 0.31622776601683794, 4.47213595499958]</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>A data+constraint+prior solution</strong></p>
<dl class="docutils">
<dt>Next, with everything (data+constraint+prior)...  First we stack the normal equation and the constraint equation:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">reallyNewData</span> <span class="o">=</span> <span class="n">stackHorizontal</span><span class="p">(</span> <span class="p">[</span> <span class="p">(</span> <span class="n">newKernel</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span> <span class="n">newCov</span> <span class="p">)</span> <span class="o">*</span> <span class="n">newData</span><span class="o">.</span><span class="n">T</span> <span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">constraintVector</span> <span class="p">]</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reallyNewData</span>
<span class="go">matrix([[ 35.04920635,  19.82814815,  14.56111111, 1.1, 2.11,  42.1 ]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reallyNewKernel</span> <span class="o">=</span> <span class="n">stackVertical</span><span class="p">(</span> <span class="p">[</span> <span class="n">newKernel</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span> <span class="n">newCov</span> <span class="p">)</span><span class="o">*</span><span class="n">newKernel</span><span class="p">,</span> <span class="n">constraintMatrix</span> <span class="p">]</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reallyNewKernel</span>
<span class="go">matrix([[ 37.13293651,  28.66666667,  15.97222222,   0.        ,   0.        ],</span>
<span class="go">        [ 28.66666667,  38.82962963,  23.33333333,   0.        ,   0.        ],</span>
<span class="go">        [ 15.97222222,  23.33333333,  27.22222222,   0.        ,   0.        ],</span>
<span class="go">        [  0.        ,   0.        ,   0.        ,  10.        ,   0.        ],</span>
<span class="go">        [  0.        ,   0.        ,   0.        ,   0.        ,   0.05      ],</span>
<span class="go">        [  0.        ,   0.        ,   0.        ,   1.        ,   1.        ]])</span>
</pre></div>
</div>
</dd>
<dt>Now we just invert the reallyNewKernel </dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span> <span class="n">reallyNewKernel</span> <span class="p">)</span> <span class="o">*</span> <span class="n">reallyNewData</span><span class="o">.</span><span class="n">T</span>
<span class="go">matrix([[  1.30359097],</span>
<span class="go">        [ -0.64662084],</span>
<span class="go">        [  0.32428234],</span>
<span class="go">        [  0.10999476],</span>
<span class="go">        [ 41.99052891]])</span>
</pre></div>
</div>
</dd>
<dt>The fit is just a little better than with the prior alone &#8211; but now the last element is nailed down:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">residual</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">T</span> <span class="o">-</span> <span class="n">kernel</span><span class="o">*</span><span class="n">model</span>
<span class="go">matrix([[ 0.11680368],</span>
<span class="go">        [-0.0744488 ],</span>
<span class="go">        [ 0.02702848]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">error</span> <span class="o">=</span> <span class="n">answer</span><span class="o">.</span><span class="n">T</span> <span class="o">-</span> <span class="n">model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">error</span>
<span class="go">matrix([[ 0.04524624],</span>
<span class="go">        [-0.05105358],</span>
<span class="go">        [ 0.02455487],</span>
<span class="go">        [-0.00999476],</span>
<span class="go">        [ 0.00947109]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">constraintMatrix</span><span class="o">*</span><span class="n">model</span>
<span class="go">matrix([[ 42.10052368]])</span>
</pre></div>
</div>
</dd>
<dt>We compute the covariance as the inverse of the reallyNewKernel:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">modelCov</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span> <span class="n">reallyNewKernel</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">modelCov</span>
<span class="go">matrix([[  6.30909610e-02,  -5.01795451e-02,   5.99338297e-03,  0.00000000e+00,   0.00000000e+00,   0.00000000e+00],</span>
<span class="go">        [ -5.01795451e-02,   9.30182090e-02,  -5.02878134e-02,  0.00000000e+00,   0.00000000e+00,   0.00000000e+00],</span>
<span class="go">        [  5.99338297e-03,  -5.02878134e-02,   7.63220083e-02,  0.00000000e+00,   0.00000000e+00,   0.00000000e+00],</span>
<span class="go">        [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,  9.99975063e-02,  -4.98740680e-04,   2.49370340e-05],</span>
<span class="go">        [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00, -9.97481360e-02,   5.03728087e-02,   9.97481360e-01]])</span>
</pre></div>
</div>
</dd>
<dt>The new uncertainties are much reduced:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">uncertainty</span> <span class="o">=</span> <span class="p">[</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">modelCov</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="n">modelCov</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uncertainty</span>
<span class="go">[0.25117914115531315, 0.30498886706247513, 0.2762643810785747, 0.316223823100982, 0.22443887510442173]</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>A data+constraint solution</strong></p>
<p>Let&#8217;s see how well we do using just the constraints and the data fitting.  As before, we stack the 
normal and constraint equation, but this time use the old kernel and old data (that is, without the prior):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">reallyNewData</span> <span class="o">=</span> <span class="n">stackHorizontal</span><span class="p">(</span> <span class="p">[</span> <span class="p">(</span> <span class="n">kernel</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span> <span class="n">dataCov</span> <span class="p">)</span> <span class="o">*</span> <span class="n">data</span><span class="o">.</span><span class="n">T</span> <span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">constraintVector</span> <span class="p">]</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reallyNewData</span>
<span class="go">matrix([[ 16.47777778,  21.22814815,  13.81111111,   0.        , 0.        ,  42.1       ]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reallyNewKernel</span> <span class="o">=</span> <span class="n">stackVertical</span><span class="p">(</span> <span class="p">[</span> <span class="n">kernel</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span> <span class="n">dataCov</span> <span class="p">)</span><span class="o">*</span><span class="n">kernel</span><span class="p">,</span> <span class="n">constraintMatrix</span> <span class="p">]</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reallyNewKernel</span>
<span class="go">matrix([[ 22.84722222,  28.66666667,  15.97222222,   0.        ,   0.        ],</span>
<span class="go">        [ 28.66666667,  36.82962963,  23.33333333,   0.        ,   0.        ],</span>
<span class="go">        [ 15.97222222,  23.33333333,  24.72222222,   0.        ,   0.        ],</span>
<span class="go">        [  0.        ,   0.        ,   0.        ,   0.        ,   0.        ],</span>
<span class="go">        [  0.        ,   0.        ,   0.        ,   0.        ,   0.        ],</span>
<span class="go">        [  0.        ,   0.        ,   0.        ,   1.        ,   1.        ]])</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Now we just invert the reallyNewKernel </dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span> <span class="n">reallyNewKernel</span> <span class="p">)</span> <span class="o">*</span> <span class="n">reallyNewData</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span>
<span class="go">matrix([[  0.66232558],</span>
<span class="go">        [ -0.05465116],</span>
<span class="go">        [  0.18232558],</span>
<span class="go">        [ 21.05      ],</span>
<span class="go">        [ 21.05      ]])</span>
</pre></div>
</div>
</dd>
<dt>Ack!  it made sure the constraint is obeyed, by divying up the 42.1 among the two uncontrolled model parameters!</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">residual</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">T</span> <span class="o">-</span> <span class="n">kernel</span><span class="o">*</span><span class="n">model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">residual</span> 
<span class="go">matrix([[ -1.07913678e-13],</span>
<span class="go">        [ -2.13828955e-13],</span>
<span class="go">        [ -4.26325641e-13]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">error</span> <span class="o">=</span> <span class="n">answer</span><span class="o">.</span><span class="n">T</span><span class="o">-</span><span class="n">model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">error</span>
<span class="go">matrix([[  0.68651163],</span>
<span class="go">        [ -0.64302326],</span>
<span class="go">        [  0.16651163],</span>
<span class="go">        [-20.95      ],</span>
<span class="go">        [ 20.95      ]])</span>
</pre></div>
</div>
</dd>
</dl>
<p>What is telling is that, to accomodate the constraint, all the uncertainty had to be shifted to the first 
three components of the model:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">modelCov</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span> <span class="n">reallyNewKernel</span> <span class="p">)</span> <span class="c"># use Moore-Penrose generalized inverse (ie SVD inversion)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">modelCov</span>
<span class="go">matrix([[ 19.2436993 , -17.66414278,   4.23904813,   0.        ,0.        ,   0.        ],</span>
<span class="go">        [-17.66414278,  16.28177393,  -3.95484045,   0.        ,0.        ,   0.        ],</span>
<span class="go">        [  4.23904813,  -3.95484045,   1.03439697,   0.        ,0.        ,   0.        ],</span>
<span class="go">        [  0.        ,   0.        ,   0.        ,   0.        ,0.        ,   0.5       ],</span>
<span class="go">        [  0.        ,   0.        ,   0.        ,   0.        ,0.        ,   0.5       ]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uncertainty</span> <span class="o">=</span> <span class="p">[</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">modelCov</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="n">modelCov</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uncertainty</span> 
<span class="go">[4.386764103176406, 4.035068020722195, 1.0170530818673396, 0.0, 0.0]</span>
</pre></div>
</div>
<p>The moral is that we&#8217;d better know what spaces are constrainted by data and which ones are not!!!</p>
</dd></dl>

<dl class="function">
<dt id="fudge.core.math.linearAlgebra.check_covariance_element_bounds">
<tt class="descclassname">fudge.core.math.linearAlgebra.</tt><tt class="descname">check_covariance_element_bounds</tt><big>(</big><em>A</em>, <em>warnAll=False</em>, <em>verbose=False</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/linearAlgebra.html#check_covariance_element_bounds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.linearAlgebra.check_covariance_element_bounds" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="fudge.core.math.linearAlgebra.check_positive_semidefinite">
<tt class="descclassname">fudge.core.math.linearAlgebra.</tt><tt class="descname">check_positive_semidefinite</tt><big>(</big><em>A</em>, <em>warnAll=False</em>, <em>verbose=False</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/linearAlgebra.html#check_positive_semidefinite"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.linearAlgebra.check_positive_semidefinite" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks that all elements in a matrix are <span class="math">\(\leq 0\)</span></p>
</dd></dl>

<dl class="function">
<dt id="fudge.core.math.linearAlgebra.check_real_and_finite">
<tt class="descclassname">fudge.core.math.linearAlgebra.</tt><tt class="descname">check_real_and_finite</tt><big>(</big><em>A</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/linearAlgebra.html#check_real_and_finite"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.linearAlgebra.check_real_and_finite" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks that all elements in a matrix are read and finite</p>
</dd></dl>

<dl class="function">
<dt id="fudge.core.math.linearAlgebra.check_symmetric">
<tt class="descclassname">fudge.core.math.linearAlgebra.</tt><tt class="descname">check_symmetric</tt><big>(</big><em>A</em>, <em>warnAll=False</em>, <em>verbose=False</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/linearAlgebra.html#check_symmetric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.linearAlgebra.check_symmetric" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks whether a matrix is symmetric, i.e. <span class="math">\(A_{ij} = A_{ji}\)</span></p>
</dd></dl>

<dl class="function">
<dt id="fudge.core.math.linearAlgebra.correlation_to_covariance">
<tt class="descclassname">fudge.core.math.linearAlgebra.</tt><tt class="descname">correlation_to_covariance</tt><big>(</big><em>correlationMatrix</em>, <em>data</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/linearAlgebra.html#correlation_to_covariance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.linearAlgebra.correlation_to_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a correlation matrix to a covariance matrix</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">not implemented</p>
</div>
</dd></dl>

<dl class="function">
<dt id="fudge.core.math.linearAlgebra.correlation_to_relative">
<tt class="descclassname">fudge.core.math.linearAlgebra.</tt><tt class="descname">correlation_to_relative</tt><big>(</big><em>correlationMatrix</em>, <em>data</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/linearAlgebra.html#correlation_to_relative"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.linearAlgebra.correlation_to_relative" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a correlation matrix to a relative covariance matrix</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">not implemented</p>
</div>
</dd></dl>

<dl class="function">
<dt id="fudge.core.math.linearAlgebra.covariance_to_correlation">
<tt class="descclassname">fudge.core.math.linearAlgebra.</tt><tt class="descname">covariance_to_correlation</tt><big>(</big><em>covarianceMatrix</em>, <em>data</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/linearAlgebra.html#covariance_to_correlation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.linearAlgebra.covariance_to_correlation" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a covariance matrix to a correlation matrix</p>
</dd></dl>

<dl class="function">
<dt id="fudge.core.math.linearAlgebra.covariance_to_relative">
<tt class="descclassname">fudge.core.math.linearAlgebra.</tt><tt class="descname">covariance_to_relative</tt><big>(</big><em>covarianceMatrix</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/linearAlgebra.html#covariance_to_relative"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.linearAlgebra.covariance_to_relative" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert an absolute covariance matrix to a relative covariance matrix</p>
</dd></dl>

<dl class="function">
<dt id="fudge.core.math.linearAlgebra.diff_matrices">
<tt class="descclassname">fudge.core.math.linearAlgebra.</tt><tt class="descname">diff_matrices</tt><big>(</big><em>matrixOne</em>, <em>matrixTwo</em>, <em>printDiagnostics=True</em>, <em>quiet=True</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/linearAlgebra.html#diff_matrices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.linearAlgebra.diff_matrices" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="fudge.core.math.linearAlgebra.dot_product">
<tt class="descclassname">fudge.core.math.linearAlgebra.</tt><tt class="descname">dot_product</tt><big>(</big><em>*args</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/linearAlgebra.html#dot_product"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.linearAlgebra.dot_product" title="Permalink to this definition">¶</a></dt>
<dd><p>Matrix multiplication (dot product) of all arguments:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">dotproduct</span><span class="p">(</span><span class="n">V</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">A</span> <span class="o">*</span> <span class="n">V</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="fudge.core.math.linearAlgebra.eigenvectors_from_orthoganal_matrix">
<tt class="descclassname">fudge.core.math.linearAlgebra.</tt><tt class="descname">eigenvectors_from_orthoganal_matrix</tt><big>(</big><em>O</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/linearAlgebra.html#eigenvectors_from_orthoganal_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.linearAlgebra.eigenvectors_from_orthoganal_matrix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="fudge.core.math.linearAlgebra.extract_uncertainty">
<tt class="descclassname">fudge.core.math.linearAlgebra.</tt><tt class="descname">extract_uncertainty</tt><big>(</big><em>covarianceMatrix</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/linearAlgebra.html#extract_uncertainty"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.linearAlgebra.extract_uncertainty" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="fudge.core.math.linearAlgebra.extract_variance">
<tt class="descclassname">fudge.core.math.linearAlgebra.</tt><tt class="descname">extract_variance</tt><big>(</big><em>covarianceMatrix</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/linearAlgebra.html#extract_variance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.linearAlgebra.extract_variance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="fudge.core.math.linearAlgebra.fit_statistics">
<tt class="descclassname">fudge.core.math.linearAlgebra.</tt><tt class="descname">fit_statistics</tt><big>(</big><em>data</em>, <em>dataCov</em>, <em>kernel</em>, <em>model</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/linearAlgebra.html#fit_statistics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.linearAlgebra.fit_statistics" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="fudge.core.math.linearAlgebra.get_covariances_from_endf">
<tt class="descclassname">fudge.core.math.linearAlgebra.</tt><tt class="descname">get_covariances_from_endf</tt><big>(</big><em>endfFile</em>, <em>MT</em>, <em>MF=33</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/linearAlgebra.html#get_covariances_from_endf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.linearAlgebra.get_covariances_from_endf" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="fudge.core.math.linearAlgebra.get_test_matrix">
<tt class="descclassname">fudge.core.math.linearAlgebra.</tt><tt class="descname">get_test_matrix</tt><big>(</big><em>endfFile=None</em>, <em>MT=None</em>, <em>MF=None</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/linearAlgebra.html#get_test_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.linearAlgebra.get_test_matrix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="fudge.core.math.linearAlgebra.hist_interp_of_matrix">
<tt class="descclassname">fudge.core.math.linearAlgebra.</tt><tt class="descname">hist_interp_of_matrix</tt><big>(</big><em>supergrid</em>, <em>mat</em>, <em>erows</em>, <em>ecols=None</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/linearAlgebra.html#hist_interp_of_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.linearAlgebra.hist_interp_of_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Put &#8216;histogram&#8217; interpolation of matrix onto a new <cite>supergrid</cite>:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>supergrid</strong> &#8211; energy list to use for new matrix</li>
<li><strong>mat</strong> &#8211; original matrix to be interpolated</li>
<li><strong>erows</strong> &#8211; energy bins for rows/x-axis of original matrix</li>
<li><strong>ecols</strong> &#8211; energy bins for columns/y-axis, same as ex by default</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>all points in <cite>erows</cite> and <cite>ecols</cite> must also be in supergrid, 
or ValueError is raised</p>
</dd></dl>

<dl class="function">
<dt id="fudge.core.math.linearAlgebra.matrix_from_eigendecomposition">
<tt class="descclassname">fudge.core.math.linearAlgebra.</tt><tt class="descname">matrix_from_eigendecomposition</tt><big>(</big><em>e</em>, <em>v</em>, <em>ndim</em>, <em>doInverse=False</em>, <em>onlyLargeEVs=True</em>, <em>onlyPositiveEV=True</em>, <em>smallEVAbsTol=1e-10</em>, <em>smallEVRelTol=1e-06</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/linearAlgebra.html#matrix_from_eigendecomposition"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.linearAlgebra.matrix_from_eigendecomposition" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="fudge.core.math.linearAlgebra.off_diagonals">
<tt class="descclassname">fudge.core.math.linearAlgebra.</tt><tt class="descname">off_diagonals</tt><big>(</big><em>matrix</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/linearAlgebra.html#off_diagonals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.linearAlgebra.off_diagonals" title="Permalink to this definition">¶</a></dt>
<dd><p>Return indices for all off-diagonal elements.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span><span class="p">[</span> <span class="n">offdiag</span><span class="p">(</span> <span class="n">mat</span> <span class="p">)</span> <span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="fudge.core.math.linearAlgebra.plot_bad_eigenspaces">
<tt class="descclassname">fudge.core.math.linearAlgebra.</tt><tt class="descname">plot_bad_eigenspaces</tt><big>(</big><em>A</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/linearAlgebra.html#plot_bad_eigenspaces"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.linearAlgebra.plot_bad_eigenspaces" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="fudge.core.math.linearAlgebra.plot_matrix">
<tt class="descclassname">fudge.core.math.linearAlgebra.</tt><tt class="descname">plot_matrix</tt><big>(</big><em>m</em>, <em>title='a matrix'</em>, <em>scaling=None</em>, <em>scalingFloor=0.0</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/linearAlgebra.html#plot_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.linearAlgebra.plot_matrix" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>m</strong> &#8211; a numpy.mat instance</li>
<li><strong>title</strong> &#8211; a string to use as the plot title</li>
<li><strong>scaling</strong> &#8211; <p>either None, &#8216;log&#8217;, or &#8216;asinh&#8217;
this scales the value of the matrix plotted in the following ways</p>
<div class="highlight-python"><div class="highlight"><pre>* None : no scaling
* &#39;log&#39; : each element is plotted as ln(x) -- good for covariances
  which must always be positive semidefinite.  If scalingFloor &gt; 0.0, 
  than we do ln(max(x, scalingFloor)).
* &#39;asinh&#39; : each element is scaled as asinh(x).  This exaggerates 
  scale for values of abs(x)&lt;1.0.
</pre></div>
</div>
</li>
<li><strong>scalingFloor</strong> &#8211; the minimum value of each element that gets plotted.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="fudge.core.math.linearAlgebra.print_eigenvalues">
<tt class="descclassname">fudge.core.math.linearAlgebra.</tt><tt class="descname">print_eigenvalues</tt><big>(</big><em>A</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/linearAlgebra.html#print_eigenvalues"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.linearAlgebra.print_eigenvalues" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="fudge.core.math.linearAlgebra.print_matrix">
<tt class="descclassname">fudge.core.math.linearAlgebra.</tt><tt class="descname">print_matrix</tt><big>(</big><em>M</em>, <em>pretty=True</em>, <em>elementSize=8</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/linearAlgebra.html#print_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.linearAlgebra.print_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple matrix printer, makes little attempt to be pretty, but does print huge matrices</p>
</dd></dl>

<dl class="function">
<dt id="fudge.core.math.linearAlgebra.print_vector">
<tt class="descclassname">fudge.core.math.linearAlgebra.</tt><tt class="descname">print_vector</tt><big>(</big><em>v</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/linearAlgebra.html#print_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.linearAlgebra.print_vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="fudge.core.math.linearAlgebra.pruned_matrix">
<tt class="descclassname">fudge.core.math.linearAlgebra.</tt><tt class="descname">pruned_matrix</tt><big>(</big><em>A</em>, <em>onlyLargeEVs=True</em>, <em>onlyPositiveEV=True</em>, <em>smallEVAbsTol=1e-10</em>, <em>smallEVRelTol=1e-06</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/linearAlgebra.html#pruned_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.linearAlgebra.pruned_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Rebuild <span class="math">\(A\)</span> &#8220;by hand&#8221;, the safe way.   <span class="math">\(A\)</span> must admit an eigenvalue decomposition.</p>
</dd></dl>

<dl class="function">
<dt id="fudge.core.math.linearAlgebra.pruned_matrix_inverse">
<tt class="descclassname">fudge.core.math.linearAlgebra.</tt><tt class="descname">pruned_matrix_inverse</tt><big>(</big><em>e</em>, <em>v</em>, <em>onlyLargeEVs=True</em>, <em>onlyPositiveEV=True</em>, <em>smallEVAbsTol=1e-10</em>, <em>smallEVRelTol=1e-06</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/linearAlgebra.html#pruned_matrix_inverse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.linearAlgebra.pruned_matrix_inverse" title="Permalink to this definition">¶</a></dt>
<dd><p>Build inverse of <span class="math">\(A\)</span> &#8220;by hand&#8221;, the safe way.   <span class="math">\(A\)</span> must admit an eigenvalue decomposition.</p>
</dd></dl>

<dl class="function">
<dt id="fudge.core.math.linearAlgebra.rebin_matrix">
<tt class="descclassname">fudge.core.math.linearAlgebra.</tt><tt class="descname">rebin_matrix</tt><big>(</big><em>arr</em>, <em>N=2</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/linearAlgebra.html#rebin_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.linearAlgebra.rebin_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Rebin array by factor of N (not necessarily multiple of 2)</p>
</dd></dl>

<dl class="function">
<dt id="fudge.core.math.linearAlgebra.reduce_off_diagonals">
<tt class="descclassname">fudge.core.math.linearAlgebra.</tt><tt class="descname">reduce_off_diagonals</tt><big>(</big><em>corr_mat</em>, <em>thresh</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/linearAlgebra.html#reduce_off_diagonals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.linearAlgebra.reduce_off_diagonals" title="Permalink to this definition">¶</a></dt>
<dd><p>Sometimes easiest way to eliminate negative eigenvalues is to 
reduce off-diagonal portion of the correlation matrix</p>
</dd></dl>

<dl class="function">
<dt id="fudge.core.math.linearAlgebra.relative_to_correlation">
<tt class="descclassname">fudge.core.math.linearAlgebra.</tt><tt class="descname">relative_to_correlation</tt><big>(</big><em>relativeMatrix</em>, <em>data</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/linearAlgebra.html#relative_to_correlation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.linearAlgebra.relative_to_correlation" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a relative covariance matrix to a correlation matrix</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">not implemented</p>
</div>
</dd></dl>

<dl class="function">
<dt id="fudge.core.math.linearAlgebra.relative_to_covariance">
<tt class="descclassname">fudge.core.math.linearAlgebra.</tt><tt class="descname">relative_to_covariance</tt><big>(</big><em>relativeMatrix</em>, <em>variance</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/linearAlgebra.html#relative_to_covariance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.linearAlgebra.relative_to_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a relative covariance matrix to an absolute covariance matrix</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">not implemented</p>
</div>
</dd></dl>

<dl class="function">
<dt id="fudge.core.math.linearAlgebra.scale_off_diagonals">
<tt class="descclassname">fudge.core.math.linearAlgebra.</tt><tt class="descname">scale_off_diagonals</tt><big>(</big><em>A</em>, <em>onlyScaleThese=None</em>, <em>scaleFactor=0.999999</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/linearAlgebra.html#scale_off_diagonals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.linearAlgebra.scale_off_diagonals" title="Permalink to this definition">¶</a></dt>
<dd><p>Sam&#8217;s trick for getting UNCOR to cooperate: shrink off diagonal elements by some (small) factor</p>
</dd></dl>

<dl class="function">
<dt id="fudge.core.math.linearAlgebra.stackDiagonal">
<tt class="descclassname">fudge.core.math.linearAlgebra.</tt><tt class="descname">stackDiagonal</tt><big>(</big><em>l</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/linearAlgebra.html#stackDiagonal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.linearAlgebra.stackDiagonal" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>l</strong> &#8211; a list of numpy matrices, elements equal to None are ignored</td>
</tr>
</tbody>
</table>
<p>A note about numpy.matrix shapes and indexing</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">a</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">[</span> <span class="n">nRows</span><span class="p">,</span> <span class="n">nCols</span> <span class="p">]</span>
</pre></div>
</div>
<p>So, we index through <tt class="docutils literal"><span class="pre">a[</span> <span class="pre">iRow,</span> <span class="pre">iCol</span> <span class="pre">]</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a matrix packed as follows<div class="highlight-python"><div class="highlight"><pre>[  l[0]  |  0.0  |  0.0 | ... |   0.0  ]
[ ------ | ----- | ---- | ... | ------ ]
[   0.0  | l[1]  |  0.0 | ... |   0.0  ]
[ ------ | ----- | ---- | ... | ------ ]
[   0.0  |  0.0  | l[2] | ... |   0.0  ]
[ ------ | ----- | ---- | ... | ------ ]
[    :   |   :   |  :   |     |    :   ]
[ ------ | ----- | ---- | ... | ------ ]
[   0.0  |  0.0  |  0.0 | ... | l[n-1] ]
</pre></div>
</div>
<p>where n is the number of non-None elements in l</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="fudge.core.math.linearAlgebra.stackHorizontal">
<tt class="descclassname">fudge.core.math.linearAlgebra.</tt><tt class="descname">stackHorizontal</tt><big>(</big><em>l</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/linearAlgebra.html#stackHorizontal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.linearAlgebra.stackHorizontal" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>l</strong> &#8211; a list of numpy matrices, each with same shape[0] (i.e. same number of rows).  Elements equal to None are ignored</td>
</tr>
</tbody>
</table>
<p>A note about numpy.matrix shapes and indexing</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">a</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">[</span> <span class="n">nRows</span><span class="p">,</span> <span class="n">nCols</span> <span class="p">]</span>
</pre></div>
</div>
<p>So, we index through <tt class="docutils literal"><span class="pre">a[</span> <span class="pre">iRow,</span> <span class="pre">iCol</span> <span class="pre">]</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a matrix packed as follows<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span>  <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="o">|</span> <span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="o">|</span> <span class="o">...</span> <span class="o">|</span> <span class="n">l</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">]</span>
</pre></div>
</div>
<p>where n is the number of non-None elements in l</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="fudge.core.math.linearAlgebra.stackVertical">
<tt class="descclassname">fudge.core.math.linearAlgebra.</tt><tt class="descname">stackVertical</tt><big>(</big><em>l</em><big>)</big><a class="reference internal" href="../_modules/fudge/core/math/linearAlgebra.html#stackVertical"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fudge.core.math.linearAlgebra.stackVertical" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>l</strong> &#8211; a list of numpy matrices, each with same <cite>shape[1]</cite> (i.e. same number of columns).  Elements equal to None are ignored</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">a matrix packed as follows<div class="highlight-python"><div class="highlight"><pre>[  l[0]  ]
[ ------ ]
[  l[1]  ]
[ ------ ]
[    :   ]
[ ------ ]
[ l[n-1] ]
</pre></div>
</div>
<p>where n is the number of non-None elements in l</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="fudge.core.math.test.html">test Package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="fudge.core.math.test.html#id1"><tt class="docutils literal"><span class="pre">test</span></tt> Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="fudge.core.math.test.html#module-fudge.core.math.test.testFudgeMath"><tt class="docutils literal"><span class="pre">testFudgeMath</span></tt> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="fudge.core.math.test.html#module-fudge.core.math.test.testXYs"><tt class="docutils literal"><span class="pre">testXYs</span></tt> Module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="fudge.core.math.xData.html">xData Package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="fudge.core.math.xData.html#id1"><tt class="docutils literal"><span class="pre">xData</span></tt> Package</a></li>
<li class="toctree-l2"><a class="reference internal" href="fudge.core.math.xData.html#module-fudge.core.math.xData.LegendreSeries"><tt class="docutils literal"><span class="pre">LegendreSeries</span></tt> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="fudge.core.math.xData.html#module-fudge.core.math.xData.V_W_XYs"><tt class="docutils literal"><span class="pre">V_W_XYs</span></tt> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="fudge.core.math.xData.html#module-fudge.core.math.xData.W_XYs"><tt class="docutils literal"><span class="pre">W_XYs</span></tt> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="fudge.core.math.xData.html#module-fudge.core.math.xData.XYs"><tt class="docutils literal"><span class="pre">XYs</span></tt> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="fudge.core.math.xData.html#module-fudge.core.math.xData.axes"><tt class="docutils literal"><span class="pre">axes</span></tt> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="fudge.core.math.xData.html#module-fudge.core.math.xData.polynomial"><tt class="docutils literal"><span class="pre">polynomial</span></tt> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="fudge.core.math.xData.html#module-fudge.core.math.xData.regions"><tt class="docutils literal"><span class="pre">regions</span></tt> Module</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/gnd.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">math Package</a><ul>
<li><a class="reference internal" href="#id1"><tt class="docutils literal"><span class="pre">math</span></tt> Package</a></li>
<li><a class="reference internal" href="#endl1dmathclasses-module"><tt class="docutils literal"><span class="pre">endl1dmathClasses</span></tt> Module</a></li>
<li><a class="reference internal" href="#endl1dmathmisc-module"><tt class="docutils literal"><span class="pre">endl1dmathmisc</span></tt> Module</a></li>
<li><a class="reference internal" href="#endl2dmathclasses-module"><tt class="docutils literal"><span class="pre">endl2dmathClasses</span></tt> Module</a></li>
<li><a class="reference internal" href="#endl2dmathmisc-module"><tt class="docutils literal"><span class="pre">endl2dmathmisc</span></tt> Module</a></li>
<li><a class="reference internal" href="#endl3dmathclasses-module"><tt class="docutils literal"><span class="pre">endl3dmathClasses</span></tt> Module</a></li>
<li><a class="reference internal" href="#endl3dmathmisc-module"><tt class="docutils literal"><span class="pre">endl3dmathmisc</span></tt> Module</a></li>
<li><a class="reference internal" href="#endl4dmathclasses-module"><tt class="docutils literal"><span class="pre">endl4dmathClasses</span></tt> Module</a></li>
<li><a class="reference internal" href="#endl4dmathmisc-module"><tt class="docutils literal"><span class="pre">endl4dmathmisc</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-fudge.core.math.fudge2dGrouping"><tt class="docutils literal"><span class="pre">fudge2dGrouping</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-fudge.core.math.fudgemath"><tt class="docutils literal"><span class="pre">fudgemath</span></tt> Module</a></li>
<li><a class="reference internal" href="#parameters-module"><tt class="docutils literal"><span class="pre">parameters</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-fudge.core.math.pointwiseXY"><tt class="docutils literal"><span class="pre">pointwiseXY</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-fudge.core.math.table"><tt class="docutils literal"><span class="pre">table</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-fudge.core.math.matrix"><tt class="docutils literal"><span class="pre">matrix</span></tt> Module</a></li>
<li><a class="reference internal" href="#module-fudge.core.math.linearAlgebra"><tt class="docutils literal"><span class="pre">linearAlgebra</span></tt> Module</a></li>
<li><a class="reference internal" href="#subpackages">Subpackages</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="fudge.core.html"
                        title="previous chapter">core Package</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="fudge.core.math.test.html"
                        title="next chapter">test Package</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/fudge/fudge.core.math.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="fudge.core.math.test.html" title="test Package"
             >next</a> |</li>
        <li class="right" >
          <a href="fudge.core.html" title="core Package"
             >previous</a> |</li>
        <li><a href="../index.html">Fudge and GND 1.3 beta documentation</a> &raquo;</li>
          <li><a href="index.html" >fudge Package</a> &raquo;</li>
          <li><a href="fudge.core.html" >core Package</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, B.Beck, D. Brown, C. Mattoon, N. Patel, N. Summers.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>