
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>fudge.legacy.endl.endl2 &mdash; Fudge and GND 1.2 beta documentation</title>
    
    <link rel="stylesheet" href="../../../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '1.2 beta',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../../../_static/gnd-20121206-favicon.ico"/>
    <link rel="top" title="Fudge and GND 1.2 beta documentation" href="../../../../index.html" />
    <link rel="up" title="Module code" href="../../../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../../index.html">Fudge and GND 1.2 beta documentation</a> &raquo;</li>
          <li><a href="../../../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for fudge.legacy.endl.endl2</h1><div class="highlight"><pre>
<span class="c"># &lt;&lt;BEGIN-copyright&gt;&gt;</span>
<span class="c"># &lt;&lt;END-copyright&gt;&gt;</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This module contains miscellaneous functions.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">fudge.core.utilities</span> <span class="kn">import</span> <span class="n">brb</span>
<span class="kn">from</span> <span class="nn">fudge.core.utilities</span> <span class="kn">import</span> <span class="n">fudgeZA</span>
<span class="kn">import</span> <span class="nn">endl_C</span>
<span class="kn">import</span> <span class="nn">endl_I</span>
<span class="kn">import</span> <span class="nn">endl_Z</span>
<span class="kn">import</span> <span class="nn">endl_y</span>

<div class="viewcode-block" id="CInfo"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.endl.html#fudge.legacy.endl.endl2.CInfo">[docs]</a><span class="k">def</span> <span class="nf">CInfo</span><span class="p">(</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">4</span> <span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Prints a list of C and brief description for supported C-values.&quot;&quot;&quot;</span>

    <span class="n">n</span> <span class="o">=</span> <span class="n">endl_C</span><span class="o">.</span><span class="n">endl_nCMax</span><span class="p">(</span> <span class="p">)</span>
    <span class="n">l</span> <span class="o">=</span> <span class="n">endl_C</span><span class="o">.</span><span class="n">endl_CLabelMaxWidth</span><span class="p">(</span> <span class="p">)</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">l</span> <span class="o">&lt;</span> <span class="mi">4</span> <span class="p">)</span> <span class="p">:</span> <span class="n">l</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">Fmt</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%%</span><span class="s">4d </span><span class="si">%%%d</span><span class="s">s&quot;</span> <span class="o">%</span> <span class="n">l</span>
    <span class="n">Cs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">while</span><span class="p">(</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="p">)</span> <span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">endl_C</span><span class="o">.</span><span class="n">endl_CLabel</span><span class="p">(</span> <span class="n">i</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">s</span> <span class="o">==</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span> <span class="n">s</span> <span class="o">=</span> <span class="s">&quot;----&quot;</span>
        <span class="n">Cs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">Fmt</span> <span class="o">%</span> <span class="p">(</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="p">)</span> <span class="p">)</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">brb</span><span class="o">.</span><span class="n">tylist</span><span class="p">(</span> <span class="n">Cs</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">w</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s">&quot;  |&quot;</span> <span class="p">)</span>
</div>
<div class="viewcode-block" id="IInfo"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.endl.html#fudge.legacy.endl.endl2.IInfo">[docs]</a><span class="k">def</span> <span class="nf">IInfo</span><span class="p">(</span> <span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Prints a list of I, number of columns and brief description for supported I-values.&quot;&quot;&quot;</span>

    <span class="n">I</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">print</span> <span class="s">&quot;   I cols  comment&quot;</span>
    <span class="k">print</span> <span class="s">&quot;-----------------&quot;</span>
    <span class="k">while</span><span class="p">(</span> <span class="n">I</span> <span class="o">&lt;</span> <span class="mi">100</span> <span class="p">)</span> <span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">endl_I</span><span class="o">.</span><span class="n">endl_ILabel</span><span class="p">(</span> <span class="n">I</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">s</span> <span class="o">!=</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;</span><span class="si">%4d</span><span class="s"> </span><span class="si">%5d</span><span class="s">  </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">I</span><span class="p">,</span> <span class="n">endl_I</span><span class="o">.</span><span class="n">endl_IColumns</span><span class="p">(</span> <span class="n">I</span> <span class="p">),</span> <span class="n">s</span> <span class="p">)</span>
        <span class="n">I</span> <span class="o">+=</span> <span class="mi">1</span>
</div>
<div class="viewcode-block" id="yInfo"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.endl.html#fudge.legacy.endl.endl2.yInfo">[docs]</a><span class="k">def</span> <span class="nf">yInfo</span><span class="p">(</span> <span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Prints a list of y-id, symbol and name for supported projectiles.&quot;&quot;&quot;</span>

    <span class="n">ls</span> <span class="o">=</span> <span class="n">endl_y</span><span class="o">.</span><span class="n">endl_yLabelMaxWidth</span><span class="p">(</span> <span class="p">)</span>
    <span class="n">ll</span> <span class="o">=</span> <span class="n">endl_y</span><span class="o">.</span><span class="n">endl_yLongLabelMaxWidth</span><span class="p">(</span> <span class="p">)</span>
    <span class="n">Fmt</span> <span class="o">=</span> <span class="s">&quot;   y </span><span class="si">%%%d</span><span class="s">s </span><span class="si">%%%d</span><span class="s">s&quot;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">ls</span><span class="p">,</span> <span class="n">ll</span> <span class="p">)</span>
    <span class="k">print</span> <span class="n">Fmt</span> <span class="o">%</span> <span class="p">(</span> <span class="s">&quot;Symbol&quot;</span><span class="p">,</span> <span class="s">&quot;Name&quot;</span> <span class="p">)</span>
    <span class="n">dashes</span> <span class="o">=</span> <span class="p">(</span> <span class="mi">6</span> <span class="o">+</span> <span class="n">ls</span> <span class="o">+</span> <span class="n">ll</span> <span class="p">)</span> <span class="o">*</span> <span class="s">&quot;-&quot;</span>
    <span class="k">print</span> <span class="n">dashes</span>
    <span class="n">Fmt</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%%</span><span class="s">4d </span><span class="si">%%%d</span><span class="s">s </span><span class="si">%%%d</span><span class="s">s&quot;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">ls</span><span class="p">,</span> <span class="n">ll</span> <span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">while</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span>
        <span class="n">ls</span> <span class="o">=</span> <span class="n">endl_y</span><span class="o">.</span><span class="n">endl_yLabel</span><span class="p">(</span> <span class="n">y</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">ls</span> <span class="o">==</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span> <span class="k">break</span>
        <span class="n">ll</span> <span class="o">=</span> <span class="n">endl_y</span><span class="o">.</span><span class="n">endl_yLongLabel</span><span class="p">(</span> <span class="n">y</span> <span class="p">)</span>
        <span class="k">print</span> <span class="n">Fmt</span> <span class="o">%</span> <span class="p">(</span> <span class="n">y</span><span class="p">,</span> <span class="n">ls</span><span class="p">,</span> <span class="n">ll</span> <span class="p">)</span>
        <span class="n">y</span> <span class="o">+=</span> <span class="mi">1</span>
</div>
<div class="viewcode-block" id="ZInfo"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.endl.html#fudge.legacy.endl.endl2.ZInfo">[docs]</a><span class="k">def</span> <span class="nf">ZInfo</span><span class="p">(</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">2</span> <span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Prints a list of Z, symbol and name for most elements.&quot;&quot;&quot;</span>

    <span class="n">n</span> <span class="o">=</span> <span class="n">endl_Z</span><span class="o">.</span><span class="n">endl_nZs</span><span class="p">(</span> <span class="p">)</span>
    <span class="n">Zs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span><span class="p">(</span> <span class="n">Z</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="p">)</span> <span class="p">:</span>
        <span class="n">Zs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="s">&quot;</span><span class="si">%4d</span><span class="s"> </span><span class="si">%4s</span><span class="s"> </span><span class="si">%15s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">Z</span><span class="p">,</span> <span class="n">endl_Z</span><span class="o">.</span><span class="n">endl_ZSymbol</span><span class="p">(</span> <span class="n">Z</span> <span class="p">),</span> <span class="n">endl_Z</span><span class="o">.</span><span class="n">endl_ZLabel</span><span class="p">(</span> <span class="n">Z</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
        <span class="n">Z</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">brb</span><span class="o">.</span><span class="n">tylist</span><span class="p">(</span> <span class="n">Zs</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">w</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s">&quot;  |&quot;</span> <span class="p">)</span>
</div>
<div class="viewcode-block" id="ZAToYo"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.endl.html#fudge.legacy.endl.endl2.ZAToYo">[docs]</a><span class="k">def</span> <span class="nf">ZAToYo</span><span class="p">(</span> <span class="n">ZA</span> <span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns yo designator for ZA.  This mapping is not one-to-one as example</span>
<span class="sd">    ZA = 1001 could be yo = 2 or 12.  The smaller yo values is returned.&quot;&quot;&quot;</span>

    <span class="n">ZA_</span> <span class="o">=</span> <span class="n">ZA</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">ZA_</span> <span class="o">&gt;</span> <span class="mi">10</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">ZA_</span> <span class="o">&lt;</span> <span class="mi">20</span> <span class="p">)</span> <span class="p">:</span> <span class="n">ZA_</span> <span class="o">-=</span> <span class="mi">10</span>
    <span class="k">if</span> <span class="n">ZA_</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1001</span><span class="p">,</span> <span class="mi">1002</span><span class="p">,</span> <span class="mi">1003</span><span class="p">,</span> <span class="mi">2003</span><span class="p">,</span> <span class="mi">2004</span> <span class="p">]</span> <span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">ZA_</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span> <span class="mi">7</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">ZA_</span> <span class="o">&lt;</span> <span class="mi">1001</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span> <span class="n">ZA_</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">ZA_</span> <span class="o">==</span> <span class="mi">1001</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">ZA_</span> <span class="o">==</span> <span class="mi">1002</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span> <span class="mi">3</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">ZA_</span> <span class="o">==</span> <span class="mi">1003</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span> <span class="mi">4</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">ZA_</span> <span class="o">==</span> <span class="mi">2003</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span> <span class="mi">5</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">ZA_</span> <span class="o">==</span> <span class="mi">2004</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span> <span class="mi">6</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Error in ZAToYo: unsupported ZA value = </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="sb">`ZA`</span> <span class="p">)</span>
</div>
<div class="viewcode-block" id="yoToZA"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.endl.html#fudge.legacy.endl.endl2.yoToZA">[docs]</a><span class="k">def</span> <span class="nf">yoToZA</span><span class="p">(</span> <span class="n">yo_i</span> <span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns ZA designator, or special code, from yo id.  That is, ::</span>
<span class="sd">      yo_i = 0, 1,    2,    3,    4,    5,    6, 7,  8,  9,  10, 11,   12,   13,   14,   15,   16</span>
<span class="sd">      is converted to</span>
<span class="sd">             0, 1, 1001, 1002, 1003, 2003, 2004, 0, -8, -9, -10,  1, 1001, 1002, 1003, 2003, 2004</span>
<span class="sd">    with the following meanings ::</span>
<span class="sd">          none, n,    p,    d,    t,  He3,   He, g, b+, b-,  EC,  n,    p,    d,    t,  He3,   He.</span>
<span class="sd">    yo_i must be a python integer.&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">yo_i</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span> <span class="n">yo_i</span> <span class="o">&gt;</span> <span class="mi">16</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Error in yoToZA: unsupported yo value = </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="sb">`yo_i`</span> <span class="p">)</span>
    <span class="n">yo</span> <span class="o">=</span> <span class="n">yo_i</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">yo</span> <span class="o">&gt;</span> <span class="mi">10</span> <span class="p">)</span> <span class="p">:</span> <span class="n">yo</span> <span class="o">-=</span> <span class="mi">10</span>
    <span class="k">return</span> <span class="p">(</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1001</span><span class="p">,</span> <span class="mi">1002</span><span class="p">,</span> <span class="mi">1003</span><span class="p">,</span> <span class="mi">2003</span><span class="p">,</span> <span class="mi">2004</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span> <span class="p">)[</span><span class="n">yo</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="yoToZA_forNuclei"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.endl.html#fudge.legacy.endl.endl2.yoToZA_forNuclei">[docs]</a><span class="k">def</span> <span class="nf">yoToZA_forNuclei</span><span class="p">(</span> <span class="n">yo</span> <span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Same as yoToZA except returns 0 if yo is in [ 7, 8, 9, 17, 18, 19 ] (i.e., is a gamma, positron or electron).&quot;&quot;&quot;</span>

    <span class="k">if</span><span class="p">(</span> <span class="n">yo</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="mi">0</span> <span class="p">)</span>
    <span class="k">return</span><span class="p">(</span> <span class="n">yoToZA</span><span class="p">(</span> <span class="n">yo</span> <span class="p">)</span> <span class="p">)</span>
</div>
<div class="viewcode-block" id="ZandAFromZA"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.endl.html#fudge.legacy.endl.endl2.ZandAFromZA">[docs]</a><span class="k">def</span> <span class="nf">ZandAFromZA</span><span class="p">(</span> <span class="n">ZA</span> <span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns the tuple ( Z, A ) from a ZA designator.  ZA must be a python integer.&quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">endlmisc</span>
    <span class="n">ZA_</span> <span class="o">=</span> <span class="n">endlmisc</span><span class="o">.</span><span class="n">intZA</span><span class="p">(</span> <span class="n">ZA</span> <span class="p">)</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">ZA_</span> <span class="o">/</span> <span class="mi">1000</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">ZA_</span> <span class="o">-</span> <span class="mi">1000</span> <span class="o">*</span> <span class="n">Z</span>
    <span class="k">return</span> <span class="p">(</span> <span class="n">Z</span><span class="p">,</span> <span class="n">A</span> <span class="p">)</span>
</div>
<div class="viewcode-block" id="AFromZA"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.endl.html#fudge.legacy.endl.endl2.AFromZA">[docs]</a><span class="k">def</span> <span class="nf">AFromZA</span><span class="p">(</span> <span class="n">ZA</span> <span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns A from ZA designator ( ZA = 1000 * Z + A ).  ZA must be a python integer.&quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">ZandAFromZA</span><span class="p">(</span> <span class="n">ZA</span> <span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="ZFromZA"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.endl.html#fudge.legacy.endl.endl2.ZFromZA">[docs]</a><span class="k">def</span> <span class="nf">ZFromZA</span><span class="p">(</span> <span class="n">ZA</span> <span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;ZFromZA( ZA )</span>
<span class="sd">    Returns Z from ZA designator ( ZA = 1000 * Z + A ).  ZA must be a python integer.&quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">ZandAFromZA</span><span class="p">(</span> <span class="n">ZA</span> <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="residualZA_yos_Q"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.endl.html#fudge.legacy.endl.endl2.residualZA_yos_Q">[docs]</a><span class="k">def</span> <span class="nf">residualZA_yos_Q</span><span class="p">(</span> <span class="n">yi_</span><span class="p">,</span> <span class="n">ZA_</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">targetELevel</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">X4</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">specialCases</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">printQWarning</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">bdflsFile</span> <span class="o">=</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns a tuple containing the residual ZA&#39;, yos and Q for reaction of type </span>
<span class="sd">    C involving incident particle yi and target ZA.  yos is a list.  For example,</span>
<span class="sd">    the reation, ZA + yi -&gt; ZA&#39; + yo_1 + yo_2 + ... + yo_n + Q,</span>
<span class="sd">    would return ( ZA&#39;, [ yo_1, yo_2, ..., yo_n ], Q ).&quot;&quot;&quot;</span>

    <span class="k">if</span><span class="p">(</span> <span class="n">bdflsFile</span> <span class="o">==</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span>
        <span class="kn">from</span> <span class="nn">fudge.processing</span> <span class="kn">import</span> <span class="n">bdfls</span>
        <span class="n">bdflsFile</span> <span class="o">=</span> <span class="n">bdfls</span><span class="o">.</span><span class="n">getDefaultBdfls</span><span class="p">(</span> <span class="p">)</span>
    <span class="kn">import</span> <span class="nn">endlmisc</span>
    <span class="n">ZA</span><span class="p">,</span> <span class="n">Suffix</span> <span class="o">=</span> <span class="n">endlmisc</span><span class="o">.</span><span class="n">intZASuffix</span><span class="p">(</span> <span class="n">ZA_</span> <span class="p">)</span>
    <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="p">(</span> <span class="n">ZA</span> <span class="o">%</span> <span class="mi">1000</span> <span class="p">)</span> <span class="o">/</span> <span class="mi">100</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="mi">7</span> <span class="p">)</span> <span class="p">:</span> <span class="n">ZA</span> <span class="o">=</span> <span class="n">ZA</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">+</span> <span class="mi">1000</span> <span class="o">*</span> <span class="p">(</span> <span class="n">ZA</span> <span class="o">/</span> <span class="mi">1000</span> <span class="p">)</span>
    <span class="n">yi</span> <span class="o">=</span> <span class="n">endlmisc</span><span class="o">.</span><span class="n">incidentParticleTags</span><span class="p">(</span> <span class="n">yi_</span> <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="p">(</span> <span class="n">yi</span> <span class="o">==</span> <span class="mi">3</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">ZA</span> <span class="o">==</span> <span class="mi">1003</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">C</span> <span class="o">==</span> <span class="mi">30</span> <span class="p">)</span> <span class="p">)</span> <span class="ow">or</span>       <span class="c"># Added kludge to handle t(d,g n)He reaction.</span>
        <span class="p">(</span> <span class="p">(</span> <span class="n">yi</span> <span class="o">==</span> <span class="mi">4</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">ZA</span> <span class="o">==</span> <span class="mi">1002</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">C</span> <span class="o">==</span> <span class="mi">30</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
        <span class="n">yos</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span> <span class="p">]</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="n">yos</span> <span class="o">=</span> <span class="n">endl_C</span><span class="o">.</span><span class="n">endl_C_yoInfo</span><span class="p">(</span> <span class="n">C</span> <span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">yos</span> <span class="o">==</span> <span class="bp">None</span> <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span> <span class="n">yos</span> <span class="o">==</span> <span class="p">()</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span> <span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="p">(</span> <span class="p">),</span> <span class="bp">None</span><span class="p">)</span> <span class="c"># No such C-value or C-value does is not a reaction (e.g., C=1).</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">yos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span> <span class="p">(</span> <span class="n">ZA</span><span class="p">,</span> <span class="p">(</span> <span class="n">yi</span><span class="p">,</span> <span class="p">),</span> <span class="bp">None</span> <span class="p">)</span>            <span class="c"># yo unknown.</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">yos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span> <span class="p">(</span> <span class="n">ZA</span><span class="p">,</span> <span class="p">(</span> <span class="n">yi</span><span class="p">,</span> <span class="p">),</span> <span class="mf">0.</span> <span class="p">)</span>              <span class="c"># yo = yi.</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">yos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">3</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span> <span class="p">(</span> <span class="bp">None</span><span class="p">,</span> <span class="p">(</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="p">),</span> <span class="bp">None</span> <span class="p">)</span>          <span class="c"># Fission</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">yos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">4</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span> <span class="p">(</span> <span class="bp">None</span><span class="p">,</span> <span class="p">(</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="n">yos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">),</span> <span class="bp">None</span> <span class="p">)</span>  <span class="c"># Xyo</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">specialCases</span> <span class="p">)</span> <span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">ZA</span> <span class="o">==</span> <span class="mi">4009</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">C</span> <span class="o">==</span> <span class="mi">12</span> <span class="p">)</span> <span class="p">:</span> <span class="n">yos</span> <span class="o">=</span> <span class="n">yos</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2004</span><span class="p">,)</span> <span class="c"># Special case for n + Be9 -&gt; 2 n + Be8 -&gt; 2 n + 2 He</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">ZA</span> <span class="o">&gt;=</span> <span class="mi">99000</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">ZA</span> <span class="o">&lt;=</span> <span class="mi">99200</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="bp">None</span><span class="p">,</span> <span class="n">yos</span><span class="p">,</span> <span class="bp">None</span> <span class="p">)</span>
    <span class="n">Zr</span><span class="p">,</span> <span class="n">Ar</span> <span class="o">=</span> <span class="n">ZandAFromZA</span><span class="p">(</span> <span class="n">ZA</span> <span class="p">)</span>
    <span class="n">Z_A</span> <span class="o">=</span> <span class="n">ZandAFromZA</span><span class="p">(</span> <span class="n">yoToZA_forNuclei</span><span class="p">(</span> <span class="n">ZAToYo</span><span class="p">(</span> <span class="n">yi</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>             <span class="c"># yi&#39;s Z and A.</span>
    <span class="n">Zr</span> <span class="o">+=</span> <span class="n">Z_A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">Ar</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="n">Ar</span> <span class="o">+=</span> <span class="n">Z_A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">ZAr</span> <span class="o">=</span> <span class="n">ZA</span> <span class="o">+</span> <span class="n">yoToZA_forNuclei</span><span class="p">(</span> <span class="n">ZAToYo</span><span class="p">(</span> <span class="n">yi</span> <span class="p">)</span> <span class="p">)</span>                   <span class="c"># Add yi&#39;s ZA to ZAr.</span>
    <span class="k">for</span> <span class="n">yo</span> <span class="ow">in</span> <span class="n">yos</span> <span class="p">:</span>                                         <span class="c"># Subtract yos&#39; Z, A and ZA from ZAr.</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">yo</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span> <span class="k">continue</span>
        <span class="n">yo_</span> <span class="o">=</span> <span class="n">yo</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">yo</span> <span class="o">&lt;</span> <span class="mi">1001</span> <span class="p">)</span> <span class="p">:</span> <span class="n">yo_</span> <span class="o">=</span> <span class="n">yoToZA_forNuclei</span><span class="p">(</span> <span class="n">yo</span> <span class="p">)</span>
        <span class="n">Z_A</span> <span class="o">=</span> <span class="n">ZandAFromZA</span><span class="p">(</span> <span class="n">yo_</span> <span class="p">)</span>
        <span class="n">Zr</span> <span class="o">-=</span> <span class="n">Z_A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">Ar</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">Ar</span> <span class="o">-=</span> <span class="n">Z_A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">ZAr</span> <span class="o">-=</span> <span class="n">yo_</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">Ar</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="n">Ar</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">Ar</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="mi">1000</span> <span class="o">*</span> <span class="n">Zr</span><span class="p">,</span> <span class="n">yos</span><span class="p">,</span> <span class="bp">None</span> <span class="p">)</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">Zr</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>                                          <span class="c"># Check all ok.</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Error in residualZA_yos_Q: bad C-value = </span><span class="si">%d</span><span class="s"> for ZA = </span><span class="si">%d</span><span class="s"> and yi = </span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">C</span><span class="p">,</span> <span class="n">ZA</span><span class="p">,</span> <span class="n">yi</span> <span class="p">)</span> <span class="p">)</span>
    <span class="n">Remove_yi</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">yos_</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">yo</span> <span class="ow">in</span> <span class="n">yos</span> <span class="p">:</span>                                         <span class="c"># To make math better, do not add and then subtract when yo = yi.</span>
        <span class="k">try</span> <span class="p">:</span>
            <span class="n">yo_</span> <span class="o">=</span> <span class="n">ZAToYo</span><span class="p">(</span> <span class="n">yo</span> <span class="p">)</span>
        <span class="k">except</span> <span class="p">:</span>
            <span class="n">yo_</span> <span class="o">=</span> <span class="n">yo</span>
        <span class="k">if</span> <span class="p">(</span> <span class="p">(</span> <span class="n">Remove_yi</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">yo_</span> <span class="o">==</span> <span class="n">yi</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">Remove_yi</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span> <span class="n">yo</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="n">yos_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">yo</span> <span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">ZAr</span> <span class="o">==</span> <span class="n">ZA</span> <span class="p">)</span> <span class="p">:</span>
        <span class="n">ZAyos</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">yo</span> <span class="ow">in</span> <span class="n">yos</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">yo</span> <span class="o">&lt;</span> <span class="mi">1000</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">ZAyos</span> <span class="o">+=</span> <span class="n">yoToZA_forNuclei</span><span class="p">(</span> <span class="n">yo</span> <span class="p">)</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="n">ZAyos</span> <span class="o">+=</span> <span class="n">yo</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">bdflsFile</span><span class="o">.</span><span class="n">mass</span><span class="p">(</span> <span class="n">yi</span> <span class="p">)</span>
        <span class="k">for</span> <span class="n">yo</span> <span class="ow">in</span> <span class="n">yos</span> <span class="p">:</span> <span class="n">q</span> <span class="o">-=</span> <span class="n">bdflsFile</span><span class="o">.</span><span class="n">mass</span><span class="p">(</span> <span class="n">yo</span> <span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">yos_</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span> <span class="n">ZAyos</span> <span class="o">==</span> <span class="n">yoToZA_forNuclei</span><span class="p">(</span> <span class="n">yi</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">q</span> <span class="o">=</span> <span class="p">(</span> <span class="n">bdflsFile</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span> <span class="mi">4</span> <span class="p">)</span> <span class="o">*</span> <span class="n">q</span> <span class="p">)</span>
            <span class="n">q</span> <span class="o">+=</span> <span class="n">targetELevel</span> <span class="o">-</span> <span class="n">X4</span>
            <span class="k">return</span> <span class="p">(</span> <span class="n">ZAr</span><span class="p">,</span> <span class="n">yos</span><span class="p">,</span> <span class="n">q</span> <span class="p">)</span>
        <span class="n">endlmisc</span><span class="o">.</span><span class="n">printWarning</span><span class="p">(</span> <span class="s">&quot;Printing yo list&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">yo</span> <span class="ow">in</span> <span class="n">yos_</span> <span class="p">:</span> <span class="n">endlmisc</span><span class="o">.</span><span class="n">printWarning</span><span class="p">(</span> <span class="sb">`yo`</span> <span class="p">)</span>
        <span class="n">endlmisc</span><span class="o">.</span><span class="n">printWarning</span><span class="p">(</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">)</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s">&quot;Error in residualZA_yos_Q: ZAr == ZA, but yo list not empty&quot;</span> <span class="p">)</span>
    <span class="n">q</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">Remove_yi</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span> <span class="n">q</span> <span class="o">+=</span> <span class="n">bdflsFile</span><span class="o">.</span><span class="n">mass</span><span class="p">(</span> <span class="n">yi</span> <span class="p">)</span>
    <span class="k">for</span> <span class="n">yo</span> <span class="ow">in</span> <span class="n">yos_</span> <span class="p">:</span> <span class="n">q</span> <span class="o">-=</span> <span class="n">bdflsFile</span><span class="o">.</span><span class="n">mass</span><span class="p">(</span> <span class="n">yo</span> <span class="p">)</span>
    <span class="n">ZAm</span> <span class="o">=</span> <span class="n">bdflsFile</span><span class="o">.</span><span class="n">mass</span><span class="p">(</span> <span class="n">ZA</span> <span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">ZAm</span> <span class="o">==</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">printQWarning</span> <span class="p">)</span> <span class="p">:</span> <span class="n">endlmisc</span><span class="o">.</span><span class="n">printWarning</span><span class="p">(</span> <span class="s">&quot;Warning in residualZA_yos_Q: target ZA = </span><span class="si">%d</span><span class="s"> not in bdfls file (yi = </span><span class="si">%d</span><span class="s">, ZA = </span><span class="si">%d</span><span class="s">, C = </span><span class="si">%d</span><span class="s">)&quot;</span> <span class="o">%</span> \
            <span class="p">(</span> <span class="n">ZA</span><span class="p">,</span> <span class="n">yi</span><span class="p">,</span> <span class="n">ZA</span><span class="p">,</span> <span class="n">C</span> <span class="p">)</span> <span class="p">)</span>
        <span class="n">q</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">bdflsFile</span><span class="o">.</span><span class="n">mass</span><span class="p">(</span> <span class="n">ZAr</span> <span class="p">)</span>                              <span class="c"># Mass of residual.</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">m</span> <span class="o">==</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span> 
            <span class="k">if</span><span class="p">(</span> <span class="n">printQWarning</span> <span class="p">)</span> <span class="p">:</span> <span class="n">endlmisc</span><span class="o">.</span><span class="n">printWarning</span><span class="p">(</span> <span class="s">&quot;Warning in residualZA_yos_Q: could not calculate Q as residual ZA = </span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">ZAr</span> <span class="o">+</span> 
                <span class="s">&quot; not in bdfls file (yi = </span><span class="si">%d</span><span class="s">, ZA = </span><span class="si">%d</span><span class="s">, C = </span><span class="si">%d</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">yi</span><span class="p">,</span> <span class="n">ZA</span><span class="p">,</span> <span class="n">C</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">q</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">q</span> <span class="o">+=</span> <span class="n">bdflsFile</span><span class="o">.</span><span class="n">mass</span><span class="p">(</span> <span class="n">ZA</span> <span class="p">)</span> <span class="o">-</span> <span class="n">m</span>
            <span class="n">q</span> <span class="o">*=</span> <span class="n">bdflsFile</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span> <span class="mi">4</span> <span class="p">)</span>                       <span class="c"># Convert AMU to MeVs.</span>
    <span class="k">if</span> <span class="n">q</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="p">:</span> <span class="n">q</span> <span class="o">+=</span> <span class="n">targetELevel</span> <span class="o">-</span> <span class="n">X4</span>
    <span class="k">return</span> <span class="p">(</span> <span class="n">ZAr</span><span class="p">,</span> <span class="n">yos</span><span class="p">,</span> <span class="n">q</span> <span class="p">)</span>
</div>
<div class="viewcode-block" id="reactionEquations"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.endl.html#fudge.legacy.endl.endl2.reactionEquations">[docs]</a><span class="k">def</span> <span class="nf">reactionEquations</span><span class="p">(</span> <span class="n">yi_</span><span class="p">,</span> <span class="n">ZA_</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">specialCases</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">printQWarning</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">NameASeperator</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">bdflsFile</span> <span class="o">=</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Given the incident particle yi, target ZA and reaction type C,</span>
<span class="sd">    this routine returns a list of three string for the reaction&#39;s equation.  The first string</span>
<span class="sd">    is of the form &#39;yi + ZA -&gt; products + residual + Q&#39; and the second is of the form</span>
<span class="sd">    ZA(yi,products)residual.  The third string is of the form (yi,products).  For example, </span>
<span class="sd">    reactionEquations( 1, 94239, 13 ) returns the list </span>
<span class="sd">    [ &#39;n + Pu239n -&gt; 3n + Pu237 + -12.64503 MeV&#39;, &#39;Pu239(n,3n)Pu237&#39;, &#39;(n,3n)&#39; ].</span>
<span class="sd">    If level is not None, &quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">endlmisc</span>
    <span class="n">yi</span> <span class="o">=</span> <span class="n">endlmisc</span><span class="o">.</span><span class="n">incidentParticleTags</span><span class="p">(</span> <span class="n">yi_</span> <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ZA</span><span class="p">,</span> <span class="n">Suffix</span> <span class="o">=</span> <span class="n">endlmisc</span><span class="o">.</span><span class="n">intZASuffix</span><span class="p">(</span> <span class="n">ZA_</span> <span class="p">)</span>
    <span class="n">Z</span><span class="p">,</span> <span class="n">A</span> <span class="o">=</span> <span class="n">ZandAFromZA</span><span class="p">(</span> <span class="n">ZA</span> <span class="p">)</span>
    <span class="n">s1</span> <span class="o">=</span> <span class="n">endl_y</span><span class="o">.</span><span class="n">endl_yLabel</span><span class="p">(</span> <span class="n">ZAToYo</span><span class="p">(</span> <span class="n">yi</span> <span class="p">)</span> <span class="p">)</span> <span class="o">+</span> <span class="s">&quot; + &quot;</span> <span class="o">+</span> <span class="n">symbolForYoOrZA</span><span class="p">(</span> <span class="n">ZA_</span><span class="p">,</span> <span class="n">ZAOnly</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">AddNatural</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">NameASeperator</span> <span class="o">=</span> <span class="n">NameASeperator</span> <span class="p">)</span> <span class="o">+</span> <span class="s">&quot; -&gt;&quot;</span>
    <span class="n">s2</span> <span class="o">=</span> <span class="n">symbolForYoOrZA</span><span class="p">(</span> <span class="n">ZA_</span><span class="p">,</span> <span class="n">ZAOnly</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">AddNatural</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">NameASeperator</span> <span class="o">=</span> <span class="n">NameASeperator</span> <span class="p">)</span> <span class="o">+</span> <span class="s">&quot;(&quot;</span> <span class="o">+</span> <span class="n">endl_y</span><span class="o">.</span><span class="n">endl_yLabel</span><span class="p">(</span> <span class="n">ZAToYo</span><span class="p">(</span> <span class="n">yi</span> <span class="p">)</span> <span class="p">)</span> <span class="o">+</span> <span class="s">&quot;,&quot;</span>
    <span class="n">ZAr</span><span class="p">,</span> <span class="n">yos</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">residualZA_yos_Q</span><span class="p">(</span> <span class="n">yi</span><span class="p">,</span> <span class="n">ZA</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">specialCases</span> <span class="o">=</span> <span class="n">specialCases</span><span class="p">,</span> <span class="n">printQWarning</span> <span class="o">=</span> <span class="n">printQWarning</span><span class="p">,</span> <span class="n">bdflsFile</span> <span class="o">=</span> <span class="n">bdflsFile</span> <span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span> <span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">yos</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">yos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
        <span class="k">if</span>   <span class="p">(</span> <span class="n">yos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span> <span class="p">:</span>     <span class="c"># yo is unknown</span>
            <span class="n">s1</span> <span class="o">+=</span> <span class="s">&quot; ?&quot;</span>
            <span class="n">s2</span> <span class="o">+=</span> <span class="s">&quot;?)?&quot;</span>
        <span class="k">elif</span> <span class="p">(</span> <span class="n">yos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span> <span class="p">)</span> <span class="p">:</span>     <span class="c"># yo = yi</span>
            <span class="n">s1</span> <span class="o">+=</span> <span class="s">&quot; </span><span class="si">%s</span><span class="s"> + </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">endl_y</span><span class="o">.</span><span class="n">endl_yLabel</span><span class="p">(</span> <span class="n">ZAToYo</span><span class="p">(</span> <span class="n">yi</span> <span class="p">)</span> <span class="p">),</span> <span class="n">symbolForYoOrZA</span><span class="p">(</span> <span class="n">ZA_</span><span class="p">,</span> <span class="n">ZAOnly</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">AddNatural</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">NameASeperator</span> <span class="o">=</span> <span class="n">NameASeperator</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">s2</span> <span class="o">+=</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">)</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">endl_y</span><span class="o">.</span><span class="n">endl_yLabel</span><span class="p">(</span> <span class="n">ZAToYo</span><span class="p">(</span> <span class="n">yi</span> <span class="p">)</span> <span class="p">),</span> <span class="n">symbolForYoOrZA</span><span class="p">(</span> <span class="n">ZA_</span><span class="p">,</span> <span class="n">ZAOnly</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">AddNatural</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">NameASeperator</span> <span class="o">=</span> <span class="n">NameASeperator</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span> <span class="n">yos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">3</span> <span class="p">)</span> <span class="p">:</span>     <span class="c"># fission</span>
            <span class="n">s1</span> <span class="o">+=</span> <span class="s">&quot; fission + ?&quot;</span>
            <span class="n">s2</span> <span class="o">+=</span> <span class="s">&quot;fission)?&quot;</span>
        <span class="k">elif</span> <span class="p">(</span> <span class="n">yos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">4</span> <span class="p">)</span> <span class="p">:</span>     <span class="c"># Xyo</span>
            <span class="n">s1</span> <span class="o">+=</span> <span class="s">&quot; X</span><span class="si">%s</span><span class="s"> + ?&quot;</span> <span class="o">%</span> <span class="n">endl_y</span><span class="o">.</span><span class="n">endl_yLabel</span><span class="p">(</span> <span class="n">ZAToYo</span><span class="p">(</span> <span class="n">yos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">s2</span> <span class="o">+=</span> <span class="s">&quot;X</span><span class="si">%s</span><span class="s">)?&quot;</span> <span class="o">%</span> <span class="n">endl_y</span><span class="o">.</span><span class="n">endl_yLabel</span><span class="p">(</span> <span class="n">ZAToYo</span><span class="p">(</span> <span class="n">yos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Error in reactionName: invalid yos[0] = </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="sb">`yos[0]`</span> <span class="p">)</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">yo_</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">syo</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">yo</span> <span class="ow">in</span> <span class="n">yos</span> <span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span> <span class="n">yo_</span> <span class="o">==</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">yo_</span> <span class="o">=</span> <span class="n">yo</span>
            <span class="k">elif</span> <span class="p">(</span> <span class="n">yo</span> <span class="o">!=</span> <span class="n">yo_</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">syo</span> <span class="o">+=</span> <span class="s">&quot; + &quot;</span>
                <span class="k">if</span> <span class="p">(</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="n">syo</span> <span class="o">+=</span> <span class="sb">`n`</span>
                    <span class="n">s2</span> <span class="o">+=</span> <span class="sb">`n`</span>
                <span class="n">syo</span> <span class="o">+=</span> <span class="n">symbolForYoOrZA</span><span class="p">(</span> <span class="n">yo_</span><span class="p">,</span> <span class="n">NameASeperator</span> <span class="o">=</span> <span class="n">NameASeperator</span> <span class="p">)</span>
                <span class="n">s2</span> <span class="o">+=</span> <span class="n">symbolForYoOrZA</span><span class="p">(</span> <span class="n">yo_</span><span class="p">,</span> <span class="n">NameASeperator</span> <span class="o">=</span> <span class="n">NameASeperator</span> <span class="p">)</span> <span class="o">+</span> <span class="s">&quot; &quot;</span>
                <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">yo_</span> <span class="o">=</span> <span class="n">yo</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">yo_</span> <span class="o">!=</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">syo</span> <span class="o">+=</span> <span class="s">&quot; + &quot;</span>
            <span class="k">if</span> <span class="p">(</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">syo</span> <span class="o">+=</span> <span class="sb">`n`</span>
                <span class="n">s2</span> <span class="o">+=</span> <span class="sb">`n`</span>
            <span class="n">syo</span> <span class="o">+=</span> <span class="n">endl_y</span><span class="o">.</span><span class="n">endl_yLabel</span><span class="p">(</span> <span class="n">ZAToYo</span><span class="p">(</span> <span class="n">yo_</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">s2</span> <span class="o">+=</span> <span class="n">endl_y</span><span class="o">.</span><span class="n">endl_yLabel</span><span class="p">(</span> <span class="n">ZAToYo</span><span class="p">(</span> <span class="n">yo_</span> <span class="p">)</span> <span class="p">)</span> <span class="o">+</span> <span class="s">&quot; &quot;</span>
            <span class="k">if</span> <span class="p">(</span> <span class="p">(</span> <span class="n">yi</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">C</span> <span class="o">==</span> <span class="mi">11</span> <span class="p">)</span> <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span> <span class="p">(</span> <span class="n">yi</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">C</span> <span class="o">==</span> <span class="mi">40</span> <span class="p">)</span> <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span> <span class="p">(</span> <span class="n">yi</span> <span class="o">==</span> <span class="mi">3</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">C</span> <span class="o">==</span> <span class="mi">41</span> <span class="p">)</span> <span class="p">)</span> <span class="ow">or</span> \
               <span class="p">(</span> <span class="p">(</span> <span class="n">yi</span> <span class="o">==</span> <span class="mi">4</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">C</span> <span class="o">==</span> <span class="mi">42</span> <span class="p">)</span> <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span> <span class="p">(</span> <span class="n">yi</span> <span class="o">==</span> <span class="mi">5</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">C</span> <span class="o">==</span> <span class="mi">44</span> <span class="p">)</span> <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span> <span class="p">(</span> <span class="n">yi</span> <span class="o">==</span> <span class="mi">6</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">C</span> <span class="o">==</span> <span class="mi">45</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> 
                <span class="n">syo</span> <span class="o">+=</span> <span class="s">&quot;&#39;&quot;</span>
                <span class="n">s2</span> <span class="o">=</span> <span class="n">s2</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s">&quot;&#39;&quot;</span>
        <span class="n">syo</span> <span class="o">=</span> <span class="n">syo</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>                                       <span class="c"># remove first &quot; +&quot;</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">q</span> <span class="o">==</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">qStr</span> <span class="o">=</span> <span class="s">&quot;?&quot;</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">qStr</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%.8g</span><span class="s"> MeV&quot;</span> <span class="o">%</span> <span class="n">q</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">ZA</span> <span class="o">&gt;</span> <span class="mi">99000</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">ZA</span> <span class="o">&lt;=</span> <span class="mi">99200</span> <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span> <span class="n">ZAr</span> <span class="o">==</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">ZArStr</span> <span class="o">=</span> <span class="s">&quot;?&quot;</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">ZArStr</span> <span class="o">=</span> <span class="n">symbolForYoOrZA</span><span class="p">(</span> <span class="n">ZAr</span><span class="p">,</span> <span class="n">ZAOnly</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">AddNatural</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">NameASeperator</span> <span class="o">=</span> <span class="n">NameASeperator</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">level</span> <span class="o">!=</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span> <span class="n">ZArStr</span> <span class="o">+=</span> <span class="s">&#39;[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span> <span class="n">level</span> <span class="p">)</span> <span class="o">+</span> <span class="s">&#39;]&#39;</span>
        <span class="n">s1</span> <span class="o">+=</span> <span class="n">syo</span> <span class="o">+</span> <span class="s">&quot; + &quot;</span> <span class="o">+</span> <span class="n">ZArStr</span> <span class="o">+</span> <span class="s">&quot; + &quot;</span> <span class="o">+</span> <span class="n">qStr</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">s2</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot; &quot;</span> <span class="p">)</span> <span class="p">:</span> <span class="n">s2</span> <span class="o">=</span> <span class="n">s2</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">s2</span> <span class="o">+=</span> <span class="s">&quot;)&quot;</span> <span class="o">+</span> <span class="n">ZArStr</span>
    <span class="n">s3</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">s2</span><span class="o">.</span><span class="n">find</span><span class="p">(</span> <span class="s">&quot;(&quot;</span> <span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span> <span class="p">:</span> <span class="n">s3</span> <span class="o">=</span> <span class="s">&quot;(&quot;</span> <span class="o">+</span> <span class="n">s2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span> <span class="s">&quot;(&quot;</span> <span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span> <span class="s">&quot;)&quot;</span> <span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s">&quot;)&quot;</span>
    <span class="k">return</span> <span class="p">[</span> <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">s3</span> <span class="p">]</span>
</div>
<div class="viewcode-block" id="reactionQ"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.endl.html#fudge.legacy.endl.endl2.reactionQ">[docs]</a><span class="k">def</span> <span class="nf">reactionQ</span><span class="p">(</span> <span class="n">yi</span><span class="p">,</span> <span class="n">ZA</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">targetELevel</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">X4</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">specialCases</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">printQWarning</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">bdflsFile</span> <span class="o">=</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns the Q for reaction of type C involving incident particle yi and target ZA. Note,</span>
<span class="sd">    the target is taken to be in its ground state.&quot;&quot;&quot;</span>

    <span class="n">q</span> <span class="o">=</span> <span class="n">residualZA_yos_Q</span><span class="p">(</span> <span class="n">yi</span><span class="p">,</span> <span class="n">ZA</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">targetELevel</span> <span class="o">=</span> <span class="n">targetELevel</span><span class="p">,</span> <span class="n">X4</span> <span class="o">=</span> <span class="n">X4</span><span class="p">,</span> <span class="n">specialCases</span> <span class="o">=</span> <span class="n">specialCases</span><span class="p">,</span> <span class="n">printQWarning</span> <span class="o">=</span> <span class="n">printQWarning</span><span class="p">,</span> <span class="n">bdflsFile</span> <span class="o">=</span> <span class="n">bdflsFile</span> <span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span> <span class="bp">None</span>
    <span class="k">return</span> <span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="reactionThreshold"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.endl.html#fudge.legacy.endl.endl2.reactionThreshold">[docs]</a><span class="k">def</span> <span class="nf">reactionThreshold</span><span class="p">(</span> <span class="n">yi</span><span class="p">,</span> <span class="n">ZA</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">targetELevel</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">residualELevel</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">Q</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">specialCases</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">bdflsFile</span> <span class="o">=</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns the threshold for this reaction. targetELevel is the excited state of the target</span>
<span class="sd">    and residualELevel is the excited state of the residual.&quot;&quot;&quot;</span>

    <span class="k">if</span><span class="p">(</span> <span class="n">bdflsFile</span> <span class="o">==</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span>
        <span class="kn">from</span> <span class="nn">fudge.processing</span> <span class="kn">import</span> <span class="n">bdfls</span>
        <span class="n">bdflsFile</span> <span class="o">=</span> <span class="n">bdfls</span><span class="o">.</span><span class="n">getDefaultBdfls</span><span class="p">(</span> <span class="p">)</span>
    <span class="n">QRequired</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">AFromZA</span><span class="p">(</span> <span class="n">ZA</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>        <span class="c"># User must enter Q</span>
        <span class="n">QRequired</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">elif</span><span class="p">(</span> <span class="mi">99120</span> <span class="o">&lt;=</span> <span class="n">ZA</span> <span class="o">&lt;=</span> <span class="mi">99200</span> <span class="p">)</span> <span class="p">:</span>          <span class="c"># User must enter Q</span>
        <span class="n">QRequired</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">elif</span><span class="p">(</span> <span class="n">C</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s">&#39;Error from reactionThreshold: cannot calculate threshold for C = 1 reaction&#39;</span> <span class="p">)</span>
    <span class="k">elif</span><span class="p">(</span> <span class="n">C</span> <span class="o">==</span> <span class="mi">5</span> <span class="p">)</span> <span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s">&#39;Error from reactionThreshold: cannot calculate threshold for C = 5 reaction&#39;</span> <span class="p">)</span>
    <span class="k">elif</span><span class="p">(</span> <span class="n">C</span> <span class="o">==</span> <span class="mi">15</span> <span class="p">)</span> <span class="p">:</span>                       <span class="c"># User must enter Q</span>
        <span class="n">QRequired</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">elif</span><span class="p">(</span> <span class="n">C</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="p">)</span> <span class="p">:</span>                  <span class="c"># User must enter Q</span>
        <span class="n">QRequired</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="n">C_</span> <span class="o">=</span> <span class="n">C</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">S</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">yos</span> <span class="o">=</span> <span class="n">endl_C</span><span class="o">.</span><span class="n">endl_C_yoInfo</span><span class="p">(</span> <span class="n">C</span> <span class="p">)</span>
            <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">yos</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span>              <span class="c"># Attempt to handle breakup of residual properly (e.g., n + C12 --&gt; n + (C12&#39; -&gt; 3a )).</span>
                <span class="n">yo</span> <span class="o">=</span> <span class="n">yos</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">CList</span> <span class="o">=</span> <span class="n">endl_C</span><span class="o">.</span><span class="n">endl_C_CList</span><span class="p">(</span> <span class="p">)</span>
                <span class="k">for</span> <span class="n">Cp</span> <span class="ow">in</span> <span class="n">CList</span> <span class="p">:</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">yo</span> <span class="o">==</span> <span class="n">endl_C</span><span class="o">.</span><span class="n">endl_C_yoInfo</span><span class="p">(</span> <span class="n">Cp</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                        <span class="n">C_</span> <span class="o">=</span> <span class="n">Cp</span>
                        <span class="k">break</span>
        <span class="n">Q</span> <span class="o">=</span> <span class="n">reactionQ</span><span class="p">(</span> <span class="n">yi</span><span class="p">,</span> <span class="n">ZA</span><span class="p">,</span> <span class="n">C_</span><span class="p">,</span> <span class="n">specialCases</span> <span class="o">=</span> <span class="n">specialCases</span><span class="p">,</span> <span class="n">bdflsFile</span> <span class="o">=</span> <span class="n">bdflsFile</span> <span class="p">)</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">QRequired</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">Q</span> <span class="o">==</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s">&#39;Error from reactionThreshold: user must supply Q for requested ZA = </span><span class="si">%s</span><span class="s"> or C = </span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="sb">`ZA`</span><span class="p">,</span> <span class="n">C</span> <span class="p">)</span> <span class="p">)</span>
    <span class="n">Threshold</span> <span class="o">=</span> <span class="o">-</span><span class="n">Q</span>  <span class="o">-</span> <span class="n">targetELevel</span> <span class="o">+</span> <span class="n">residualELevel</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">Threshold</span> <span class="o">&lt;</span> <span class="mf">0.</span> <span class="p">)</span> <span class="p">:</span> <span class="n">Threshold</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="n">r</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">+</span> <span class="n">bdflsFile</span><span class="o">.</span><span class="n">mass</span><span class="p">(</span> <span class="n">yi</span> <span class="p">)</span> <span class="o">/</span> <span class="n">bdflsFile</span><span class="o">.</span><span class="n">mass</span><span class="p">(</span> <span class="n">ZA</span> <span class="p">)</span>
    <span class="n">Threshold</span> <span class="o">*=</span> <span class="n">r</span>
    <span class="k">return</span><span class="p">(</span> <span class="n">Threshold</span> <span class="p">)</span>
</div>
<div class="viewcode-block" id="symbolForYoOrZA"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.endl.html#fudge.legacy.endl.endl2.symbolForYoOrZA">[docs]</a><span class="k">def</span> <span class="nf">symbolForYoOrZA</span><span class="p">(</span> <span class="n">yoOrZA</span><span class="p">,</span> <span class="n">NameASeperator</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ZAOnly</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">AddNatural</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m_to_m1</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">suffixSeperator</span> <span class="o">=</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;If ZAOnly == 0 and yoOrZA is a yo type particle then the symbol for its yo is returned;</span>
<span class="sd">    otherwise, the symbol for ZA is returned.  If AddNatural is true, then natural ZAs (i.e.,</span>
<span class="sd">    those with A = 000 like 12000) have the string &#39;natural&#39; append to the symbol for the Z, </span>
<span class="sd">    otherwise, natural targets only contain the symbol. If m_to_m1 is True then when Suffix = &#39;m&#39;</span>
<span class="sd">        it is changed to &#39;m1&#39;.&quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">symOrNameForYoOrZA</span><span class="p">(</span> <span class="n">yoOrZA</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ASep</span> <span class="o">=</span> <span class="n">NameASeperator</span><span class="p">,</span> <span class="n">ZAOnly</span> <span class="o">=</span> <span class="n">ZAOnly</span><span class="p">,</span> <span class="n">AddNatural</span> <span class="o">=</span> <span class="n">AddNatural</span><span class="p">,</span> <span class="n">m_to_m1</span> <span class="o">=</span> <span class="n">m_to_m1</span><span class="p">,</span> <span class="n">suffixSeperator</span> <span class="o">=</span> <span class="n">suffixSeperator</span> <span class="p">)</span>
</div>
<div class="viewcode-block" id="nameForYoOrZA"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.endl.html#fudge.legacy.endl.endl2.nameForYoOrZA">[docs]</a><span class="k">def</span> <span class="nf">nameForYoOrZA</span><span class="p">(</span> <span class="n">yoOrZA</span><span class="p">,</span> <span class="n">NameASeperator</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ZAOnly</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">AddNatural</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m_to_m1</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">suffixSeperator</span> <span class="o">=</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;If ZAOnly == 0 and yoOrZA is a yo type particle then the name for its yo is returned;</span>
<span class="sd">    otherwise, the name for ZA is returned. If AddNatural is true, then natural ZAs (i.e.,</span>
<span class="sd">    those with A = 000 like 12000) have the string &#39;natural&#39; append to the name for the Z, </span>
<span class="sd">    otherwise, natural targets only contain the name. If m_to_m1 is True then when Suffix = &#39;m&#39;</span>
<span class="sd">    it is changed to &#39;m1&#39;.&quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">symOrNameForYoOrZA</span><span class="p">(</span> <span class="n">yoOrZA</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ASep</span> <span class="o">=</span> <span class="n">NameASeperator</span><span class="p">,</span> <span class="n">ZAOnly</span> <span class="o">=</span> <span class="n">ZAOnly</span><span class="p">,</span> <span class="n">AddNatural</span> <span class="o">=</span> <span class="n">AddNatural</span><span class="p">,</span> <span class="n">m_to_m1</span> <span class="o">=</span> <span class="n">m_to_m1</span><span class="p">,</span> <span class="n">suffixSeperator</span> <span class="o">=</span> <span class="n">suffixSeperator</span> <span class="p">)</span>
</div>
<div class="viewcode-block" id="symOrNameForYoOrZA"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.endl.html#fudge.legacy.endl.endl2.symOrNameForYoOrZA">[docs]</a><span class="k">def</span> <span class="nf">symOrNameForYoOrZA</span><span class="p">(</span> <span class="n">yoOrZA</span><span class="p">,</span> <span class="n">wantName</span><span class="p">,</span> <span class="n">ASep</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ZAOnly</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">AddNatural</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m_to_m1</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">suffixSeperator</span> <span class="o">=</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;For internal use only (see symbolForYoOrZA or nameForYoOrZA).&quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">endlmisc</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">yoOrZA</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span> <span class="s">&#39;n&#39;</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">yoOrZA</span> <span class="o">==</span> <span class="mi">7</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span> <span class="s">&#39;gamma&#39;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">ZAOnly</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>
        <span class="k">try</span> <span class="p">:</span>
            <span class="n">ZAyo</span> <span class="o">=</span> <span class="n">ZAToYo</span><span class="p">(</span> <span class="n">yoOrZA</span> <span class="p">)</span>                         <span class="c"># Is ZA a valid yo.</span>
        <span class="k">except</span> <span class="p">:</span>
            <span class="n">ZAOnly</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">ZAOnly</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">wantName</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span> <span class="n">endl_y</span><span class="o">.</span><span class="n">endl_yLabel</span><span class="p">(</span> <span class="n">ZAyo</span> <span class="p">)</span>
        <span class="k">return</span> <span class="n">endl_y</span><span class="o">.</span><span class="n">endl_yLongLabel</span><span class="p">(</span> <span class="n">ZAyo</span> <span class="p">)</span>
    <span class="n">ZA</span><span class="p">,</span> <span class="n">Suffix</span> <span class="o">=</span> <span class="n">endlmisc</span><span class="o">.</span><span class="n">intZASuffix</span><span class="p">(</span> <span class="n">yoOrZA</span> <span class="p">)</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">m_to_m1</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">Suffix</span> <span class="o">==</span> <span class="s">&#39;m&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">Suffix</span> <span class="o">=</span> <span class="s">&#39;m1&#39;</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">ZA</span> <span class="o">&gt;</span> <span class="mi">99000</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">ZA</span> <span class="o">&lt;=</span> <span class="mi">99200</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span> <span class="s">&quot;FissionProduct_ENDL</span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">ZA</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">suffixSeperator</span> <span class="ow">is</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span> <span class="n">suffixSeperator</span> <span class="o">=</span> <span class="n">ASep</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">Suffix</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span> <span class="p">)</span> <span class="p">:</span> <span class="n">Suffix</span> <span class="o">=</span> <span class="n">suffixSeperator</span> <span class="o">+</span> <span class="n">Suffix</span>
    <span class="n">Z</span><span class="p">,</span> <span class="n">A</span> <span class="o">=</span> <span class="n">ZandAFromZA</span><span class="p">(</span> <span class="n">ZA</span> <span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">wantName</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>
        <span class="n">ZStr</span> <span class="o">=</span> <span class="n">endl_Z</span><span class="o">.</span><span class="n">endl_ZSymbol</span><span class="p">(</span> <span class="n">Z</span> <span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">ZStr</span> <span class="o">==</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span> <span class="n">ZStr</span> <span class="o">=</span> <span class="s">&quot;Unk&quot;</span>
    <span class="k">else</span> <span class="p">:</span> 
        <span class="n">ZStr</span> <span class="o">=</span> <span class="n">endl_Z</span><span class="o">.</span><span class="n">endl_ZLabel</span><span class="p">(</span> <span class="n">Z</span> <span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">ZStr</span> <span class="o">==</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span> <span class="n">ZStr</span> <span class="o">=</span> <span class="s">&quot;Unknown&quot;</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">A</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">AddNatural</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span> <span class="n">ZStr</span> <span class="o">+</span> <span class="n">suffixSeperator</span> <span class="o">+</span> <span class="s">&#39;natural&#39;</span> <span class="o">+</span> <span class="n">Suffix</span>
        <span class="k">return</span> <span class="n">ZStr</span>
    <span class="k">return</span> <span class="n">ZStr</span> <span class="o">+</span> <span class="n">ASep</span> <span class="o">+</span> <span class="sb">`A`</span> <span class="o">+</span> <span class="n">Suffix</span>
</div>
<div class="viewcode-block" id="endlToGNDName"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.endl.html#fudge.legacy.endl.endl2.endlToGNDName">[docs]</a><span class="k">def</span> <span class="nf">endlToGNDName</span><span class="p">(</span> <span class="n">yoOrZA</span> <span class="p">)</span> <span class="p">:</span>

    <span class="k">return</span><span class="p">(</span> <span class="n">symbolForYoOrZA</span><span class="p">(</span> <span class="n">yoOrZA</span><span class="p">,</span> <span class="n">NameASeperator</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">ZAOnly</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">AddNatural</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">m_to_m1</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">suffixSeperator</span> <span class="o">=</span> <span class="s">&#39;_&#39;</span> <span class="p">)</span> <span class="p">)</span>
</div>
<div class="viewcode-block" id="gndNameToEndlZ_A_Suffix"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.endl.html#fudge.legacy.endl.endl2.gndNameToEndlZ_A_Suffix">[docs]</a><span class="k">def</span> <span class="nf">gndNameToEndlZ_A_Suffix</span><span class="p">(</span> <span class="n">name</span> <span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns the tuple (Z, A, suffix, ZA) for a gnd isotope name (e.g., gnd name = &#39;Am242_m1&#39; returns ( 95, 242, &#39;m1&#39;, 95242 ).&quot;&quot;&quot;</span>

    <span class="k">return</span><span class="p">(</span> <span class="n">fudgeZA</span><span class="o">.</span><span class="n">gndNameToZ_A_Suffix</span><span class="p">(</span> <span class="n">name</span> <span class="p">)</span> <span class="p">)</span>
</div>
<div class="viewcode-block" id="fileInfo"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.endl.html#fudge.legacy.endl.endl2.fileInfo">[docs]</a><span class="k">def</span> <span class="nf">fileInfo</span><span class="p">(</span> <span class="n">yi</span><span class="p">,</span> <span class="n">ZA</span><span class="p">,</span> <span class="n">fileName</span> <span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Obtains yo, C, I and S from fileName and calls reactionInfo.&quot;&quot;&quot;</span>

    <span class="kn">import</span> <span class="nn">endlmisc</span>
    <span class="p">(</span> <span class="n">yo</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">S</span> <span class="p">)</span> <span class="o">=</span> <span class="n">endlmisc</span><span class="o">.</span><span class="n">intYoCIS</span><span class="p">(</span> <span class="n">fileName</span> <span class="p">)</span>
    <span class="k">return</span> <span class="n">reactionInfo</span><span class="p">(</span> <span class="n">yi</span><span class="p">,</span> <span class="n">ZA</span><span class="p">,</span> <span class="n">yo</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">S</span> <span class="p">)</span>
</div>
<div class="viewcode-block" id="reactionInfo"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.endl.html#fudge.legacy.endl.endl2.reactionInfo">[docs]</a><span class="k">def</span> <span class="nf">reactionInfo</span><span class="p">(</span> <span class="n">yi</span><span class="p">,</span> <span class="n">ZA</span><span class="p">,</span> <span class="n">yo</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">bdflsFile</span> <span class="o">=</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns a string of 5 lines. The first 3 lines are the item return by reactionEquations.</span>
<span class="sd">    The fourth is &quot;Elastic&quot; if C = 10 else it is a blank line, and the last is &quot;total cross section&quot;</span>
<span class="sd">    if I == 0 and C == 0, else it is the string return by endl_I.endl_ILabel.&quot;&quot;&quot;</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">reactionEquations</span><span class="p">(</span> <span class="n">yi</span><span class="p">,</span> <span class="n">ZA</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">bdflsFile</span> <span class="o">=</span> <span class="n">bdflsFile</span> <span class="p">)</span>
    <span class="n">s</span>  <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>                            <span class="c"># Line 1 done</span>
    <span class="n">s</span> <span class="o">+=</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>                            <span class="c"># Line 2 done</span>
    <span class="n">s</span> <span class="o">+=</span> <span class="n">r</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>                            <span class="c"># Line 3 done</span>
    <span class="k">if</span>   <span class="p">(</span> <span class="n">C</span> <span class="o">==</span> <span class="mi">10</span> <span class="p">)</span> <span class="p">:</span> <span class="n">s</span> <span class="o">+=</span> <span class="s">&quot;Elastic&quot;</span>
    <span class="n">s</span> <span class="o">+=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>                                   <span class="c"># Line 4 done</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">I</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">C</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s">&quot;total cross section&quot;</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="n">endl_I</span><span class="o">.</span><span class="n">endl_ILabel</span><span class="p">(</span> <span class="n">I</span> <span class="p">)</span>
    <span class="n">s</span> <span class="o">+=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>                                   <span class="c"># Line 5 done</span>
    <span class="k">return</span> <span class="n">s</span>
</div>
<div class="viewcode-block" id="reactionQByZAs"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.endl.html#fudge.legacy.endl.endl2.reactionQByZAs">[docs]</a><span class="k">def</span> <span class="nf">reactionQByZAs</span><span class="p">(</span> <span class="n">incomingZAs</span><span class="p">,</span> <span class="n">outgoingZAs</span><span class="p">,</span> <span class="n">bdflsFile</span> <span class="o">=</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns the Q in MeV for the reaction, that is, the (sum of incoming masses) - (sum of outgoing mass) in MeV.</span>
<span class="sd">    Returns None if at least one of the masses is unknown.&quot;&quot;&quot;</span>

    <span class="k">if</span><span class="p">(</span> <span class="n">bdflsFile</span> <span class="o">==</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span>
        <span class="kn">from</span> <span class="nn">fudge.processing</span> <span class="kn">import</span> <span class="n">bdfls</span>
        <span class="n">bdflsFile</span> <span class="o">=</span> <span class="n">bdfls</span><span class="o">.</span><span class="n">getDefaultBdfls</span><span class="p">(</span> <span class="p">)</span>
    <span class="n">ZAMultiplicities</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">ZA</span> <span class="ow">in</span> <span class="n">incomingZAs</span> <span class="p">:</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">ZA</span> <span class="o">&lt;</span> <span class="mi">1000</span> <span class="p">)</span> <span class="p">:</span> <span class="n">ZA</span> <span class="o">=</span> <span class="n">yoToZA_forNuclei</span><span class="p">(</span> <span class="n">ZA</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">ZA</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ZAMultiplicities</span> <span class="p">)</span> <span class="p">:</span> <span class="n">ZAMultiplicities</span><span class="p">[</span><span class="n">ZA</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">ZAMultiplicities</span><span class="p">[</span><span class="n">ZA</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">ZA</span> <span class="ow">in</span> <span class="n">outgoingZAs</span> <span class="p">:</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">ZA</span> <span class="o">&lt;</span> <span class="mi">1000</span> <span class="p">)</span> <span class="p">:</span> <span class="n">ZA</span> <span class="o">=</span> <span class="n">yoToZA_forNuclei</span><span class="p">(</span> <span class="n">ZA</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">ZA</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ZAMultiplicities</span> <span class="p">)</span> <span class="p">:</span> <span class="n">ZAMultiplicities</span><span class="p">[</span><span class="n">ZA</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">ZAMultiplicities</span><span class="p">[</span><span class="n">ZA</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="n">mass</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="n">ZAs</span> <span class="o">=</span> <span class="n">ZAMultiplicities</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span> <span class="p">)</span>
    <span class="n">ZAs</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span> <span class="p">)</span>
    <span class="k">for</span> <span class="n">ZA</span> <span class="ow">in</span> <span class="n">ZAs</span> <span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">bdflsFile</span><span class="o">.</span><span class="n">mass</span><span class="p">(</span> <span class="n">ZA</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">m</span> <span class="o">==</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="bp">None</span> <span class="p">)</span>
        <span class="n">mass</span> <span class="o">+=</span> <span class="n">m</span> <span class="o">*</span> <span class="n">ZAMultiplicities</span><span class="p">[</span><span class="n">ZA</span><span class="p">]</span>
    <span class="k">return</span><span class="p">(</span> <span class="n">mass</span> <span class="o">*</span> <span class="n">bdflsFile</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span> <span class="mi">4</span> <span class="p">)</span> <span class="p">)</span>
</div>
<div class="viewcode-block" id="reactionQByIsotopeNames"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.endl.html#fudge.legacy.endl.endl2.reactionQByIsotopeNames">[docs]</a><span class="k">def</span> <span class="nf">reactionQByIsotopeNames</span><span class="p">(</span> <span class="n">incomingNames</span><span class="p">,</span> <span class="n">outgoingNames</span><span class="p">,</span> <span class="n">bdflsFile</span> <span class="o">=</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns the Q in MeV for the reaction, that is, the (sum of incoming masses) - (sum of outgoing mass) in MeV.</span>
<span class="sd">    Returns None if at least one of the masses is unknown. This routine only works for isotopes in the ground state as it</span>
<span class="sd">    converts each name to it ZA and calls reactionQByZAs (see reactionQByZAs for more details). Example,</span>
<span class="sd">    incomingNames = [ &#39;n&#39;, &#39;W186&#39; ]</span>
<span class="sd">    outgoingNames = [ &#39;H3&#39;, &#39;He4&#39;, &#39;Tm176&#39; ]</span>
<span class="sd">    Q = reactionQByIsotopeNames( incomingNames, outgoingNames )&quot;&quot;&quot;</span>

    <span class="n">incomingZAs</span> <span class="o">=</span> <span class="p">[</span> <span class="n">gndNameToEndlZ_A_Suffix</span><span class="p">(</span> <span class="n">name</span> <span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">incomingNames</span> <span class="p">]</span>
    <span class="n">outgoingZAs</span> <span class="o">=</span> <span class="p">[</span> <span class="n">gndNameToEndlZ_A_Suffix</span><span class="p">(</span> <span class="n">name</span> <span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">outgoingNames</span> <span class="p">]</span>
    <span class="k">return</span><span class="p">(</span> <span class="n">reactionQByZAs</span><span class="p">(</span> <span class="n">incomingZAs</span><span class="p">,</span> <span class="n">outgoingZAs</span><span class="p">,</span> <span class="n">bdflsFile</span> <span class="p">)</span> <span class="p">)</span>
</div>
<div class="viewcode-block" id="possibleReactions"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.endl.html#fudge.legacy.endl.endl2.possibleReactions">[docs]</a><span class="k">def</span> <span class="nf">possibleReactions</span><span class="p">(</span> <span class="n">projectile</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">energy_MeV</span><span class="p">,</span> <span class="n">maxProducts</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">bdflsFile</span> <span class="o">=</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;This function returns a list of all reactions for the projectile with kinetic energy energy_MeV </span>
<span class="sd">    hitting the stationary target that are allowed by the amount of energy_MeV available in the </span>
<span class="sd">    center-of-mass and a reaction&#39;s Q.  Reactions considered will only contain products of n_1, </span>
<span class="sd">    H_1, H_2, H_3, He_3, He_4 and a residual. The reactions considered are also limited to the </span>
<span class="sd">    number of outgoing products, not including the residual, being no greater than maxProducts.&quot;&quot;&quot;</span>

    <span class="k">if</span><span class="p">(</span> <span class="n">bdflsFile</span> <span class="o">==</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span>
        <span class="kn">from</span> <span class="nn">fudge.processing</span> <span class="kn">import</span> <span class="n">bdfls</span>
        <span class="n">bdflsFile</span> <span class="o">=</span> <span class="n">bdfls</span><span class="o">.</span><span class="n">getDefaultBdfls</span><span class="p">(</span> <span class="p">)</span>
    <span class="kn">import</span> <span class="nn">endlmisc</span>

    <span class="n">projectile_</span> <span class="o">=</span> <span class="n">endlmisc</span><span class="o">.</span><span class="n">incidentParticleTags</span><span class="p">(</span> <span class="n">projectile</span> <span class="p">)</span>
    <span class="n">projectiles</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">1001</span><span class="p">,</span> <span class="mi">0</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">1002</span><span class="p">,</span> <span class="mi">0</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">1003</span><span class="p">,</span> <span class="mi">0</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">2003</span><span class="p">,</span> <span class="mi">0</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">2004</span><span class="p">,</span> <span class="mi">0</span> <span class="p">]</span> <span class="p">]</span>
    <span class="n">nProjectiles</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span> <span class="n">projectiles</span> <span class="p">)</span>
    <span class="k">if</span><span class="p">(</span> <span class="ow">not</span> <span class="p">(</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">projectile_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">nProjectiles</span> <span class="p">)</span> <span class="ow">and</span> <span class="n">projectile</span> <span class="o">!=</span> <span class="mi">7</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s"> is an unsupported projectile&#39;</span> <span class="o">%</span> <span class="n">projectile</span> <span class="p">)</span>
    <span class="n">projectileZA</span> <span class="o">=</span> <span class="n">yoToZA</span><span class="p">(</span> <span class="n">projectile_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>
    <span class="n">incidentZA</span> <span class="o">=</span> <span class="n">projectileZA</span> <span class="o">+</span> <span class="n">target</span>

    <span class="k">if</span> <span class="n">projectile</span> <span class="o">!=</span> <span class="mi">7</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">projectiles</span> <span class="p">:</span>
            <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">bdflsFile</span><span class="o">.</span><span class="n">mass</span><span class="p">(</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">projectileZA</span> <span class="p">)</span> <span class="p">:</span> <span class="n">projectileMass</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span> <span class="n">projectileMass</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">targetMass</span> <span class="o">=</span> <span class="n">bdflsFile</span><span class="o">.</span><span class="n">mass</span><span class="p">(</span> <span class="n">target</span> <span class="p">)</span>
    <span class="n">incidentMass</span> <span class="o">=</span> <span class="n">projectileMass</span> <span class="o">+</span> <span class="n">targetMass</span>
    <span class="n">kineticMass</span> <span class="o">=</span> <span class="n">energy_MeV</span> <span class="o">/</span> <span class="n">bdflsFile</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span> <span class="mi">4</span> <span class="p">)</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">kineticMass</span> <span class="o">&lt;</span> <span class="mf">1e-6</span> <span class="o">*</span> <span class="n">projectileMass</span> <span class="p">)</span> <span class="p">:</span>                         <span class="c"># Use non-relativity</span>
        <span class="n">incidentMass</span> <span class="o">+=</span> <span class="n">targetMass</span> <span class="o">*</span> <span class="n">kineticMass</span> <span class="o">/</span> <span class="n">incidentMass</span>
    <span class="k">else</span> <span class="p">:</span>                                                              <span class="c"># Need relativity</span>
        <span class="n">incidentMass</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">incidentMass</span> <span class="o">*</span> <span class="n">incidentMass</span> <span class="o">+</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">kineticMass</span> <span class="o">*</span> <span class="n">targetMass</span> <span class="p">)</span>

    <span class="n">reactions</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">possibleReactions2</span><span class="p">(</span> <span class="n">currentZA</span><span class="p">,</span> <span class="n">products</span><span class="p">,</span> <span class="n">productMass</span><span class="p">,</span> <span class="n">level</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">if</span><span class="p">(</span> <span class="n">level</span> <span class="o">&gt;</span> <span class="n">maxProducts</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span>
        <span class="k">for</span> <span class="n">ZA</span><span class="p">,</span> <span class="n">mass</span> <span class="ow">in</span> <span class="n">projectiles</span> <span class="p">:</span>
            <span class="n">residualZA</span> <span class="o">=</span> <span class="n">currentZA</span> <span class="o">-</span> <span class="n">ZA</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">residualZA</span> <span class="o">&lt;</span> <span class="n">ZA</span> <span class="p">)</span> <span class="p">:</span> <span class="k">break</span>
            <span class="n">Z</span><span class="p">,</span> <span class="n">A</span> <span class="o">=</span> <span class="n">ZandAFromZA</span><span class="p">(</span> <span class="n">residualZA</span> <span class="p">)</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">A</span> <span class="o">&lt;</span> <span class="n">Z</span> <span class="p">)</span> <span class="p">:</span> <span class="k">continue</span>
            <span class="n">newProducts</span> <span class="o">=</span> <span class="n">products</span> <span class="o">+</span> <span class="p">[</span> <span class="n">ZA</span> <span class="p">]</span>
            <span class="n">newProductMass</span> <span class="o">=</span> <span class="n">productMass</span> <span class="o">+</span> <span class="n">mass</span>
            <span class="k">if</span><span class="p">(</span> <span class="ow">not</span><span class="p">(</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">residualZA</span> <span class="o">&lt;</span> <span class="mi">1001</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> 
                <span class="n">residualMass</span> <span class="o">=</span> <span class="n">bdflsFile</span><span class="o">.</span><span class="n">mass</span><span class="p">(</span> <span class="n">residualZA</span> <span class="p">)</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">residualMass</span> <span class="o">!=</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span> 
                    <span class="k">if</span><span class="p">(</span> <span class="n">incidentMass</span> <span class="o">&gt;=</span> <span class="p">(</span> <span class="n">residualMass</span> <span class="o">+</span> <span class="n">newProductMass</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">reactions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>  <span class="n">newProducts</span> <span class="o">+</span> <span class="p">[</span> <span class="n">residualZA</span> <span class="p">]</span> <span class="p">)</span>
            <span class="n">possibleReactions2</span><span class="p">(</span> <span class="n">residualZA</span><span class="p">,</span> <span class="n">newProducts</span><span class="p">,</span> <span class="n">newProductMass</span><span class="p">,</span> <span class="n">level</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span>

    <span class="n">possibleReactions2</span><span class="p">(</span> <span class="n">incidentZA</span><span class="p">,</span> <span class="p">[],</span> <span class="mf">0.</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span>
    <span class="k">return</span><span class="p">(</span> <span class="n">reactions</span> <span class="p">)</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../../index.html">
              <img class="logo" src="../../../../_static/gnd.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../../index.html">Fudge and GND 1.2 beta documentation</a> &raquo;</li>
          <li><a href="../../../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, B.Beck, D. Brown, C. Mattoon, N. Patel, N. Summers.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>