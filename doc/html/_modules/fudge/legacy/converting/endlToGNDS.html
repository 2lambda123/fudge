
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>fudge.legacy.converting.endlToGNDS &#8212; Fudge and GNDS 4.2.3 beta documentation</title>
    <link rel="stylesheet" href="../../../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '4.2.3 beta',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../../../_static/gnd-20121206-favicon.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">Fudge and GNDS 4.2.3 beta documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for fudge.legacy.converting.endlToGNDS</h1><div class="highlight"><pre>
<span></span><span class="c1"># &lt;&lt;BEGIN-copyright&gt;&gt;</span>
<span class="c1"># &lt;&lt;END-copyright&gt;&gt;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This module contains the method toGNDS for the class endlZA. This module must only be import by the</span>
<span class="sd">toGNDS method of the endlZA class.</span>

<span class="sd">Nuclide particle name is composed of SA[_L]</span>
<span class="sd">        S is the element&#39;s symbol (e.g., &#39;He&#39; for helium).</span>
<span class="sd">        A is the nucleon number (e.g., &#39;He4&#39; for He-4). For natural (whatever that means) A = &#39;0&#39; (e.g., &#39;C0&#39;).</span>
<span class="sd">        L level designation for level greater than 0 (e.g., &#39;O16_e3&#39; for the third excition state of O16).</span>
<span class="sd">            The level name is &#39;e#&#39; where &#39;#&#39; is an integer (e.g., &#39;e2&#39; for the second excited state).</span>

<span class="sd">gamma: name is simply given as &#39;photon&#39;.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">pqu</span> <span class="k">import</span> <span class="n">PQU</span> <span class="k">as</span> <span class="n">PQUModule</span>

<span class="kn">import</span> <span class="nn">xData.standards</span> <span class="k">as</span> <span class="nn">standardsModule</span>
<span class="kn">import</span> <span class="nn">xData.XYs</span> <span class="k">as</span> <span class="nn">XYsModule</span>
<span class="kn">import</span> <span class="nn">xData.multiD_XYs</span> <span class="k">as</span> <span class="nn">multiD_XYsModule</span>

<span class="kn">from</span> <span class="nn">PoPs</span> <span class="k">import</span> <span class="n">database</span> <span class="k">as</span> <span class="n">databasePoPsModule</span>
<span class="kn">from</span> <span class="nn">PoPs</span> <span class="k">import</span> <span class="n">alias</span> <span class="k">as</span> <span class="n">PoPsAliasModule</span>
<span class="kn">from</span> <span class="nn">PoPs.quantities</span> <span class="k">import</span> <span class="n">quantity</span> <span class="k">as</span> <span class="n">quantityPoPsModule</span>
<span class="kn">from</span> <span class="nn">PoPs.quantities</span> <span class="k">import</span> <span class="n">mass</span> <span class="k">as</span> <span class="n">massPoPsModule</span>
<span class="kn">from</span> <span class="nn">PoPs.groups</span> <span class="k">import</span> <span class="n">misc</span> <span class="k">as</span> <span class="n">chemicalElementMiscPoPsModule</span>
<span class="kn">from</span> <span class="nn">PoPs.groups</span> <span class="k">import</span> <span class="n">chemicalElement</span> <span class="k">as</span> <span class="n">chemicalElementPoPsModule</span>

<span class="kn">from</span> <span class="nn">fudge</span> <span class="k">import</span> <span class="n">gnds</span>
<span class="kn">from</span> <span class="nn">fudge.legacy.endl</span> <span class="k">import</span> <span class="n">endl2</span><span class="p">,</span> <span class="n">endlmisc</span><span class="p">,</span> <span class="n">endl_C</span><span class="p">,</span> <span class="n">endlIClasses</span>
<span class="kn">import</span> <span class="nn">endf_endl</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">toGNDSMisc</span> <span class="k">as</span> <span class="n">toGNDSMiscModule</span>

<span class="kn">from</span> <span class="nn">fudge.gnds</span> <span class="k">import</span> <span class="n">physicalQuantity</span> <span class="k">as</span> <span class="n">physicalQuantityModule</span>
<span class="kn">from</span> <span class="nn">fudge.gnds</span> <span class="k">import</span> <span class="n">reactionSuite</span> <span class="k">as</span> <span class="n">reactionSuiteModule</span>
<span class="kn">from</span> <span class="nn">fudge.gnds</span> <span class="k">import</span> <span class="n">channels</span> <span class="k">as</span> <span class="n">channelsModule</span>
<span class="kn">from</span> <span class="nn">fudge.gnds</span> <span class="k">import</span> <span class="n">sums</span> <span class="k">as</span> <span class="n">sumsModule</span>
<span class="kn">from</span> <span class="nn">fudge.gnds.reactions</span> <span class="k">import</span> <span class="n">reaction</span> <span class="k">as</span> <span class="n">reactionModule</span>

<span class="kn">from</span> <span class="nn">fudge.gnds.reactionData</span> <span class="k">import</span> <span class="n">crossSection</span> <span class="k">as</span> <span class="n">crossSectionModule</span>
<span class="kn">from</span> <span class="nn">fudge.gnds.reactionData.doubleDifferentialCrossSection</span> <span class="k">import</span> <span class="n">base</span> <span class="k">as</span> <span class="n">baseModule</span>
<span class="kn">from</span> <span class="nn">fudge.gnds.reactionData.doubleDifferentialCrossSection.photonScattering</span> <span class="k">import</span> <span class="n">incoherent</span> <span class="k">as</span> <span class="n">incoherentModule</span>
<span class="kn">from</span> <span class="nn">fudge.gnds.reactionData.doubleDifferentialCrossSection.photonScattering</span> <span class="k">import</span> <span class="n">coherent</span> <span class="k">as</span> <span class="n">coherentModule</span>
<span class="kn">from</span> <span class="nn">fudge.gnds.reactionData.doubleDifferentialCrossSection.chargedParticleElastic</span> <span class="k">import</span> <span class="n">CoulombPlusNuclearElastic</span> <span class="k">as</span> <span class="n">CoulombPlusNuclearElasticModule</span>
<span class="kn">from</span> <span class="nn">fudge.gnds.reactionData.doubleDifferentialCrossSection.chargedParticleElastic</span> <span class="k">import</span> <span class="n">nuclearPlusInterference</span> <span class="k">as</span> <span class="n">nuclearPlusInterferenceModule</span>
<span class="kn">from</span> <span class="nn">fudge.gnds.reactionData.doubleDifferentialCrossSection.chargedParticleElastic</span> <span class="k">import</span> <span class="n">RutherfordScattering</span> <span class="k">as</span> <span class="n">RutherfordScatteringModule</span>

<span class="kn">from</span> <span class="nn">fudge.gnds.channelData</span> <span class="k">import</span> <span class="n">Q</span> <span class="k">as</span> <span class="n">QModule</span>

<span class="kn">from</span> <span class="nn">fudge.gnds.productData</span> <span class="k">import</span> <span class="n">multiplicity</span> <span class="k">as</span> <span class="n">multiplicityModule</span>
<span class="kn">from</span> <span class="nn">fudge.gnds.productData</span> <span class="k">import</span> <span class="n">energyDeposition</span> <span class="k">as</span> <span class="n">energyDepositionModule</span>
<span class="kn">from</span> <span class="nn">fudge.gnds.productData</span> <span class="k">import</span> <span class="n">momentumDeposition</span> <span class="k">as</span> <span class="n">momentumDepositionModule</span>

<span class="kn">from</span> <span class="nn">fudge.gnds.productData.distributions</span> <span class="k">import</span> <span class="n">angular</span> <span class="k">as</span> <span class="n">angularModule</span>
<span class="kn">from</span> <span class="nn">fudge.gnds.productData.distributions</span> <span class="k">import</span> <span class="n">energy</span> <span class="k">as</span> <span class="n">energyModule</span>
<span class="kn">from</span> <span class="nn">fudge.gnds.productData.distributions</span> <span class="k">import</span> <span class="n">Legendre</span> <span class="k">as</span> <span class="n">LegendreModule</span>
<span class="kn">from</span> <span class="nn">fudge.gnds.productData.distributions</span> <span class="k">import</span> <span class="n">uncorrelated</span> <span class="k">as</span> <span class="n">uncorrelatedModule</span>
<span class="kn">from</span> <span class="nn">fudge.gnds.productData.distributions</span> <span class="k">import</span> <span class="n">angularEnergy</span> <span class="k">as</span> <span class="n">angularEnergyModule</span>
<span class="kn">from</span> <span class="nn">fudge.gnds.productData.distributions</span> <span class="k">import</span> <span class="n">reference</span> <span class="k">as</span> <span class="n">referenceModule</span>
<span class="kn">from</span> <span class="nn">fudge.gnds.productData.distributions</span> <span class="k">import</span> <span class="n">unspecified</span> <span class="k">as</span> <span class="n">unspecifiedModule</span>
<span class="kn">from</span> <span class="nn">fudge.gnds.productData.distributions</span> <span class="k">import</span> <span class="n">photonScattering</span> <span class="k">as</span> <span class="n">photonScatteringModule</span>

<span class="kn">from</span> <span class="nn">site_packages.legacy.toENDF6</span> <span class="k">import</span> <span class="n">ENDFconversionFlags</span> <span class="k">as</span> <span class="n">ENDFconversionFlagsModule</span>

<span class="n">FUDGE_EPS</span> <span class="o">=</span> <span class="mf">1e-8</span>
<span class="n">energyUnit</span> <span class="o">=</span> <span class="s2">&quot;MeV&quot;</span>

<span class="n">crossSectionAxes</span> <span class="o">=</span> <span class="n">crossSectionModule</span><span class="o">.</span><span class="n">defaultAxes</span><span class="p">(</span> <span class="n">energyUnit</span> <span class="p">)</span>
<span class="n">multiplicityAxes</span> <span class="o">=</span> <span class="n">multiplicityModule</span><span class="o">.</span><span class="n">defaultAxes</span><span class="p">(</span> <span class="n">energyUnit</span> <span class="p">)</span>
<span class="n">QAxes</span> <span class="o">=</span> <span class="n">QModule</span><span class="o">.</span><span class="n">defaultAxes</span><span class="p">(</span> <span class="n">energyUnit</span> <span class="p">)</span>
<span class="n">energyDepositionAxes</span> <span class="o">=</span> <span class="n">energyDepositionModule</span><span class="o">.</span><span class="n">defaultAxes</span><span class="p">(</span> <span class="n">energyUnit</span> <span class="p">)</span>
<span class="n">momentumDepositionAxes</span> <span class="o">=</span> <span class="n">momentumDepositionModule</span><span class="o">.</span><span class="n">defaultAxes</span><span class="p">(</span> <span class="n">energyUnit</span><span class="p">,</span> <span class="n">energyUnit</span> <span class="o">+</span> <span class="s1">&#39;/c&#39;</span> <span class="p">)</span>
<span class="n">angularAxes</span> <span class="o">=</span> <span class="n">angularModule</span><span class="o">.</span><span class="n">defaultAxes</span><span class="p">(</span> <span class="n">energyUnit</span> <span class="p">)</span>
<span class="n">energyAxes</span> <span class="o">=</span> <span class="n">energyModule</span><span class="o">.</span><span class="n">defaultAxes</span><span class="p">(</span> <span class="n">energyUnit</span> <span class="p">)</span>
<span class="n">LLNLPointwiseAxes</span> <span class="o">=</span> <span class="n">LegendreModule</span><span class="o">.</span><span class="n">defaultAxes</span><span class="p">(</span> <span class="n">energyUnit</span> <span class="p">)</span>
<span class="n">angularEnergAxes</span> <span class="o">=</span> <span class="n">angularEnergyModule</span><span class="o">.</span><span class="n">defaultAxes</span><span class="p">(</span> <span class="s2">&quot;MeV&quot;</span><span class="p">,</span> <span class="s1">&#39;P(energy_out|energy_in,mu)&#39;</span> <span class="p">)</span>

<div class="viewcode-block" id="getXYInterpolation"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.converting.html#fudge.legacy.converting.endlToGNDS.getXYInterpolation">[docs]</a><span class="k">def</span> <span class="nf">getXYInterpolation</span><span class="p">(</span> <span class="n">data</span> <span class="p">)</span> <span class="p">:</span>

    <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="mi">2</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s1">&#39;Only 2 column data supported, # of columns = </span><span class="si">%s</span><span class="s1"> for </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span> <span class="n">data</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">interpolation</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="n">standardsModule</span><span class="o">.</span><span class="n">interpolation</span><span class="o">.</span><span class="n">linlinToken</span> <span class="p">)</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">interpolation</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="n">standardsModule</span><span class="o">.</span><span class="n">interpolation</span><span class="o">.</span><span class="n">linlogToken</span> <span class="p">)</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">interpolation</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="n">standardsModule</span><span class="o">.</span><span class="n">interpolation</span><span class="o">.</span><span class="n">loglinToken</span> <span class="p">)</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">interpolation</span> <span class="o">==</span> <span class="mi">3</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="n">standardsModule</span><span class="o">.</span><span class="n">interpolation</span><span class="o">.</span><span class="n">loglogToken</span> <span class="p">)</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s1">&#39;Unsupported interpolation = &quot;</span><span class="si">%s</span><span class="s1">&quot; for </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">interpolation</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span> <span class="n">data</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="returnConstantQ"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.converting.html#fudge.legacy.converting.endlToGNDS.returnConstantQ">[docs]</a><span class="k">def</span> <span class="nf">returnConstantQ</span><span class="p">(</span> <span class="n">label</span><span class="p">,</span> <span class="n">Q_MeV</span><span class="p">,</span> <span class="n">crossSection</span> <span class="p">)</span> <span class="p">:</span>

    <span class="k">return</span><span class="p">(</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">returnConstantQ</span><span class="p">(</span> <span class="n">label</span><span class="p">,</span> <span class="n">Q_MeV</span><span class="p">,</span> <span class="n">crossSection</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="uncorrelated"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.converting.html#fudge.legacy.converting.endlToGNDS.uncorrelated">[docs]</a><span class="k">def</span> <span class="nf">uncorrelated</span><span class="p">(</span> <span class="n">style</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">angularSubform</span><span class="p">,</span> <span class="n">energySubform</span> <span class="p">)</span> <span class="p">:</span>

    <span class="n">_angularSubform</span> <span class="o">=</span> <span class="n">uncorrelatedModule</span><span class="o">.</span><span class="n">angularSubform</span><span class="p">(</span> <span class="n">angularSubform</span> <span class="p">)</span>
    <span class="n">_energySubform</span> <span class="o">=</span> <span class="n">uncorrelatedModule</span><span class="o">.</span><span class="n">energySubform</span><span class="p">(</span> <span class="n">energySubform</span> <span class="p">)</span>
    <span class="k">return</span><span class="p">(</span> <span class="n">uncorrelatedModule</span><span class="o">.</span><span class="n">form</span><span class="p">(</span> <span class="n">style</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">_angularSubform</span><span class="p">,</span> <span class="n">_energySubform</span> <span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="toGNDS"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.converting.html#fudge.legacy.converting.endlToGNDS.toGNDS">[docs]</a><span class="k">def</span> <span class="nf">toGNDS</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">evaluationLibrary</span><span class="p">,</span> <span class="n">evaluationVersion</span><span class="p">,</span> <span class="n">excludeAverageProductData</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns an reactionSuite for self where self is an endlZA class.&quot;&quot;&quot;</span>
<span class="c1">#</span>
<span class="c1">#   A discrete N-body reaction is one where all the yo&#39;s are known and they have energy independent multiplicities.</span>
<span class="c1">#</span>

    <span class="k">def</span> <span class="nf">getDistributionIs</span><span class="p">(</span> <span class="n">yo</span><span class="p">,</span> <span class="n">yosDatas</span> <span class="p">)</span> <span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Gets the list of I-values matching the list [ 1, 3, 4, 7, 9 ] for yo.&quot;&quot;&quot;</span>

        <span class="n">Is</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">yosDatas</span><span class="p">[</span><span class="n">yo</span><span class="p">]</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="ow">in</span> <span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">Is</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">Is</span> <span class="p">)</span>

    <span class="k">def</span> <span class="nf">getIDistributionData</span><span class="p">(</span> <span class="n">yo</span><span class="p">,</span> <span class="n">yosDatas</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return the data for the requested yo/I/S or None if not data present.&quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">yosDatas</span><span class="p">[</span><span class="n">yo</span><span class="p">]</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">S</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> <span class="n">S</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">S</span>
            <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="n">I</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">S</span> <span class="o">==</span> <span class="n">S</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="n">data</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="kc">None</span> <span class="p">)</span>

    <span class="k">def</span> <span class="nf">getAllDistributionIs</span><span class="p">(</span> <span class="n">yoDatas</span><span class="p">,</span> <span class="n">IMax</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span> <span class="n">IExtras</span> <span class="o">=</span> <span class="p">()</span> <span class="p">)</span> <span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;For a yo get all distribution I-values (i.e., I in [1,9] and in IExtras).&quot;&quot;&quot;</span>

        <span class="n">Is</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">yoData</span> <span class="ow">in</span> <span class="n">yoDatas</span> <span class="p">:</span>
            <span class="n">I</span> <span class="o">=</span> <span class="n">yoData</span><span class="o">.</span><span class="n">I</span>
            <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="p">(</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">IExtras</span> <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span> <span class="n">I</span> <span class="o">&lt;=</span> <span class="n">IMax</span> <span class="p">)</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">I</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">Is</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">Is</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">I</span> <span class="p">)</span>
        <span class="n">Is</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">Is</span> <span class="p">)</span>

    <span class="k">def</span> <span class="nf">isYoAndResidaulDataTheSame</span><span class="p">(</span> <span class="n">yo</span><span class="p">,</span> <span class="n">yosDatas</span> <span class="p">)</span> <span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Test if yo and the residual have the same distribution data (i.e., I = 1, 3, 4, 7 and 9).&quot;&quot;&quot;</span>

        <span class="n">yoData</span> <span class="o">=</span> <span class="n">yosDatas</span><span class="p">[</span><span class="n">yo</span><span class="p">]</span>
        <span class="n">resData</span> <span class="o">=</span> <span class="n">yosDatas</span><span class="p">[</span><span class="n">yo</span><span class="o">+</span><span class="mi">10</span><span class="p">]</span>
        <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">yoData</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">resData</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="kc">False</span> <span class="p">)</span>
        <span class="n">yoIs</span> <span class="o">=</span> <span class="n">getDistributionIs</span><span class="p">(</span> <span class="n">yo</span><span class="p">,</span> <span class="n">yosDatas</span> <span class="p">)</span>
        <span class="n">resIs</span> <span class="o">=</span> <span class="n">getDistributionIs</span><span class="p">(</span> <span class="n">yo</span> <span class="o">+</span> <span class="mi">10</span><span class="p">,</span> <span class="n">yosDatas</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">yoIs</span> <span class="o">!=</span> <span class="n">resIs</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="kc">False</span> <span class="p">)</span>
        <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">yoIs</span> <span class="p">:</span>
            <span class="n">yoIData</span> <span class="o">=</span> <span class="n">getIDistributionData</span><span class="p">(</span> <span class="n">yo</span><span class="p">,</span> <span class="n">yosDatas</span><span class="p">,</span> <span class="n">I</span> <span class="p">)</span>
            <span class="n">resIData</span> <span class="o">=</span> <span class="n">getIDistributionData</span><span class="p">(</span> <span class="n">yo</span> <span class="o">+</span> <span class="mi">10</span><span class="p">,</span> <span class="n">yosDatas</span><span class="p">,</span> <span class="n">I</span> <span class="p">)</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">yoIData</span><span class="o">.</span><span class="n">data</span> <span class="o">!=</span> <span class="n">resIData</span><span class="o">.</span><span class="n">data</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="kc">False</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="kc">True</span> <span class="p">)</span>

    <span class="k">def</span> <span class="nf">getMultiplicityYos</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">yos</span><span class="p">,</span> <span class="n">residuals</span><span class="p">,</span> <span class="n">yosDatas</span> <span class="p">)</span> <span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Gets the (multiplicty, yo) pairs and adjust residuals if needed.&quot;&quot;&quot;</span>

        <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">residuals</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s1">&#39;len( residuals ) &gt; 1 not supported: residual = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">repr</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">yoOld</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">mYos</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">yo</span> <span class="ow">in</span> <span class="n">yos</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">yo</span> <span class="o">==</span> <span class="n">yoOld</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">yoOld</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> <span class="n">mYos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">[</span> <span class="n">n</span><span class="p">,</span> <span class="n">yoOld</span> <span class="p">]</span> <span class="p">)</span>
                <span class="n">yoOld</span> <span class="o">=</span> <span class="n">yo</span>
                <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">yos</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">residuals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">yo</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">rYo</span> <span class="o">=</span> <span class="n">endl2</span><span class="o">.</span><span class="n">ZAToYo</span><span class="p">(</span> <span class="n">residuals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">isYoAndResidaulDataTheSame</span><span class="p">(</span> <span class="n">rYo</span><span class="p">,</span> <span class="n">yosDatas</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="n">residuals</span> <span class="o">=</span> <span class="n">residuals</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>           <span class="c1"># residuals should now be empty.</span>
                    <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">yosDatas</span><span class="p">[</span><span class="n">rYo</span> <span class="o">+</span> <span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">yosData</span> <span class="ow">in</span> <span class="n">yosDatas</span><span class="p">[</span><span class="n">rYo</span><span class="p">]</span> <span class="p">:</span>
                        <span class="k">if</span><span class="p">(</span> <span class="n">yosData</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">10</span> <span class="p">)</span> <span class="p">:</span> <span class="n">yosData</span><span class="o">.</span><span class="n">set</span><span class="p">(</span> <span class="n">yosData</span> <span class="o">*</span> <span class="p">(</span> <span class="n">n</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>

            <span class="n">mYos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">[</span> <span class="n">n</span><span class="p">,</span> <span class="n">yo</span> <span class="p">]</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">residuals</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="n">mYos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="n">residuals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">]</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">mYos</span> <span class="p">)</span>

    <span class="k">def</span> <span class="nf">addDistributionDataAndRemove</span><span class="p">(</span> <span class="n">particle</span><span class="p">,</span> <span class="n">yo</span><span class="p">,</span> <span class="n">yosDatas</span><span class="p">,</span> <span class="n">crossSection</span><span class="p">,</span> <span class="n">promptNeutronParticle</span> <span class="o">=</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">def</span> <span class="nf">angular</span><span class="p">(</span> <span class="n">data</span> <span class="p">)</span> <span class="p">:</span>

            <span class="n">subform</span> <span class="o">=</span> <span class="n">angularModule</span><span class="o">.</span><span class="n">XYs2d</span><span class="p">(</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">angularAxes</span> <span class="p">)</span>
            <span class="k">for</span> <span class="n">i1</span><span class="p">,</span> <span class="n">EMuP</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">E1</span><span class="p">,</span> <span class="n">muP</span> <span class="o">=</span> <span class="n">EMuP</span>
                <span class="n">subform</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span> <span class="o">=</span> <span class="n">angularModule</span><span class="o">.</span><span class="n">XYs1d</span><span class="p">(</span> <span class="n">data</span> <span class="o">=</span> <span class="n">muP</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">E1</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">angularAxes</span> <span class="p">)</span>
            <span class="k">return</span><span class="p">(</span> <span class="n">subform</span> <span class="p">)</span>

        <span class="k">def</span> <span class="nf">energy</span><span class="p">(</span> <span class="n">data</span> <span class="p">)</span> <span class="p">:</span>

            <span class="n">subform</span> <span class="o">=</span> <span class="n">energyModule</span><span class="o">.</span><span class="n">XYs2d</span><span class="p">(</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">energyAxes</span><span class="p">,</span> <span class="n">interpolationQualifier</span> <span class="o">=</span> <span class="n">standardsModule</span><span class="o">.</span><span class="n">interpolation</span><span class="o">.</span><span class="n">unitBaseToken</span> <span class="p">)</span>
            <span class="k">for</span> <span class="n">E1</span><span class="p">,</span> <span class="n">EpP</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="p">:</span> <span class="n">subform</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">energyModule</span><span class="o">.</span><span class="n">XYs1d</span><span class="p">(</span> <span class="n">data</span> <span class="o">=</span> <span class="n">EpP</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">E1</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">energyAxes</span> <span class="p">)</span> <span class="p">)</span>
            <span class="k">return</span><span class="p">(</span> <span class="n">subform</span> <span class="p">)</span>

        <span class="k">def</span> <span class="nf">LLNLLegendrePointwise</span><span class="p">(</span> <span class="n">data</span> <span class="p">)</span> <span class="p">:</span>

            <span class="n">axes</span> <span class="o">=</span> <span class="n">LLNLPointwiseAxes</span>
            <span class="n">subform</span> <span class="o">=</span> <span class="n">LegendreModule</span><span class="o">.</span><span class="n">LLNLPointwise</span><span class="p">(</span> <span class="n">axes</span> <span class="p">)</span>
            <span class="k">for</span> <span class="n">l</span><span class="p">,</span> <span class="n">EEpPs</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span> <span class="p">:</span>
                <span class="n">w_xys</span> <span class="o">=</span> <span class="n">multiD_XYsModule</span><span class="o">.</span><span class="n">XYs2d</span><span class="p">(</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">l</span> <span class="p">)</span>
                <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">E_EpPs</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="n">EEpPs</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="n">xPrior</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                    <span class="n">E1</span><span class="p">,</span> <span class="n">EpPs</span> <span class="o">=</span> <span class="n">E_EpPs</span>
                    <span class="k">for</span> <span class="n">xy</span> <span class="ow">in</span> <span class="n">EpPs</span> <span class="p">:</span>
                        <span class="k">if</span><span class="p">(</span> <span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">xPrior</span> <span class="p">)</span> <span class="p">:</span> <span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*=</span> <span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">FUDGE_EPS</span> <span class="p">)</span>
                        <span class="n">xPrior</span> <span class="o">=</span> <span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">w_xys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">XYsModule</span><span class="o">.</span><span class="n">XYs1d</span><span class="p">(</span> <span class="n">data</span> <span class="o">=</span> <span class="n">EpPs</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">E1</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">subform</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">w_xys</span> <span class="p">)</span>
            <span class="k">return</span><span class="p">(</span> <span class="n">subform</span> <span class="p">)</span>

        <span class="k">def</span> <span class="nf">LLNLLegendrePointwise_L0_only</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">data</span> <span class="p">)</span> <span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;Has only L=0 form, can be converted to uncorrelated angular (isotropic) and energy distributions.&quot;&quot;&quot;</span>

            <span class="n">angularSubform</span> <span class="o">=</span> <span class="n">angularModule</span><span class="o">.</span><span class="n">isotropic2d</span><span class="p">(</span> <span class="p">)</span>
            <span class="n">axes</span> <span class="o">=</span> <span class="n">energyAxes</span>
            <span class="n">energySubform</span> <span class="o">=</span> <span class="n">energyModule</span><span class="o">.</span><span class="n">XYs2d</span><span class="p">(</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="p">,</span> <span class="n">interpolationQualifier</span> <span class="o">=</span> <span class="n">standardsModule</span><span class="o">.</span><span class="n">interpolation</span><span class="o">.</span><span class="n">unitBaseToken</span> <span class="p">)</span>
            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="p">(</span> <span class="n">energy</span><span class="p">,</span> <span class="n">probability_list</span> <span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">energySubform</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">energyModule</span><span class="o">.</span><span class="n">XYs1d</span><span class="p">(</span> <span class="n">data</span> <span class="o">=</span> <span class="n">probability_list</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">energy</span> <span class="p">)</span> <span class="p">)</span>
            <span class="k">return</span><span class="p">(</span> <span class="n">uncorrelated</span><span class="p">(</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">standardsModule</span><span class="o">.</span><span class="n">frames</span><span class="o">.</span><span class="n">labToken</span><span class="p">,</span> <span class="n">angularSubform</span><span class="p">,</span> <span class="n">energySubform</span> <span class="p">)</span> <span class="p">)</span>

        <span class="k">def</span> <span class="nf">LLNLAngularEnergy</span><span class="p">(</span> <span class="n">data</span> <span class="p">)</span> <span class="p">:</span>

            <span class="n">axes</span> <span class="o">=</span> <span class="n">angularEnergAxes</span>
            <span class="n">subform</span> <span class="o">=</span> <span class="n">angularEnergyModule</span><span class="o">.</span><span class="n">XYs3d</span><span class="p">(</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="p">,</span> <span class="n">interpolationQualifier</span> <span class="o">=</span> <span class="n">standardsModule</span><span class="o">.</span><span class="n">interpolation</span><span class="o">.</span><span class="n">unitBaseToken</span>  <span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">E_MuEpPs</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">w_xys</span> <span class="o">=</span> <span class="n">angularEnergyModule</span><span class="o">.</span><span class="n">XYs2d</span><span class="p">(</span> <span class="n">value</span> <span class="o">=</span> <span class="n">E_MuEpPs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span> <span class="p">)</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">Mu_EpPs</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="n">E_MuEpPs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="n">w_xys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">angularEnergyModule</span><span class="o">.</span><span class="n">XYs1d</span><span class="p">(</span> <span class="n">data</span> <span class="o">=</span> <span class="n">Mu_EpPs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">Mu_EpPs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">subform</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">w_xys</span> <span class="p">)</span>
            <span class="k">return</span><span class="p">(</span> <span class="n">subform</span> <span class="p">)</span>

        <span class="k">def</span> <span class="nf">getSubform</span><span class="p">(</span> <span class="n">I</span><span class="p">,</span> <span class="n">datas</span><span class="p">,</span> <span class="n">func</span> <span class="p">)</span> <span class="p">:</span>

            <span class="k">for</span> <span class="n">i1</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="n">datas</span> <span class="p">)</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="n">I</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="k">del</span> <span class="n">datas</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                    <span class="k">return</span><span class="p">(</span> <span class="n">func</span><span class="p">(</span> <span class="n">data</span> <span class="p">)</span> <span class="p">)</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s1">&#39;I = </span><span class="si">%d</span><span class="s1"> not in datas&#39;</span> <span class="o">%</span> <span class="n">I</span> <span class="p">)</span>

        <span class="k">if</span><span class="p">(</span> <span class="n">yo</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">yosDatas</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span>
        <span class="n">datas</span> <span class="o">=</span> <span class="n">yosDatas</span><span class="p">[</span><span class="n">yo</span><span class="p">]</span>
        <span class="n">Is</span> <span class="o">=</span> <span class="n">getAllDistributionIs</span><span class="p">(</span> <span class="n">datas</span><span class="p">,</span> <span class="n">IMax</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">IExtras</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">941</span><span class="p">,</span> <span class="mi">942</span> <span class="p">]</span> <span class="p">)</span>
        <span class="n">form</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">doubleDifferentialCrossSectionForm</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">Is</span> <span class="o">==</span> <span class="p">[]</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">datas</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">datas</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">datas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">S</span> <span class="o">==</span> <span class="mi">7</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">datas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">7</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>   <span class="c1"># Special case for endl I, S = 7, 7 with no distribution data.</span>
                    <span class="n">form</span> <span class="o">=</span> <span class="n">referenceModule</span><span class="o">.</span><span class="n">form</span><span class="p">(</span> <span class="n">link</span> <span class="o">=</span> <span class="n">promptNeutronParticle</span><span class="o">.</span><span class="n">distribution</span><span class="p">[</span><span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span> <span class="p">)</span>
                <span class="k">else</span> <span class="p">:</span>
                    <span class="nb">print</span><span class="p">()</span>
                    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">datas</span> <span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s2">&quot;Unsupported data for particle </span><span class="si">%s</span><span class="s2">: I&#39;s = </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">particle</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">Is</span><span class="p">)))</span>
        <span class="k">elif</span><span class="p">(</span> <span class="n">Is</span> <span class="o">==</span> <span class="p">[</span> <span class="mi">941</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">for</span> <span class="n">i1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">datas</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">datas</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">941</span> <span class="p">)</span> <span class="p">:</span> <span class="k">break</span>
            <span class="n">axes</span> <span class="o">=</span> <span class="n">baseModule</span><span class="o">.</span><span class="n">defaultAxes</span><span class="p">(</span> <span class="s1">&#39;coherent scattering function&#39;</span><span class="p">,</span> <span class="n">energyUnit</span> <span class="o">=</span> <span class="s1">&#39;1/cm&#39;</span> <span class="p">)</span>
            <span class="n">formFactor</span> <span class="o">=</span> <span class="n">coherentModule</span><span class="o">.</span><span class="n">XYs1d</span><span class="p">(</span> <span class="n">data</span> <span class="o">=</span> <span class="n">datas</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span> <span class="p">)</span>
            <span class="n">formFactor</span> <span class="o">=</span> <span class="n">coherentModule</span><span class="o">.</span><span class="n">scatteringFunction</span><span class="p">(</span> <span class="n">formFactor</span> <span class="p">)</span>
            <span class="n">doubleDifferentialCrossSectionForm</span> <span class="o">=</span> <span class="n">coherentModule</span><span class="o">.</span><span class="n">form</span><span class="p">(</span> <span class="n">particle</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">standardsModule</span><span class="o">.</span><span class="n">frames</span><span class="o">.</span><span class="n">labToken</span><span class="p">,</span> <span class="n">formFactor</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span> <span class="p">)</span>
            <span class="n">form</span> <span class="o">=</span> <span class="n">photonScatteringModule</span><span class="o">.</span><span class="n">coherentPhotonScattering</span><span class="o">.</span><span class="n">form</span><span class="p">(</span> <span class="n">label</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">link</span> <span class="o">=</span> <span class="n">doubleDifferentialCrossSectionForm</span> <span class="p">)</span>
            <span class="k">del</span> <span class="n">datas</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
        <span class="k">elif</span><span class="p">(</span> <span class="mi">942</span> <span class="ow">in</span> <span class="n">Is</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">for</span> <span class="n">i1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">datas</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">datas</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">942</span> <span class="p">)</span> <span class="p">:</span> <span class="k">break</span>
            <span class="n">axes</span> <span class="o">=</span> <span class="n">baseModule</span><span class="o">.</span><span class="n">defaultAxes</span><span class="p">(</span> <span class="s1">&#39;incoherent scattering function&#39;</span><span class="p">,</span> <span class="n">energyUnit</span> <span class="o">=</span> <span class="s1">&#39;1/cm&#39;</span> <span class="p">)</span>
            <span class="n">scatteringFunction</span> <span class="o">=</span> <span class="n">incoherentModule</span><span class="o">.</span><span class="n">XYs1d</span><span class="p">(</span> <span class="n">data</span> <span class="o">=</span> <span class="n">datas</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span> <span class="p">)</span>
            <span class="n">doubleDifferentialCrossSectionForm</span> <span class="o">=</span> <span class="n">incoherentModule</span><span class="o">.</span><span class="n">form</span><span class="p">(</span> <span class="n">particle</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">standardsModule</span><span class="o">.</span><span class="n">frames</span><span class="o">.</span><span class="n">labToken</span><span class="p">,</span> <span class="n">scatteringFunction</span> <span class="p">)</span>
            <span class="n">form</span> <span class="o">=</span> <span class="n">photonScatteringModule</span><span class="o">.</span><span class="n">incoherentPhotonScattering</span><span class="o">.</span><span class="n">form</span><span class="p">(</span> <span class="n">label</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">link</span> <span class="o">=</span> <span class="n">doubleDifferentialCrossSectionForm</span> <span class="p">)</span>
            <span class="k">del</span> <span class="n">datas</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
        <span class="k">elif</span><span class="p">(</span> <span class="n">Is</span> <span class="o">==</span> <span class="p">[</span> <span class="mi">1</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span> 
            <span class="k">if</span><span class="p">(</span> <span class="n">datas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">S</span> <span class="o">==</span> <span class="mi">3</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">energySubform</span> <span class="o">=</span> <span class="n">energyModule</span><span class="o">.</span><span class="n">discreteGamma</span><span class="p">(</span> <span class="n">datas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">getX1</span><span class="p">(</span> <span class="p">),</span> <span class="n">crossSection</span><span class="o">.</span><span class="n">domainMin</span><span class="p">,</span>
                        <span class="n">crossSection</span><span class="o">.</span><span class="n">domainMax</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">energyAxes</span> <span class="p">)</span>
                <span class="n">angularSubform</span> <span class="o">=</span> <span class="n">getSubform</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">datas</span><span class="p">,</span> <span class="n">angular</span> <span class="p">)</span>
                <span class="n">form</span> <span class="o">=</span> <span class="n">uncorrelated</span><span class="p">(</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">standardsModule</span><span class="o">.</span><span class="n">frames</span><span class="o">.</span><span class="n">labToken</span><span class="p">,</span> <span class="n">angularSubform</span><span class="p">,</span> <span class="n">energySubform</span> <span class="p">)</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">datas</span> <span class="p">:</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span> <span class="n">productFrame</span> <span class="o">=</span> <span class="n">standardsModule</span><span class="o">.</span><span class="n">frames</span><span class="o">.</span><span class="n">centerOfMassToken</span>
                <span class="n">subform</span> <span class="o">=</span> <span class="n">getSubform</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">datas</span><span class="p">,</span> <span class="n">angular</span> <span class="p">)</span>
                <span class="n">form</span> <span class="o">=</span> <span class="n">angularModule</span><span class="o">.</span><span class="n">twoBodyForm</span><span class="p">(</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">productFrame</span><span class="p">,</span> <span class="n">subform</span> <span class="p">)</span>
        <span class="k">elif</span><span class="p">(</span> <span class="n">Is</span> <span class="o">==</span> <span class="p">[</span> <span class="mi">4</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">for</span> <span class="n">i1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">datas</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">datas</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">4</span> <span class="p">)</span> <span class="p">:</span> <span class="k">break</span>
            <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">datas</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">datas</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">form</span> <span class="o">=</span> <span class="n">LLNLLegendrePointwise_L0_only</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">datas</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span> <span class="p">)</span>
                <span class="k">del</span> <span class="n">datas</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">subform</span> <span class="o">=</span> <span class="n">getSubform</span><span class="p">(</span> <span class="mi">4</span><span class="p">,</span> <span class="n">datas</span><span class="p">,</span> <span class="n">LLNLLegendrePointwise</span> <span class="p">)</span>
                <span class="n">form</span> <span class="o">=</span> <span class="n">LegendreModule</span><span class="o">.</span><span class="n">form</span><span class="p">(</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">standardsModule</span><span class="o">.</span><span class="n">frames</span><span class="o">.</span><span class="n">labToken</span><span class="p">,</span> <span class="n">subform</span> <span class="p">)</span>
        <span class="k">elif</span><span class="p">(</span> <span class="n">Is</span> <span class="o">==</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">angularSubform</span> <span class="o">=</span> <span class="n">getSubform</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">datas</span><span class="p">,</span> <span class="n">angular</span> <span class="p">)</span>
            <span class="n">angularSubform</span> <span class="o">=</span> <span class="n">angularEnergyModule</span><span class="o">.</span><span class="n">LLNLAngularOfAngularEnergySubform</span><span class="p">(</span> <span class="n">angularSubform</span> <span class="p">)</span>
            <span class="n">angularEnergySubform</span> <span class="o">=</span> <span class="n">getSubform</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">datas</span><span class="p">,</span> <span class="n">LLNLAngularEnergy</span> <span class="p">)</span>
            <span class="n">angularEnergySubform</span> <span class="o">=</span> <span class="n">angularEnergyModule</span><span class="o">.</span><span class="n">LLNLAngularEnergyOfAngularEnergySubform</span><span class="p">(</span> <span class="n">angularEnergySubform</span> <span class="p">)</span>
            <span class="n">form</span> <span class="o">=</span> <span class="n">angularEnergyModule</span><span class="o">.</span><span class="n">LLNLAngularEnergyForm</span><span class="p">(</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">standardsModule</span><span class="o">.</span><span class="n">frames</span><span class="o">.</span><span class="n">labToken</span><span class="p">,</span>
                    <span class="n">angularSubform</span><span class="p">,</span> <span class="n">angularEnergySubform</span> <span class="p">)</span>
        <span class="k">elif</span><span class="p">(</span> <span class="n">Is</span> <span class="o">==</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">angularSubform</span> <span class="o">=</span> <span class="n">getSubform</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">datas</span><span class="p">,</span> <span class="n">angular</span> <span class="p">)</span>
            <span class="n">energySubform</span> <span class="o">=</span> <span class="n">getSubform</span><span class="p">(</span> <span class="mi">4</span><span class="p">,</span> <span class="n">datas</span><span class="p">,</span> <span class="n">energy</span> <span class="p">)</span>
            <span class="n">form</span> <span class="o">=</span> <span class="n">uncorrelated</span><span class="p">(</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">standardsModule</span><span class="o">.</span><span class="n">frames</span><span class="o">.</span><span class="n">labToken</span><span class="p">,</span> <span class="n">angularSubform</span><span class="p">,</span> <span class="n">energySubform</span> <span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s2">&quot;I&#39;s = </span><span class="si">%s</span><span class="s2"> not supported for particle </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">Is</span><span class="p">),</span> <span class="n">particle</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">datas</span> <span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">datas</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">941</span><span class="p">,</span> <span class="mi">942</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">excludeAverageProductData</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">13</span> <span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">continue</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">7</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">S</span> <span class="o">==</span> <span class="mi">7</span> <span class="p">)</span> <span class="p">:</span> 
                        <span class="n">particle</span><span class="o">.</span><span class="n">addAttribute</span><span class="p">(</span> <span class="s1">&#39;emissionMode&#39;</span><span class="p">,</span> <span class="n">gnds</span><span class="o">.</span><span class="n">tokens</span><span class="o">.</span><span class="n">delayedToken</span><span class="p">)</span>
                        <span class="n">particle</span><span class="o">.</span><span class="n">addAttribute</span><span class="p">(</span> <span class="s1">&#39;decayRate&#39;</span><span class="p">,</span> <span class="n">PQUModule</span><span class="o">.</span><span class="n">PQU</span><span class="p">(</span> <span class="n">PQUModule</span><span class="o">.</span><span class="n">pqu_float</span><span class="o">.</span><span class="n">surmiseSignificantDigits</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">getX1</span><span class="p">(</span> <span class="p">)</span> <span class="p">),</span> <span class="s2">&quot;1/s&quot;</span> <span class="p">)</span> <span class="p">)</span>
                    <span class="k">else</span> <span class="p">:</span>
                        <span class="n">particle</span><span class="o">.</span><span class="n">addAttribute</span><span class="p">(</span> <span class="s1">&#39;emissionMode&#39;</span><span class="p">,</span> <span class="n">gnds</span><span class="o">.</span><span class="n">tokens</span><span class="o">.</span><span class="n">promptToken</span><span class="p">)</span>
                <span class="n">interpolation</span> <span class="o">=</span> <span class="n">getXYInterpolation</span><span class="p">(</span> <span class="n">data</span> <span class="p">)</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span> 
                    <span class="n">axes</span> <span class="o">=</span> <span class="n">multiplicityAxes</span>
                    <span class="n">particle</span><span class="o">.</span><span class="n">multiplicity</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span> <span class="p">)</span>
                    <span class="n">particle</span><span class="o">.</span><span class="n">multiplicity</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">multiplicityModule</span><span class="o">.</span><span class="n">XYs1d</span><span class="p">(</span> <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> 
                            <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="p">,</span> <span class="n">interpolation</span> <span class="o">=</span> <span class="n">interpolation</span> <span class="p">)</span> <span class="p">)</span>
                <span class="k">else</span> <span class="p">:</span>          <span class="c1"># for I = 10 and 13</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">10</span> <span class="p">)</span> <span class="p">:</span>
                        <span class="n">axes</span> <span class="o">=</span> <span class="n">energyDepositionAxes</span>
                        <span class="n">dataForm</span> <span class="o">=</span> <span class="n">energyDepositionModule</span><span class="o">.</span><span class="n">XYs1d</span><span class="p">(</span> <span class="n">label</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="p">,</span> 
                                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">interpolation</span> <span class="o">=</span> <span class="n">interpolation</span> <span class="p">)</span>
                        <span class="n">particle</span><span class="o">.</span><span class="n">energyDeposition</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">dataForm</span> <span class="p">)</span>
                    <span class="k">elif</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">13</span> <span class="p">)</span> <span class="p">:</span>
                        <span class="n">axes</span> <span class="o">=</span> <span class="n">momentumDepositionAxes</span>
                        <span class="n">dataForm</span> <span class="o">=</span> <span class="n">momentumDepositionModule</span><span class="o">.</span><span class="n">XYs1d</span><span class="p">(</span> <span class="n">label</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="p">,</span> 
                                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">interpolation</span> <span class="o">=</span> <span class="n">interpolation</span> <span class="p">)</span>
                        <span class="n">particle</span><span class="o">.</span><span class="n">momentumDeposition</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">dataForm</span> <span class="p">)</span>
                <span class="k">del</span> <span class="n">datas</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

        <span class="k">if</span><span class="p">(</span> <span class="ow">not</span> <span class="n">form</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> <span class="n">particle</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">form</span> <span class="p">)</span>

        <span class="k">return</span><span class="p">(</span> <span class="n">doubleDifferentialCrossSectionForm</span> <span class="p">)</span>

    <span class="k">def</span> <span class="nf">addRecoilDistributionAndRemove</span><span class="p">(</span> <span class="n">particle</span><span class="p">,</span> <span class="n">recoilPartner</span><span class="p">,</span> <span class="n">yo</span><span class="p">,</span> <span class="n">yosDatas</span><span class="p">,</span> <span class="p">)</span> <span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        For 2-body reactions involving two light products, ENDL explicitly stores distributions for both</span>
<span class="sd">        rather than computing one as the recoil of the other. When translating, discard the 2nd distribution</span>
<span class="sd">        and store it as &#39;recoil&#39; instead.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">yo</span> <span class="ow">in</span> <span class="n">yosDatas</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">yosDatas</span><span class="p">[</span><span class="n">yo</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">1</span>
            <span class="n">yosDatas</span><span class="p">[</span><span class="n">yo</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">productFrame</span> <span class="o">=</span> <span class="n">standardsModule</span><span class="o">.</span><span class="n">frames</span><span class="o">.</span><span class="n">centerOfMassToken</span>
        <span class="n">subform</span> <span class="o">=</span> <span class="n">angularModule</span><span class="o">.</span><span class="n">recoil</span><span class="p">(</span> <span class="n">link</span> <span class="o">=</span> <span class="n">recoilPartner</span><span class="o">.</span><span class="n">distribution</span><span class="p">[</span><span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">]</span> <span class="p">)</span>
        <span class="n">form</span> <span class="o">=</span> <span class="n">angularModule</span><span class="o">.</span><span class="n">twoBodyForm</span><span class="p">(</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">productFrame</span><span class="p">,</span> <span class="n">subform</span> <span class="p">)</span>
        <span class="n">particle</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">form</span> <span class="p">)</span>

    <span class="k">def</span> <span class="nf">makeNBodyChannelFrom_mYos</span><span class="p">(</span> <span class="n">channelClass</span><span class="p">,</span> <span class="n">mYos</span><span class="p">,</span> <span class="n">ZAsYos</span><span class="p">,</span> <span class="n">yosDatas</span><span class="p">,</span> <span class="n">Q_MeV</span><span class="p">,</span> <span class="n">crossSection</span><span class="p">,</span>
            <span class="n">specialCase</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">decayChannelInfo</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">levelIndex</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">process</span> <span class="o">=</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This routine does not support yo&#39;s (including the residual) in an excited state. This is consistent with endl99.</span>
<span class="sd">        This routine does not work if decayChannelInfo has data (see note Note_Be_9) due to added gndsPath logic (gndsPath has been</span>
<span class="sd">        removed and may be so should this last sentence).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="nb">hasattr</span><span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;specialCase&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">specialCase</span> <span class="o">=</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">specialCase</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">specialCase</span> <span class="o">==</span> <span class="s1">&#39;Am_242_m1&#39;</span> <span class="p">)</span> <span class="p">:</span> <span class="n">level</span> <span class="o">=</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">level</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">specialCase</span> <span class="o">==</span> <span class="s1">&#39;Sc_45_m1&#39;</span> <span class="p">)</span> <span class="p">:</span> <span class="n">level</span> <span class="o">=</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">level</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
        <span class="n">channel</span> <span class="o">=</span> <span class="n">channelClass</span><span class="p">(</span> <span class="n">process</span> <span class="o">=</span> <span class="n">process</span> <span class="p">)</span>
        <span class="n">channel</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">returnConstantQ</span><span class="p">(</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">Q_MeV</span><span class="p">,</span> <span class="n">crossSection</span> <span class="p">)</span> <span class="p">)</span>
        <span class="n">i1</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">n1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span> <span class="n">mYos</span> <span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

        <span class="k">try</span> <span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">mYos</span><span class="o">.</span><span class="n">index</span><span class="p">(</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4008</span> <span class="p">]</span> <span class="p">)</span>
        <span class="k">except</span> <span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">index</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2004</span> <span class="p">]</span> <span class="ow">in</span> <span class="n">mYos</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">mYos</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2004</span> <span class="p">]</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="mi">6</span> <span class="ow">in</span> <span class="n">yosDatas</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="mi">16</span> <span class="ow">in</span> <span class="n">yosDatas</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="n">mYos</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2004</span> <span class="p">]</span>
                    <span class="n">mYos</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span> <span class="n">index</span><span class="p">,</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2004</span> <span class="p">]</span> <span class="p">)</span>
                <span class="k">else</span> <span class="p">:</span>
                    <span class="n">mYos</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2004</span> <span class="p">]</span>

        <span class="n">He4_counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">ZA</span> <span class="ow">in</span> <span class="n">mYos</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">ZA</span> <span class="o">==</span> <span class="mi">2004</span> <span class="p">)</span> <span class="p">:</span> <span class="n">He4_counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">decayChannel</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">decayChannelInfo</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">decayChannelInfo</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">i1</span> <span class="p">)</span> <span class="p">:</span> <span class="n">decayChannel</span> <span class="o">=</span> <span class="n">decayChannelInfo</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">m</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">particle</span> <span class="o">=</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">newGNDSParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">ZA</span> <span class="p">),</span> <span class="n">crossSection</span><span class="p">,</span>
                        <span class="n">multiplicity</span> <span class="o">=</span> <span class="n">m</span><span class="p">,</span> <span class="n">outputChannel</span> <span class="o">=</span> <span class="n">decayChannel</span> <span class="p">)</span>
            <span class="k">elif</span><span class="p">(</span> <span class="p">(</span> <span class="n">specialCase</span> <span class="o">==</span> <span class="s1">&#39;Am_242_m1&#39;</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">ZA</span> <span class="o">==</span> <span class="mi">95242</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">particle</span> <span class="o">=</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">newGNDSParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span>
                        <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">ZA</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="n">level</span><span class="p">,</span> <span class="n">levelIndex</span> <span class="o">=</span> <span class="mi">2</span> <span class="p">),</span>
                        <span class="n">crossSection</span><span class="p">,</span> <span class="n">outputChannel</span> <span class="o">=</span> <span class="n">decayChannel</span> <span class="p">)</span>
            <span class="k">elif</span><span class="p">(</span> <span class="p">(</span> <span class="n">specialCase</span> <span class="o">==</span> <span class="s1">&#39;Sc_45_m1&#39;</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">ZA</span> <span class="o">==</span> <span class="mi">21046</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">particle</span> <span class="o">=</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">newGNDSParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span>
                        <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">ZA</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="n">level</span><span class="p">,</span> <span class="n">levelIndex</span> <span class="o">=</span> <span class="mi">2</span> <span class="p">),</span>
                        <span class="n">crossSection</span><span class="p">,</span> <span class="n">outputChannel</span> <span class="o">=</span> <span class="n">decayChannel</span> <span class="p">)</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="n">particle</span> <span class="o">=</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">newGNDSParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">ZA</span> <span class="p">),</span> <span class="n">crossSection</span><span class="p">,</span>
                        <span class="n">outputChannel</span> <span class="o">=</span> <span class="n">decayChannel</span> <span class="p">)</span>
            <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39; + &#39;</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">ZA</span> <span class="ow">in</span> <span class="n">ZAsYos</span> <span class="p">)</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="n">specialCase</span> <span class="o">==</span> <span class="s1">&#39;S8&#39;</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">ZA</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="n">yo</span> <span class="o">=</span> <span class="mi">11</span>
                <span class="k">else</span> <span class="p">:</span>
                    <span class="n">yo</span> <span class="o">=</span> <span class="n">ZAsYos</span><span class="p">[</span><span class="n">ZA</span><span class="p">]</span>
                    <span class="n">ICounter</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">yosDatas</span><span class="p">[</span><span class="n">yo</span><span class="p">]</span> <span class="p">:</span>
                        <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="p">)</span> <span class="p">:</span> <span class="n">ICounter</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">ICounter</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>
                        <span class="k">if</span><span class="p">(</span> <span class="n">yo</span> <span class="o">==</span> <span class="mi">6</span> <span class="p">)</span> <span class="ow">and</span> <span class="kc">False</span> <span class="p">:</span>
                            <span class="k">if</span><span class="p">(</span> <span class="n">He4_counter</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">)</span> <span class="p">:</span> <span class="n">yo</span> <span class="o">+=</span> <span class="mi">10</span>
                        <span class="k">else</span> <span class="p">:</span>
                            <span class="n">yo</span> <span class="o">+=</span> <span class="mi">10</span>
                <span class="n">addDistributionDataAndRemove</span><span class="p">(</span> <span class="n">particle</span><span class="p">,</span> <span class="n">yo</span><span class="p">,</span> <span class="n">yosDatas</span><span class="p">,</span> <span class="n">crossSection</span> <span class="p">)</span>
            <span class="n">channel</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">channel</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">uniqueLabel</span><span class="p">(</span> <span class="n">particle</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">i1</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">return</span><span class="p">(</span> <span class="n">channel</span> <span class="p">)</span>

    <span class="n">isThermalNeutronScatteringLaw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ZA</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">1801</span><span class="p">,</span> <span class="mi">1901</span><span class="p">,</span> <span class="mi">1902</span><span class="p">,</span> <span class="mi">4809</span><span class="p">,</span> <span class="mi">4909</span><span class="p">,</span> <span class="mi">6912</span><span class="p">,</span> <span class="mi">8916</span> <span class="p">]</span>
    <span class="n">targetZA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ZA</span>
    <span class="n">targetName</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">isThermalNeutronScatteringLaw</span> <span class="p">)</span> <span class="p">:</span>
        <span class="n">targetZA</span> <span class="o">-=</span> <span class="mi">800</span>
        <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">ZA</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">1901</span><span class="p">,</span> <span class="mi">1902</span><span class="p">,</span> <span class="mi">4909</span><span class="p">,</span> <span class="mi">6912</span><span class="p">,</span> <span class="mi">8916</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span> <span class="n">targetZA</span> <span class="o">-=</span> <span class="mi">100</span>
        <span class="n">targetName</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">1801</span> <span class="p">:</span> <span class="s2">&quot;H1_inH2O_TNSL&quot;</span><span class="p">,</span>       <span class="mi">1901</span> <span class="p">:</span> <span class="s2">&quot;H1_inCH2_TNSL&quot;</span><span class="p">,</span>    <span class="mi">1902</span> <span class="p">:</span> <span class="s2">&quot;H2_inD2O_TNSL&quot;</span><span class="p">,</span>
                       <span class="mi">4809</span> <span class="p">:</span> <span class="s2">&quot;Be9_inBeMetal_TNSL&quot;</span><span class="p">,</span>  <span class="mi">4909</span> <span class="p">:</span> <span class="s2">&quot;Be9_inBeO_TNSL&quot;</span><span class="p">,</span>   <span class="mi">6912</span> <span class="p">:</span> <span class="s2">&quot;C12_inGraphite_TNSL&quot;</span><span class="p">,</span> <span class="mi">8916</span> <span class="p">:</span> <span class="s2">&quot;O16_inBeO_TNSL&quot;</span> <span class="p">}[</span><span class="bp">self</span><span class="o">.</span><span class="n">ZA</span><span class="p">]</span>

        <span class="n">I0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findData</span><span class="p">(</span> <span class="n">C</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">I</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">)</span>
        <span class="k">for</span> <span class="n">energy</span><span class="p">,</span> <span class="n">xSec</span> <span class="ow">in</span> <span class="n">I0</span><span class="o">.</span><span class="n">data</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">xSec</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="k">break</span>
            <span class="n">TNSL_EMax</span> <span class="o">=</span> <span class="n">energy</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">targetZA</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">95241</span><span class="p">,</span> <span class="mi">21045</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
        <span class="n">I0s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findDatas</span><span class="p">(</span> <span class="n">C</span> <span class="o">=</span> <span class="mi">46</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">I</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">I0s</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">I0m1</span><span class="p">,</span> <span class="n">I0g</span> <span class="o">=</span> <span class="n">I0s</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">I0m1</span><span class="o">.</span><span class="n">getQ</span><span class="p">(</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="n">I0g</span><span class="o">.</span><span class="n">getQ</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">I0m1</span><span class="p">,</span> <span class="n">I0g</span> <span class="o">=</span> <span class="n">I0g</span><span class="p">,</span> <span class="n">I0m1</span>
            <span class="n">level</span> <span class="o">=</span> <span class="n">I0g</span><span class="o">.</span><span class="n">getQ</span><span class="p">(</span> <span class="p">)</span> <span class="o">-</span> <span class="n">I0m1</span><span class="o">.</span><span class="n">getQ</span><span class="p">(</span> <span class="p">)</span>
            <span class="n">dataM1s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findDatas</span><span class="p">(</span> <span class="n">C</span> <span class="o">=</span> <span class="mi">46</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">I0m1</span><span class="o">.</span><span class="n">getQ</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span>
            <span class="k">for</span> <span class="n">dataM1</span> <span class="ow">in</span> <span class="n">dataM1s</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">targetZA</span> <span class="o">==</span> <span class="mi">95241</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="n">dataM1</span><span class="o">.</span><span class="n">specialCase</span> <span class="o">=</span> <span class="s1">&#39;Am_242_m1&#39;</span>
                <span class="k">else</span> <span class="p">:</span>
                    <span class="n">dataM1</span><span class="o">.</span><span class="n">specialCase</span> <span class="o">=</span> <span class="s1">&#39;Sc_45_m1&#39;</span>
                <span class="n">dataM1</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="n">level</span>

    <span class="n">styleName</span> <span class="o">=</span> <span class="s1">&#39;eval&#39;</span>
    <span class="n">yosDatas</span> <span class="o">=</span> <span class="p">{</span>  <span class="mi">0</span> <span class="p">:</span> <span class="p">[],</span>  <span class="mi">1</span> <span class="p">:</span> <span class="p">[],</span>  <span class="mi">2</span> <span class="p">:</span> <span class="p">[],</span>  <span class="mi">3</span> <span class="p">:</span> <span class="p">[],</span>  <span class="mi">4</span> <span class="p">:</span> <span class="p">[],</span>  <span class="mi">5</span> <span class="p">:</span> <span class="p">[],</span>  <span class="mi">6</span> <span class="p">:</span> <span class="p">[],</span>  <span class="mi">7</span> <span class="p">:</span> <span class="p">[],</span>  <span class="mi">8</span> <span class="p">:</span> <span class="p">[],</span>  <span class="mi">9</span> <span class="p">:</span> <span class="p">[],</span>
                     <span class="mi">10</span> <span class="p">:</span> <span class="p">[],</span> <span class="mi">11</span> <span class="p">:</span> <span class="p">[],</span> <span class="mi">12</span> <span class="p">:</span> <span class="p">[],</span> <span class="mi">13</span> <span class="p">:</span> <span class="p">[],</span> <span class="mi">14</span> <span class="p">:</span> <span class="p">[],</span> <span class="mi">15</span> <span class="p">:</span> <span class="p">[],</span> <span class="mi">16</span> <span class="p">:</span> <span class="p">[],</span> <span class="mi">17</span> <span class="p">:</span> <span class="p">[],</span> <span class="mi">18</span> <span class="p">:</span> <span class="p">[],</span> <span class="mi">19</span> <span class="p">:</span> <span class="p">[]</span> <span class="p">}</span>
    <span class="n">yosZAs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">yo</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">17</span> <span class="p">)</span> <span class="p">:</span> <span class="n">yosZAs</span><span class="p">[</span><span class="n">yo</span><span class="p">]</span> <span class="o">=</span> <span class="n">endl2</span><span class="o">.</span><span class="n">yoToZA</span><span class="p">(</span> <span class="n">yo</span> <span class="p">)</span>
    <span class="n">ZAsYos</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">yo</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span> <span class="p">)</span> <span class="p">:</span> <span class="n">ZAsYos</span><span class="p">[</span><span class="n">endl2</span><span class="o">.</span><span class="n">yoToZA</span><span class="p">(</span> <span class="n">yo</span> <span class="p">)]</span> <span class="o">=</span> <span class="n">yo</span>
    <span class="n">ZAsYos</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mi">7</span>
    <span class="n">ENDLCS_To_ENDFMT</span> <span class="o">=</span> <span class="n">endf_endl</span><span class="o">.</span><span class="n">ENDLCS_To_ENDFMT</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">projectileName</span> <span class="p">)</span>

    <span class="n">level</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">I0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findDatas</span><span class="p">(</span> <span class="n">I</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">getELevel</span><span class="p">(</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="n">level</span> <span class="o">=</span> <span class="n">I0</span><span class="o">.</span><span class="n">getELevel</span><span class="p">(</span> <span class="p">)</span>

    <span class="n">info</span> <span class="o">=</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">infos</span><span class="p">(</span> <span class="n">styleName</span> <span class="p">)</span>
    <span class="n">info</span><span class="o">.</span><span class="n">PoPsLabel</span> <span class="o">=</span> <span class="n">styleName</span>
    <span class="n">info</span><span class="o">.</span><span class="n">PoPs</span> <span class="o">=</span> <span class="n">databasePoPsModule</span><span class="o">.</span><span class="n">database</span><span class="p">(</span> <span class="s1">&#39;protare_internal&#39;</span><span class="p">,</span> <span class="s1">&#39;1.0&#39;</span> <span class="p">)</span>
    <span class="n">info</span><span class="o">.</span><span class="n">ENDFconversionFlags</span> <span class="o">=</span> <span class="n">ENDFconversionFlagsModule</span><span class="o">.</span><span class="n">ENDFconversionFlags</span><span class="p">()</span>

    <span class="n">projectile</span> <span class="o">=</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">endl2</span><span class="o">.</span><span class="n">yoToZA</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">yi</span> <span class="p">)</span> <span class="p">)</span>

    <span class="n">inelasticC</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">1</span> <span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">2</span> <span class="p">:</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">3</span> <span class="p">:</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">4</span> <span class="p">:</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">5</span> <span class="p">:</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">6</span> <span class="p">:</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">7</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span> <span class="p">}[</span><span class="bp">self</span><span class="o">.</span><span class="n">yi</span><span class="p">]</span>
    <span class="n">CsAndSs</span><span class="p">,</span> <span class="n">residualExcitationIndexLevels</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{}</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">level</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> <span class="n">residualExcitationIndexLevels</span><span class="p">[</span><span class="n">targetZA</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span> <span class="kc">None</span><span class="p">,</span> <span class="n">level</span> <span class="p">]</span> <span class="p">]</span>
    <span class="n">reactionsDatas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findReactionsDatas</span><span class="p">(</span> <span class="p">)</span>
    <span class="k">if</span><span class="p">(</span> <span class="mi">1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">CList</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">reactionsDatas</span> <span class="o">+=</span> <span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">findDatas</span><span class="p">(</span> <span class="n">C</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">]</span>
    <span class="n">compoundZA</span> <span class="o">=</span> <span class="n">endl2</span><span class="o">.</span><span class="n">yoToZA</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">yi</span> <span class="p">)</span> <span class="o">+</span> <span class="n">targetZA</span>

    <span class="k">for</span> <span class="n">reactionDatas</span> <span class="ow">in</span> <span class="n">reactionsDatas</span> <span class="p">:</span>               <span class="c1"># Determine a unique set of levels for excited residuals.</span>
        <span class="n">C</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="n">reactionDatas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">C</span><span class="p">,</span> <span class="n">reactionDatas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">S</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">C</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">CsAndSs</span> <span class="p">)</span> <span class="p">:</span> <span class="n">CsAndSs</span><span class="p">[</span><span class="n">C</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">S</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">CsAndSs</span><span class="p">[</span><span class="n">C</span><span class="p">]</span> <span class="p">)</span> <span class="p">:</span> <span class="n">CsAndSs</span><span class="p">[</span><span class="n">C</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">S</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">S</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">yos</span> <span class="o">=</span> <span class="n">endl_C</span><span class="o">.</span><span class="n">endl_C_yoInfo</span><span class="p">(</span> <span class="n">C</span> <span class="p">)</span>
            <span class="n">residualZA</span> <span class="o">=</span> <span class="n">compoundZA</span> <span class="o">-</span> <span class="n">yos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">residualZA</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">residualExcitationIndexLevels</span> <span class="p">)</span> <span class="p">:</span> <span class="n">residualExcitationIndexLevels</span><span class="p">[</span><span class="n">residualZA</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">residualExcitationIndexLevels</span><span class="p">[</span><span class="n">residualZA</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">[</span> <span class="kc">None</span><span class="p">,</span> <span class="n">reactionDatas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">X1</span> <span class="p">]</span> <span class="p">)</span>
    <span class="k">for</span> <span class="n">residualZA</span> <span class="ow">in</span> <span class="n">residualExcitationIndexLevels</span> <span class="p">:</span>
        <span class="n">residualExcitationIndexLevels</span><span class="p">[</span><span class="n">residualZA</span><span class="p">]</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span> <span class="p">)</span>
        <span class="n">indexLevels</span><span class="p">,</span> <span class="n">indexOffset</span> <span class="o">=</span> <span class="p">{},</span> <span class="mi">1</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">residualExcitationIndexLevels</span><span class="p">[</span><span class="n">residualZA</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="n">indexOffset</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># Should only happend for meta-stable targets.</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">indexAndLevel</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="n">residualExcitationIndexLevels</span><span class="p">[</span><span class="n">residualZA</span><span class="p">]</span> <span class="p">)</span> <span class="p">:</span> 
            <span class="n">indexLevel</span> <span class="o">=</span> <span class="n">index</span> <span class="o">+</span> <span class="n">indexOffset</span>
            <span class="n">indexLevels</span><span class="p">[</span><span class="n">indexAndLevel</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">indexLevel</span>
        <span class="n">residualExcitationIndexLevels</span><span class="p">[</span><span class="n">residualZA</span><span class="p">]</span> <span class="o">=</span> <span class="n">indexLevels</span>

    <span class="n">levelIndex</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">level</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> <span class="n">levelIndex</span> <span class="o">=</span> <span class="n">residualExcitationIndexLevels</span><span class="p">[</span><span class="n">targetZA</span><span class="p">][</span><span class="n">level</span><span class="p">]</span>
    <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">yi</span> <span class="o">==</span> <span class="mi">7</span> <span class="p">)</span> <span class="p">:</span>
        <span class="n">targetZ</span> <span class="o">=</span> <span class="n">targetZA</span> <span class="o">//</span> <span class="mi">1000</span>
        <span class="n">targetID</span> <span class="o">=</span> <span class="n">chemicalElementMiscPoPsModule</span><span class="o">.</span><span class="n">symbolFromZ</span><span class="p">[</span><span class="n">targetZ</span><span class="p">]</span>
        <span class="n">targetName</span> <span class="o">=</span> <span class="n">chemicalElementMiscPoPsModule</span><span class="o">.</span><span class="n">nameFromZ</span><span class="p">[</span><span class="n">targetZ</span><span class="p">]</span>
        <span class="n">info</span><span class="o">.</span><span class="n">PoPs</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">chemicalElementPoPsModule</span><span class="o">.</span><span class="n">chemicalElement</span><span class="p">(</span> <span class="n">targetID</span><span class="p">,</span> <span class="n">targetZ</span><span class="p">,</span> <span class="n">targetName</span> <span class="p">)</span> <span class="p">)</span>
        <span class="n">info</span><span class="o">.</span><span class="n">targetID</span> <span class="o">=</span> <span class="n">targetID</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="n">target</span> <span class="o">=</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">targetZA</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="n">targetName</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="n">level</span><span class="p">,</span> <span class="n">levelIndex</span> <span class="o">=</span> <span class="n">levelIndex</span> <span class="p">)</span>
        <span class="n">info</span><span class="o">.</span><span class="n">targetID</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">id</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">levelIndex</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">):</span>
        <span class="n">metastableIndex</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># FIXME can this be read from ENDL instead?</span>
        <span class="n">aliasName</span> <span class="o">=</span> <span class="n">PoPsAliasModule</span><span class="o">.</span><span class="n">metaStable</span><span class="o">.</span><span class="n">metaStableNameFromNuclearLevelNameAndMetaStableIndex</span><span class="p">(</span> <span class="n">target</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">metastableIndex</span> <span class="p">)</span>
        <span class="n">info</span><span class="o">.</span><span class="n">PoPs</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">PoPsAliasModule</span><span class="o">.</span><span class="n">metaStable</span><span class="p">(</span> <span class="n">aliasName</span><span class="p">,</span> <span class="n">target</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">metastableIndex</span> <span class="p">)</span> <span class="p">)</span>
        <span class="n">info</span><span class="o">.</span><span class="n">targetID</span> <span class="o">=</span> <span class="n">aliasName</span>

    <span class="n">maxDate</span> <span class="o">=</span> <span class="mi">19590101</span>
    <span class="n">allData</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findDatas</span><span class="p">(</span> <span class="p">)</span>
    <span class="k">for</span> <span class="n">oneDatum</span> <span class="ow">in</span> <span class="n">allData</span> <span class="p">:</span>
        <span class="k">if</span><span class="p">(</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">oneDatum</span><span class="o">.</span><span class="n">yo</span> <span class="o">&lt;=</span> <span class="mi">16</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">oneDatum</span><span class="o">.</span><span class="n">I</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">92</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span> <span class="k">continue</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">oneDatum</span><span class="o">.</span><span class="n">I</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">20</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">date</span> <span class="o">=</span> <span class="n">oneDatum</span><span class="o">.</span><span class="n">getDate</span><span class="p">(</span> <span class="p">)</span> <span class="o">+</span> <span class="mi">19</span> <span class="o">*</span> <span class="mi">1000000</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">date</span> <span class="o">&lt;</span> <span class="mi">600000</span> <span class="p">)</span> <span class="p">:</span> <span class="n">date</span> <span class="o">+=</span> <span class="mi">1000000</span>   <span class="c1"># Must treat dates after 2000 different then those before (600000 is arbitrary).</span>
                <span class="n">maxDate</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span> <span class="n">date</span><span class="p">,</span> <span class="n">maxDate</span> <span class="p">)</span>
    <span class="n">maxDate</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span> <span class="n">maxDate</span> <span class="p">)</span>
    <span class="n">maxDate</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">maxDate</span><span class="p">[:</span><span class="mi">4</span><span class="p">],</span> <span class="n">maxDate</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">],</span> <span class="n">maxDate</span><span class="p">[</span><span class="mi">6</span><span class="p">:]</span> <span class="p">)</span>
    <span class="n">projectileDomain</span> <span class="o">=</span> <span class="n">gnds</span><span class="o">.</span><span class="n">styles</span><span class="o">.</span><span class="n">projectileEnergyDomain</span><span class="p">(</span> <span class="mf">1e-11</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;MeV&#39;</span> <span class="p">)</span>  <span class="c1"># will be overwritten after parsing all reactions</span>
    <span class="n">evaluatedStyle</span> <span class="o">=</span> <span class="n">gnds</span><span class="o">.</span><span class="n">styles</span><span class="o">.</span><span class="n">evaluated</span><span class="p">(</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
            <span class="n">physicalQuantityModule</span><span class="o">.</span><span class="n">temperature</span><span class="p">(</span> <span class="n">PQUModule</span><span class="o">.</span><span class="n">pqu_float</span><span class="o">.</span><span class="n">surmiseSignificantDigits</span><span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">getTemperature</span><span class="p">(</span> <span class="p">)</span> <span class="p">),</span> <span class="s1">&#39;MeV/k&#39;</span> <span class="p">),</span>
            <span class="n">projectileDomain</span><span class="p">,</span>
            <span class="n">evaluationLibrary</span><span class="p">,</span> <span class="n">evaluationVersion</span><span class="p">,</span> <span class="n">date</span> <span class="o">=</span> <span class="n">maxDate</span> <span class="p">)</span>

    <span class="n">evaluation</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">-</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">evaluationLibrary</span><span class="p">,</span> <span class="n">evaluationVersion</span> <span class="p">)</span>
    <span class="n">reactionSuite</span> <span class="o">=</span> <span class="n">reactionSuiteModule</span><span class="o">.</span><span class="n">reactionSuite</span><span class="p">(</span> <span class="n">projectile</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">info</span><span class="o">.</span><span class="n">targetID</span><span class="p">,</span> <span class="n">evaluation</span><span class="p">,</span>
            <span class="n">style</span> <span class="o">=</span> <span class="n">evaluatedStyle</span><span class="p">,</span> <span class="n">PoPs</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">PoPs</span> <span class="p">)</span>
    <span class="n">info</span><span class="o">.</span><span class="n">PoPs</span> <span class="o">=</span> <span class="n">reactionSuite</span><span class="o">.</span><span class="n">PoPs</span>
    <span class="n">info</span><span class="o">.</span><span class="n">reactionSuite</span> <span class="o">=</span> <span class="n">reactionSuite</span>

    <span class="n">I20s</span> <span class="o">=</span> <span class="p">[]</span>                                           <span class="c1"># Some I20 data has bad Q values, so let&#39;s ignore all I20 data.</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">reactionDatas</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="n">reactionsDatas</span> <span class="p">)</span> <span class="p">:</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">reactionData</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="n">reactionDatas</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">reactionData</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">20</span> <span class="p">)</span> <span class="p">:</span> <span class="n">I20s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">[</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="p">]</span> <span class="p">)</span>
    <span class="n">I20s</span><span class="o">.</span><span class="n">reverse</span><span class="p">(</span> <span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">I20s</span> <span class="p">:</span>
        <span class="k">del</span> <span class="n">reactionsDatas</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
        <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">reactionsDatas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="k">del</span> <span class="n">reactionsDatas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="n">channelList</span><span class="p">,</span> <span class="n">delayedNeutrons</span><span class="p">,</span> <span class="n">c55s</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">{},</span> <span class="p">[]</span>
    <span class="n">iChannel</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">reactionDatas</span> <span class="ow">in</span> <span class="n">reactionsDatas</span> <span class="p">:</span>
        <span class="n">doubleDifferentialCrossSectionForm</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">C</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="n">reactionDatas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">C</span><span class="p">,</span> <span class="n">reactionDatas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">S</span>   <span class="c1"># Phase 1</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">S</span> <span class="o">==</span> <span class="mi">91</span> <span class="p">)</span> <span class="p">:</span> <span class="k">continue</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">isThermalNeutronScatteringLaw</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="n">C</span><span class="p">,</span> <span class="n">S</span> <span class="p">)</span> <span class="o">!=</span> <span class="p">(</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">continue</span>
            <span class="n">I0</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">reactionData</span> <span class="ow">in</span> <span class="n">reactionDatas</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">reactionData</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="n">I0</span> <span class="o">=</span> <span class="n">reactionData</span>
            <span class="k">if</span><span class="p">(</span> <span class="mf">0.9e-12</span> <span class="o">&lt;</span> <span class="n">I0</span><span class="o">.</span><span class="n">getX1</span><span class="p">(</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="mf">2.1e-12</span> <span class="p">)</span> <span class="p">:</span> <span class="k">continue</span>
        <span class="n">channelProcess</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">S</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="mi">1</span> <span class="ow">in</span> <span class="n">CsAndSs</span><span class="p">[</span><span class="n">C</span><span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">channelProcess</span> <span class="o">=</span> <span class="n">channelsModule</span><span class="o">.</span><span class="n">processes</span><span class="o">.</span><span class="n">continuum</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">C</span> <span class="o">==</span> <span class="n">inelasticC</span> <span class="p">)</span> <span class="p">:</span> <span class="n">channelProcess</span> <span class="o">=</span> <span class="n">channelsModule</span><span class="o">.</span><span class="n">processes</span><span class="o">.</span><span class="n">continuum</span>
        <span class="n">I0</span><span class="p">,</span> <span class="n">I12</span><span class="p">,</span> <span class="n">I20</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
        <span class="n">specialCase</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">yo</span> <span class="ow">in</span> <span class="n">yosDatas</span> <span class="p">:</span> <span class="n">yosDatas</span><span class="p">[</span><span class="n">yo</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">I942Present</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">reactionDatas</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">942</span> <span class="p">)</span> <span class="p">:</span> <span class="n">I942Present</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">I942Present</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">for</span> <span class="n">i1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">reactionDatas</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">reactionDatas</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">4</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="k">del</span> <span class="n">reactionDatas</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                    <span class="k">break</span>

        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">reactionDatas</span> <span class="p">:</span>                         <span class="c1"># yosDatas should only contain I = 1, 3, 4, 7, 9, 10 and 13 type data.</span>
            <span class="n">data</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="p">(</span> <span class="n">endlmisc</span><span class="o">.</span><span class="n">getNumberOfColumns_</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span><span class="p">,</span> <span class="s1">&#39;&#39;</span> <span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">,&#39;</span> <span class="o">%</span> <span class="n">standardsModule</span><span class="o">.</span><span class="n">frames</span><span class="o">.</span><span class="n">labToken</span> <span class="p">)</span> <span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">S</span> <span class="o">==</span> <span class="mi">7</span> <span class="p">)</span> <span class="p">:</span>                             <span class="c1"># Special treatment for delayed neutron data.</span>
                <span class="n">decayRate</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">getX1</span><span class="p">(</span> <span class="p">)</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">decayRate</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">delayedNeutrons</span> <span class="p">)</span> <span class="p">:</span> <span class="n">delayedNeutrons</span><span class="p">[</span><span class="n">decayRate</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">delayedNeutrons</span><span class="p">[</span><span class="n">decayRate</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">data</span> <span class="p">)</span>
                <span class="k">continue</span>
            <span class="k">if</span><span class="p">(</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">data</span><span class="o">.</span><span class="n">yo</span> <span class="o">&lt;=</span> <span class="mi">16</span> <span class="p">)</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">92</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span> <span class="k">continue</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="n">I0</span> <span class="o">=</span> <span class="n">data</span>
                <span class="k">elif</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">11</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">elif</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">12</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="n">I12</span> <span class="o">=</span> <span class="n">data</span>
                <span class="k">elif</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">20</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="n">I20</span> <span class="o">=</span> <span class="n">data</span>
                <span class="k">elif</span><span class="p">(</span> <span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">yo</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">13</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">else</span> <span class="p">:</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">941</span><span class="p">,</span> <span class="mi">942</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s1">&#39;I = </span><span class="si">%d</span><span class="s1"> data not currently supported&#39;</span> <span class="o">%</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="p">)</span>
                    <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">S</span> <span class="o">==</span> <span class="mi">8</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">yo</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">4</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">C</span> <span class="o">==</span> <span class="mi">12</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>   <span class="c1"># This should only be for endl n+d-&gt;2n+p</span>
                        <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">ZA</span> <span class="o">!=</span> <span class="mi">1002</span> <span class="p">)</span> <span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s1">&#39;S = 8, yo = 1, I = 4 only supported for ZA = 1002&#39;</span> <span class="p">)</span>
                        <span class="n">yosDatas</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">yo</span> <span class="o">+</span> <span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">data</span> <span class="p">)</span>
                        <span class="n">specialCase</span> <span class="o">=</span> <span class="s1">&#39;S8&#39;</span>
                    <span class="k">else</span> <span class="p">:</span>
                        <span class="n">yosDatas</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">yo</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">data</span> <span class="p">)</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s1">&#39;Unsupported yo = </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">data</span><span class="o">.</span><span class="n">yo</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">specialCase</span> <span class="o">==</span> <span class="s1">&#39;S8&#39;</span> <span class="p">)</span> <span class="p">:</span>                         <span class="c1"># May need to add I = 10 data to yo = 11 and readjust yo = 1&#39;s I = 10 data.</span>
            <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">I10Present</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="p">:</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">10</span> <span class="p">)</span> <span class="p">:</span> <span class="n">I10Present</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span><span class="p">(</span> <span class="ow">not</span> <span class="n">I10Present</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="n">yo1I10</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">:</span>
                        <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">10</span> <span class="p">)</span> <span class="p">:</span> <span class="n">yo1I10</span> <span class="o">=</span> <span class="n">data</span>
                    <span class="n">yo12I10</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="p">:</span>
                        <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">10</span> <span class="p">)</span> <span class="p">:</span> <span class="n">yo12I10</span> <span class="o">=</span> <span class="n">data</span>
                    <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="n">yo1I10</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">yo12I10</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                        <span class="n">yosDatas</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">yo12I10</span> <span class="p">)</span>
                        <span class="n">yo1I10</span><span class="o">.</span><span class="n">set</span><span class="p">(</span> <span class="n">yo1I10</span> <span class="o">-</span> <span class="n">yo12I10</span> <span class="p">)</span>
        <span class="k">for</span> <span class="n">yo</span> <span class="ow">in</span> <span class="n">yosDatas</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="n">yo</span><span class="p">]</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="n">yo</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">10</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">yosDatas</span><span class="p">[</span><span class="n">yo</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">I0</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s1">&#39;Missing cross section data for reaction C = </span><span class="si">%d</span><span class="s1"> S = </span><span class="si">%d</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">C</span><span class="p">,</span> <span class="n">S</span> <span class="p">)</span> <span class="p">)</span>   <span class="c1"># End of Phase 1</span>

        <span class="n">axes</span> <span class="o">=</span> <span class="n">crossSectionAxes</span>
        <span class="k">if</span> <span class="n">I0</span><span class="o">.</span><span class="n">C</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">26</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">48</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">findDatas</span><span class="p">(</span> <span class="n">C</span><span class="o">=</span><span class="n">I0</span><span class="o">.</span><span class="n">C</span><span class="p">,</span> <span class="n">I</span><span class="o">=</span><span class="mi">0</span> <span class="p">)</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">yos</span> <span class="o">=</span> <span class="p">[</span><span class="n">dat</span><span class="o">.</span><span class="n">yo</span> <span class="k">for</span> <span class="n">dat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">findDatas</span><span class="p">(</span> <span class="n">C</span><span class="o">=</span><span class="n">I0</span><span class="o">.</span><span class="n">C</span><span class="p">,</span> <span class="n">X1</span><span class="o">=</span><span class="n">I0</span><span class="o">.</span><span class="n">X1</span> <span class="p">)]</span>
            <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">yos</span><span class="p">)</span> <span class="o">==</span> <span class="mi">16</span><span class="p">:</span>  <span class="c1"># alpha as residual: assume this is a breakup, and recast as a different reaction</span>
                <span class="n">I0</span><span class="o">.</span><span class="n">C</span> <span class="o">=</span> <span class="p">{</span><span class="mi">26</span><span class="p">:</span><span class="mi">11</span><span class="p">,</span> <span class="mi">38</span><span class="p">:</span><span class="mi">44</span><span class="p">,</span> <span class="mi">43</span><span class="p">:</span><span class="mi">42</span><span class="p">,</span> <span class="mi">47</span><span class="p">:</span><span class="mi">41</span><span class="p">,</span> <span class="mi">48</span><span class="p">:</span><span class="mi">40</span><span class="p">}[</span> <span class="n">I0</span><span class="o">.</span><span class="n">C</span> <span class="p">]</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: recasting C=</span><span class="si">%d</span><span class="s2"> to C=</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">I0</span><span class="o">.</span><span class="n">C</span><span class="p">))</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">C</span> <span class="o">==</span> <span class="mi">73</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">regions1d</span> <span class="o">=</span> <span class="n">crossSectionModule</span><span class="o">.</span><span class="n">regions1d</span><span class="p">(</span> <span class="n">label</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span> <span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">for</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="ow">in</span> <span class="n">I0</span><span class="o">.</span><span class="n">data</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">x1</span> <span class="o">==</span> <span class="n">x2</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="n">regions1d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">crossSectionModule</span><span class="o">.</span><span class="n">XYs1d</span><span class="p">(</span> <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span> <span class="n">interpolation</span> <span class="o">=</span> <span class="n">getXYInterpolation</span><span class="p">(</span> <span class="n">I0</span> <span class="p">),</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span> <span class="p">)</span> <span class="p">)</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">[</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="p">]</span> <span class="p">)</span>
                <span class="n">x1</span> <span class="o">=</span> <span class="n">x2</span>
            <span class="n">crossSection</span> <span class="o">=</span> <span class="n">crossSectionModule</span><span class="o">.</span><span class="n">XYs1d</span><span class="p">(</span> <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span> <span class="n">interpolation</span> <span class="o">=</span> <span class="n">getXYInterpolation</span><span class="p">(</span> <span class="n">I0</span> <span class="p">),</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span> <span class="p">)</span>
            <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">regions1d</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">regions1d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">crossSection</span> <span class="p">)</span>
                <span class="n">crossSection</span> <span class="o">=</span> <span class="n">regions1d</span>
            <span class="n">crossSection</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span>
        <span class="k">elif</span><span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">C</span> <span class="o">==</span> <span class="mi">74</span> <span class="p">)</span> <span class="p">:</span>                <span class="c1"># First value is 0 so make it first two points lin-lin like mcfgen does.</span>
            <span class="n">crossSection</span> <span class="o">=</span> <span class="n">crossSectionModule</span><span class="o">.</span><span class="n">regions1d</span><span class="p">(</span> <span class="n">label</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span> <span class="p">)</span>
            <span class="n">crossSection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">crossSectionModule</span><span class="o">.</span><span class="n">XYs1d</span><span class="p">(</span> <span class="n">data</span> <span class="o">=</span> <span class="n">I0</span><span class="o">.</span><span class="n">data</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">interpolation</span> <span class="o">=</span> <span class="n">standardsModule</span><span class="o">.</span><span class="n">interpolation</span><span class="o">.</span><span class="n">linlinToken</span><span class="p">,</span>
                    <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">crossSection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">crossSectionModule</span><span class="o">.</span><span class="n">XYs1d</span><span class="p">(</span> <span class="n">data</span> <span class="o">=</span> <span class="n">I0</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">interpolation</span> <span class="o">=</span> <span class="n">getXYInterpolation</span><span class="p">(</span> <span class="n">I0</span> <span class="p">),</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">crossSection</span> <span class="o">=</span> <span class="n">crossSectionModule</span><span class="o">.</span><span class="n">XYs1d</span><span class="p">(</span> <span class="n">data</span> <span class="o">=</span> <span class="n">I0</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> 
                    <span class="n">interpolation</span> <span class="o">=</span> <span class="n">getXYInterpolation</span><span class="p">(</span> <span class="n">I0</span> <span class="p">),</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span> <span class="p">)</span>

        <span class="k">if</span><span class="p">(</span> <span class="n">C</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">yos</span> <span class="o">=</span> <span class="p">(</span> <span class="mi">0</span><span class="p">,</span> <span class="p">)</span>
        <span class="k">elif</span><span class="p">(</span> <span class="n">isThermalNeutronScatteringLaw</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">residualZA</span><span class="p">,</span> <span class="n">yos</span> <span class="o">=</span> <span class="n">targetZA</span><span class="p">,</span> <span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">targetZA</span> <span class="p">)</span>

            <span class="n">points</span> <span class="o">=</span> <span class="n">I0</span><span class="o">.</span><span class="n">data</span><span class="p">[:]</span>
            <span class="k">while</span><span class="p">(</span> <span class="n">points</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="k">del</span> <span class="n">points</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">priorEnergy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">for</span> <span class="n">energyXSec</span> <span class="ow">in</span> <span class="n">points</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">energyXSec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">priorEnergy</span> <span class="p">)</span> <span class="p">:</span> <span class="n">energyXSec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1e-6</span> <span class="o">*</span> <span class="n">energyXSec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">priorEnergy</span> <span class="o">=</span> <span class="n">energyXSec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">I0</span> <span class="o">=</span> <span class="n">endlIClasses</span><span class="o">.</span><span class="n">endlI0</span><span class="p">(</span> <span class="kc">None</span><span class="p">,</span> <span class="n">I0</span><span class="o">.</span><span class="n">yo</span><span class="p">,</span> <span class="n">I0</span><span class="o">.</span><span class="n">C</span><span class="p">,</span> <span class="n">I0</span><span class="o">.</span><span class="n">I</span><span class="p">,</span> <span class="n">I0</span><span class="o">.</span><span class="n">S</span><span class="p">,</span> <span class="n">I0</span><span class="o">.</span><span class="n">h</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">I0</span><span class="o">.</span><span class="n">bdflsFile</span> <span class="p">)</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">TNSL_EMax</span> <span class="o">!=</span> <span class="n">I0</span><span class="o">.</span><span class="n">xMax</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s1">&#39;TNSL_EMax = </span><span class="si">%s</span><span class="s1"> != I0.xMax( ) = </span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">TNSL_EMax</span><span class="p">,</span> <span class="n">I0</span><span class="o">.</span><span class="n">xMax</span><span class="p">(</span> <span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">I0</span><span class="p">)))</span>
        <span class="k">elif</span><span class="p">(</span> <span class="p">(</span> <span class="n">C</span> <span class="o">==</span> <span class="mi">12</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">targetZA</span> <span class="o">==</span> <span class="mi">4009</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">yi</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>  <span class="c1"># Special case for Be_9(n,2n) which should really be Be_9(n,2n a)</span>
            <span class="n">specialCase</span> <span class="o">=</span> <span class="s1">&#39;Be_9(n, 2n)&#39;</span>
            <span class="n">yos</span> <span class="o">=</span> <span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2004</span> <span class="p">)</span>
        <span class="k">elif</span><span class="p">(</span> <span class="p">(</span> <span class="n">C</span> <span class="o">==</span> <span class="mi">13</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">targetZA</span> <span class="o">==</span> <span class="mi">4010</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">yi</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>  <span class="c1"># Special case for Be10(n,3n)</span>
            <span class="n">specialCase</span> <span class="o">=</span> <span class="s1">&#39;Be_10(n, 3n)&#39;</span>
            <span class="n">yos</span> <span class="o">=</span> <span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2004</span> <span class="p">)</span>
        <span class="k">elif</span><span class="p">(</span> <span class="p">(</span> <span class="n">C</span> <span class="o">==</span> <span class="mi">14</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">targetZA</span> <span class="o">==</span> <span class="mi">4011</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">yi</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>  <span class="c1"># Special case for Be_11(n,4n)</span>
            <span class="n">specialCase</span> <span class="o">=</span> <span class="s1">&#39;Be_11(n, 4n)&#39;</span>
            <span class="n">yos</span> <span class="o">=</span> <span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2004</span> <span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">yos</span> <span class="o">=</span> <span class="n">endl_C</span><span class="o">.</span><span class="n">endl_C_yoInfo</span><span class="p">(</span> <span class="n">C</span> <span class="p">)</span>                 <span class="c1"># Phase 2. Determine products (i.e., yos and residuals).</span>
        <span class="k">for</span> <span class="n">yo</span> <span class="ow">in</span> <span class="n">yos</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">yo</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">C</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">74</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span> <span class="k">continue</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s1">&#39;Electron, positron or electron capture (i.e., yo = 8, 9 or 10) not supported: C = </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">C</span> <span class="p">)</span>
        <span class="n">residuals</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">yos</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">C</span> <span class="o">!=</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;C = </span><span class="si">%d</span><span class="s1"> with no yos is currently not handled by toGNDS&#39;</span> <span class="o">%</span> <span class="n">C</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="k">elif</span><span class="p">(</span> <span class="n">yos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span> <span class="p">:</span>                              <span class="c1"># Unknown yos.</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">C</span> <span class="o">!=</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;C = </span><span class="si">%d</span><span class="s1"> has unknown products which is currently not handled by toGNDS&#39;</span> <span class="o">%</span> <span class="n">C</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="k">elif</span><span class="p">(</span> <span class="n">yos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span> <span class="p">)</span> <span class="p">:</span>                              <span class="c1"># yo = yi</span>
            <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">yos</span> <span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;product list = &#39;</span><span class="p">,</span> <span class="n">yos</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s1">&#39;For C = </span><span class="si">%d</span><span class="s1">, endl_C.endl_C_yoInfo returned -2 plus other products, only the -2 is supported.&#39;</span> <span class="o">%</span> <span class="n">C</span> <span class="p">)</span>
            <span class="n">yos</span> <span class="o">=</span> <span class="p">(</span> <span class="n">yosZAs</span><span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">yi</span> <span class="p">],</span> <span class="p">)</span>
            <span class="n">residuals</span> <span class="o">=</span> <span class="p">[</span> <span class="n">targetZA</span> <span class="p">]</span>
        <span class="k">elif</span><span class="p">(</span> <span class="n">yos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">3</span> <span class="p">)</span> <span class="p">:</span>                                          <span class="c1"># fission</span>
            <span class="n">residuals</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">99120</span><span class="p">,</span> <span class="mi">99120</span> <span class="p">]</span>
        <span class="k">elif</span><span class="p">(</span> <span class="n">yos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">4</span> <span class="p">)</span> <span class="p">:</span>                                          <span class="c1"># nX?</span>
            <span class="k">pass</span>                                                        <span class="c1"># Leave residuals empty as residual is undefined.</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">yiZA</span> <span class="o">=</span> <span class="n">endl2</span><span class="o">.</span><span class="n">yoToZA</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">yi</span> <span class="p">)</span>
            <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="n">yiZA</span> <span class="o">=</span> <span class="mi">1000</span> <span class="o">*</span> <span class="p">(</span> <span class="n">yiZA</span> <span class="o">/</span> <span class="mi">1000</span> <span class="p">)</span>
            <span class="n">productsZA</span> <span class="o">=</span> <span class="o">-</span><span class="n">yiZA</span>
            <span class="k">for</span> <span class="n">yo</span> <span class="ow">in</span> <span class="n">yos</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">yo</span> <span class="o">!=</span> <span class="mi">7</span> <span class="p">)</span> <span class="p">:</span> <span class="n">productsZA</span> <span class="o">+=</span> <span class="n">yo</span>
            <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="n">productsZA</span> <span class="o">=</span> <span class="mi">1000</span> <span class="o">*</span> <span class="p">(</span> <span class="n">productsZA</span> <span class="o">/</span> <span class="mi">1000</span> <span class="p">)</span>
            <span class="n">residuals</span> <span class="o">=</span> <span class="p">[</span> <span class="n">targetZA</span> <span class="o">-</span> <span class="n">productsZA</span> <span class="p">]</span>        <span class="c1"># End of phase 2</span>

        <span class="c1">#FIXME do we still need the next 4 lines? 4008 isn&#39;t in residuals for Be9(n,2n), Be10(n,3n) or Be11(n,4n) due to specialCase logic above</span>
        <span class="k">if</span><span class="p">(</span> <span class="mi">4008</span> <span class="ow">in</span> <span class="n">residuals</span> <span class="p">)</span> <span class="p">:</span>                                       <span class="c1"># Special case for Be_8 breakup into two alphas</span>
            <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="mi">2004</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">yos</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">!=</span> <span class="p">[]</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">==</span> <span class="p">[]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">yosDatas</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
                <span class="n">yosDatas</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span><span class="p">(</span> <span class="mi">99000</span> <span class="o">&lt;</span> <span class="n">targetZA</span> <span class="o">&lt;</span> <span class="mi">99200</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">residuals</span> <span class="o">=</span> <span class="p">[</span> <span class="n">targetZA</span> <span class="p">]</span>
        <span class="k">elif</span><span class="p">(</span> <span class="p">(</span> <span class="n">C</span> <span class="o">==</span> <span class="mi">30</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">endl2</span><span class="o">.</span><span class="n">yoToZA</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">yi</span> <span class="p">)</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">1002</span><span class="p">,</span> <span class="mi">1003</span> <span class="p">]</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">targetZA</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">1002</span><span class="p">,</span> <span class="mi">1003</span> <span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>   <span class="c1"># Special treatment for C = 30 as </span>
            <span class="k">if</span><span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">!=</span> <span class="p">[]</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s1">&#39;C = 30 as yo = 6 data&#39;</span> <span class="p">)</span>                    <span class="c1"># yos should be [ g, n ] and not [ g, n, a ].</span>
            <span class="n">yos</span> <span class="o">=</span> <span class="p">(</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span>
            <span class="n">residuals</span> <span class="o">=</span> <span class="p">(</span> <span class="mi">2004</span><span class="p">,</span> <span class="p">)</span>

        <span class="k">if</span><span class="p">(</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;   &#39;</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">isThermalNeutronScatteringLaw</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">reactionDatas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">getX1</span><span class="p">(</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.1e-12</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">TNSL_MT</span> <span class="o">=</span> <span class="mi">4</span>
                <span class="n">channelProcess</span> <span class="o">=</span> <span class="s2">&quot;Incoherent inelastic scattering&quot;</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="n">TNSL_MT</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="n">channelProcess</span> <span class="o">=</span> <span class="s2">&quot;Coherent elastic scattering&quot;</span>
                <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">ZA</span> <span class="o">==</span> <span class="mi">1901</span> <span class="p">)</span> <span class="p">:</span> <span class="n">channelProcess</span> <span class="o">=</span> <span class="s2">&quot;Inc&quot;</span> <span class="o">+</span> <span class="n">channelProcess</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
            <span class="n">outputChannel</span> <span class="o">=</span> <span class="n">channelsModule</span><span class="o">.</span><span class="n">NBodyOutputChannel</span><span class="p">(</span> <span class="n">process</span> <span class="o">=</span> <span class="n">channelProcess</span> <span class="p">)</span>
            <span class="n">outputChannel</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">returnConstantQ</span><span class="p">(</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">I0</span><span class="o">.</span><span class="n">getQ</span><span class="p">(</span> <span class="p">),</span> <span class="n">crossSection</span> <span class="p">)</span> <span class="p">)</span>

            <span class="n">firstParticle</span> <span class="o">=</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">newGNDSParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="mi">1</span> <span class="p">),</span> <span class="n">crossSection</span> <span class="p">)</span>
            <span class="n">addDistributionDataAndRemove</span><span class="p">(</span> <span class="n">firstParticle</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">yosDatas</span><span class="p">,</span> <span class="n">crossSection</span> <span class="p">)</span>
            <span class="n">outputChannel</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">outputChannel</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">uniqueLabel</span><span class="p">(</span> <span class="n">firstParticle</span> <span class="p">)</span> <span class="p">)</span>

            <span class="k">for</span> <span class="n">yo</span> <span class="ow">in</span> <span class="n">yosDatas</span> <span class="p">:</span> <span class="n">yosDatas</span><span class="p">[</span><span class="n">yo</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">elif</span><span class="p">(</span> <span class="p">(</span> <span class="n">yos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">C</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">74</span> <span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>  <span class="c1"># Reactions that are two-body, two-body + break-up or discrete N-body except C = 71 - 74.</span>
            <span class="n">outputChannel</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">Is</span> <span class="o">=</span> <span class="n">getAllDistributionIs</span><span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="n">ZAsYos</span><span class="p">[</span><span class="n">yos</span><span class="p">[</span><span class="mi">0</span><span class="p">]]]</span> <span class="p">)</span>
            <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="n">Is</span> <span class="o">==</span> <span class="p">[</span> <span class="mi">1</span> <span class="p">]</span> <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span> <span class="n">S</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>     <span class="c1"># Two-body initial product state.</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;2Body&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="n">firstParticle</span> <span class="o">=</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">newGNDSParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">yos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">),</span>
                        <span class="n">crossSection</span> <span class="p">)</span>    <span class="c1"># Assume first particle is in the ground state.</span>
                <span class="n">addDistributionDataAndRemove</span><span class="p">(</span> <span class="n">firstParticle</span><span class="p">,</span> <span class="n">ZAsYos</span><span class="p">[</span><span class="n">yos</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">yosDatas</span><span class="p">,</span> <span class="n">crossSection</span> <span class="p">)</span>
                <span class="n">Q</span> <span class="o">=</span> <span class="n">returnConstantQ</span><span class="p">(</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">I0</span><span class="o">.</span><span class="n">getQ</span><span class="p">(</span> <span class="p">),</span> <span class="n">crossSection</span> <span class="p">)</span>
                <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">yos</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span>                                 <span class="c1"># Simple two-body, yos[0] + Residual [ + gamma].</span>
                    <span class="n">resYo</span> <span class="o">=</span> <span class="n">residuals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">resYo</span> <span class="ow">in</span> <span class="n">ZAsYos</span> <span class="p">)</span> <span class="p">:</span> <span class="n">resYo</span> <span class="o">=</span> <span class="n">ZAsYos</span><span class="p">[</span><span class="n">resYo</span><span class="p">]</span> <span class="o">+</span> <span class="mi">10</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">S</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span>
                        <span class="n">Q</span> <span class="o">=</span> <span class="n">returnConstantQ</span><span class="p">(</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">I0</span><span class="o">.</span><span class="n">getQ</span><span class="p">(</span> <span class="p">)</span> <span class="o">-</span> <span class="n">I0</span><span class="o">.</span><span class="n">getX1</span><span class="p">(</span> <span class="p">),</span> <span class="n">crossSection</span> <span class="p">)</span>
                        <span class="n">resParticle</span> <span class="o">=</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">newGNDSParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">residuals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">),</span>
                                <span class="n">crossSection</span> <span class="p">)</span>

                        <span class="n">addResidual</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="n">decayChannel</span> <span class="o">=</span> <span class="kc">None</span>
                        <span class="k">if</span><span class="p">(</span> <span class="mi">7</span> <span class="ow">in</span> <span class="n">yos</span> <span class="p">)</span> <span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;7 in yos&#39;</span><span class="p">)</span>

                        <span class="k">if</span><span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">!=</span> <span class="p">[]</span> <span class="p">)</span> <span class="p">:</span>
                            <span class="n">decayChannel</span> <span class="o">=</span> <span class="n">channelsModule</span><span class="o">.</span><span class="n">NBodyOutputChannel</span><span class="p">(</span> <span class="p">)</span>
                            <span class="n">decayChannel</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">returnConstantQ</span><span class="p">(</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">I0</span><span class="o">.</span><span class="n">getX1</span><span class="p">(</span> <span class="p">),</span> <span class="n">crossSection</span> <span class="p">)</span> <span class="p">)</span>  <span class="c1"># Assume residual returns to ground state, hence Q = getX1( )</span>
                            <span class="n">gammaParticle</span> <span class="o">=</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">newGNDSParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="mi">7</span> <span class="p">),</span>
                                    <span class="n">crossSection</span> <span class="p">)</span>
                            <span class="n">Is_</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span> <span class="p">[</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="p">]</span> <span class="p">)</span>
                            <span class="k">if</span><span class="p">(</span> <span class="n">Is_</span> <span class="o">==</span> <span class="p">[</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">13</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  gamma has I = 10 and 13 but no others&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                                <span class="n">yosDatas</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                            <span class="k">else</span> <span class="p">:</span>
                                <span class="n">addDistributionDataAndRemove</span><span class="p">(</span> <span class="n">gammaParticle</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">yosDatas</span><span class="p">,</span> <span class="n">crossSection</span> <span class="p">)</span>
                            <span class="n">decayChannel</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">decayChannel</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">uniqueLabel</span><span class="p">(</span> <span class="n">gammaParticle</span> <span class="p">)</span> <span class="p">)</span>
                            <span class="n">addResidual</span> <span class="o">=</span> <span class="kc">True</span>

                        <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="n">residuals</span> <span class="o">==</span> <span class="p">[</span> <span class="mi">4008</span> <span class="p">]</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">!=</span> <span class="p">[]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                            <span class="k">if</span><span class="p">(</span> <span class="n">decayChannel</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span>
                                <span class="n">decayChannel</span> <span class="o">=</span> <span class="n">channelsModule</span><span class="o">.</span><span class="n">NBodyOutputChannel</span><span class="p">(</span> <span class="p">)</span>
                                <span class="n">decayChannel</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">returnConstantQ</span><span class="p">(</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">I0</span><span class="o">.</span><span class="n">getX1</span><span class="p">(</span> <span class="p">),</span> <span class="n">crossSection</span> <span class="p">)</span> <span class="p">)</span>  <span class="c1"># Assume residual returns to ground.</span>
                            <span class="n">He4Particle</span> <span class="o">=</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">newGNDSParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="mi">2004</span> <span class="p">),</span>
                                    <span class="n">crossSection</span><span class="p">,</span> <span class="n">multiplicity</span> <span class="o">=</span> <span class="mi">2</span> <span class="p">)</span>
                            <span class="n">addDistributionDataAndRemove</span><span class="p">(</span> <span class="n">He4Particle</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">yosDatas</span><span class="p">,</span> <span class="n">crossSection</span> <span class="p">)</span>
                            <span class="n">decayChannel</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">decayChannel</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">uniqueLabel</span><span class="p">(</span> <span class="n">He4Particle</span> <span class="p">)</span> <span class="p">)</span>
                            <span class="n">addResidual</span> <span class="o">=</span> <span class="kc">False</span>

                        <span class="k">if</span><span class="p">(</span> <span class="n">addResidual</span> <span class="p">)</span> <span class="p">:</span> <span class="n">decayChannel</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">decayChannel</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">uniqueLabel</span><span class="p">(</span> <span class="n">resParticle</span> <span class="p">)</span> <span class="p">)</span>
                        <span class="n">level</span> <span class="o">=</span> <span class="n">I0</span><span class="o">.</span><span class="n">getX1</span><span class="p">(</span> <span class="p">)</span>
                        <span class="n">levelIndex</span> <span class="o">=</span> <span class="n">residualExcitationIndexLevels</span><span class="p">[</span><span class="n">residuals</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">level</span><span class="p">]</span>
                        <span class="k">if</span><span class="p">(</span> <span class="n">levelIndex</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> <span class="n">level</span> <span class="o">=</span> <span class="kc">None</span>
                        <span class="n">secondParticle</span> <span class="o">=</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">newGNDSParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span>
                                <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">residuals</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">level</span> <span class="o">=</span> <span class="n">level</span><span class="p">,</span> <span class="n">levelIndex</span> <span class="o">=</span> <span class="n">levelIndex</span> <span class="p">),</span>
                                <span class="n">crossSection</span><span class="p">,</span> <span class="n">outputChannel</span> <span class="o">=</span> <span class="n">decayChannel</span> <span class="p">)</span>
                        <span class="k">if</span><span class="p">(</span> <span class="n">Is</span> <span class="o">==</span> <span class="p">[</span> <span class="mi">1</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span> <span class="n">addRecoilDistributionAndRemove</span><span class="p">(</span> <span class="n">secondParticle</span><span class="p">,</span> <span class="n">firstParticle</span><span class="p">,</span> <span class="n">resYo</span><span class="p">,</span> <span class="n">yosDatas</span> <span class="p">)</span>

                        <span class="k">if</span> <span class="n">levelIndex</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">secondParticle</span><span class="o">.</span><span class="n">outputChannel</span><span class="p">:</span>
                            <span class="n">particle</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">PoPs</span><span class="p">[</span> <span class="n">secondParticle</span><span class="o">.</span><span class="n">pid</span> <span class="p">]</span>
                            <span class="n">groundState</span> <span class="o">=</span> <span class="n">particle</span><span class="o">.</span><span class="n">isotope</span><span class="o">.</span><span class="n">nuclides</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                            <span class="n">ZA</span> <span class="o">=</span> <span class="n">chemicalElementMiscPoPsModule</span><span class="o">.</span><span class="n">ZA</span><span class="p">(</span> <span class="n">groundState</span> <span class="p">)</span>
                            <span class="n">multiplicity</span> <span class="o">=</span> <span class="n">secondParticle</span><span class="o">.</span><span class="n">multiplicity</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                            <span class="n">secondParticle</span><span class="o">.</span><span class="n">addOutputChannel</span><span class="p">(</span> <span class="n">channelsModule</span><span class="o">.</span><span class="n">NBodyOutputChannel</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span>
                            <span class="n">secondParticle</span><span class="o">.</span><span class="n">outputChannel</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">returnConstantQ</span><span class="p">(</span>
                                <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">particle</span><span class="o">.</span><span class="n">nucleus</span><span class="o">.</span><span class="n">energy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">multiplicity</span> <span class="p">)</span> <span class="p">)</span>
                            <span class="n">product</span> <span class="o">=</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">newGNDSParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">getPoPsParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">ZA</span><span class="p">,</span> <span class="n">groundState</span><span class="o">.</span><span class="n">id</span> <span class="p">),</span>
                                    <span class="n">crossSection</span><span class="p">,</span> <span class="n">multiplicity</span> <span class="o">=</span> <span class="n">multiplicity</span> <span class="p">)</span>
                            <span class="n">product</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">unspecifiedModule</span><span class="o">.</span><span class="n">form</span><span class="p">(</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">standardsModule</span><span class="o">.</span><span class="n">frames</span><span class="o">.</span><span class="n">labToken</span> <span class="p">)</span> <span class="p">)</span>
                            <span class="n">secondParticle</span><span class="o">.</span><span class="n">outputChannel</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">product</span> <span class="p">)</span>
                    <span class="k">else</span> <span class="p">:</span>
                        <span class="n">decayChannel</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">levelIndex</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
                        <span class="k">if</span><span class="p">(</span> <span class="n">S</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>
                            <span class="n">level</span> <span class="o">=</span> <span class="n">I0</span><span class="o">.</span><span class="n">getELevel</span><span class="p">(</span> <span class="p">)</span>
                            <span class="n">levelIndex</span> <span class="o">=</span> <span class="kc">None</span>
                            <span class="k">if</span><span class="p">(</span> <span class="n">C</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
                                <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">!=</span> <span class="p">[]</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">residuals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">7</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                                    <span class="n">decayChannel</span> <span class="o">=</span> <span class="n">channelsModule</span><span class="o">.</span><span class="n">NBodyOutputChannel</span><span class="p">(</span> <span class="p">)</span>
                                    <span class="n">decayChannel</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">returnConstantQ</span><span class="p">(</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">I0</span><span class="o">.</span><span class="n">getX1</span><span class="p">(</span> <span class="p">),</span> <span class="n">crossSection</span> <span class="p">)</span> <span class="p">)</span>
                                    <span class="n">resParticle</span> <span class="o">=</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">newGNDSParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span>
                                            <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">residuals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">),</span> <span class="n">crossSection</span> <span class="p">)</span>       <span class="c1"># Residual in ground state.</span>
                                    <span class="n">addDistributionDataAndRemove</span><span class="p">(</span> <span class="n">resParticle</span><span class="p">,</span> <span class="n">resYo</span><span class="p">,</span> <span class="n">yosDatas</span><span class="p">,</span> <span class="n">crossSection</span> <span class="p">)</span>
                                    <span class="n">decayChannel</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">decayChannel</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">uniqueLabel</span><span class="p">(</span> <span class="n">resParticle</span> <span class="p">)</span> <span class="p">)</span>
                                    <span class="n">gammaParticle</span> <span class="o">=</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">newGNDSParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="mi">7</span> <span class="p">),</span>
                                            <span class="n">crossSection</span> <span class="p">)</span>
                                    <span class="n">addDistributionDataAndRemove</span><span class="p">(</span> <span class="n">gammaParticle</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">yosDatas</span><span class="p">,</span> <span class="n">crossSection</span> <span class="p">)</span>
                                    <span class="n">decayChannel</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">decayChannel</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">uniqueLabel</span><span class="p">(</span> <span class="n">gammaParticle</span> <span class="p">)</span> <span class="p">)</span>
                            <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="n">level</span> <span class="o">==</span> <span class="mf">0.0</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">levelIndex</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">level</span> <span class="o">=</span> <span class="kc">None</span>
                        <span class="k">if</span><span class="p">(</span> <span class="n">residuals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">2004</span> <span class="p">)</span> <span class="p">:</span> <span class="n">level</span><span class="p">,</span> <span class="n">levelIndex</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
                        <span class="k">if</span><span class="p">(</span> <span class="n">C</span><span class="o">==</span><span class="mi">10</span> <span class="ow">and</span> <span class="n">I0</span><span class="o">.</span><span class="n">getELevel</span><span class="p">(</span> <span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>        <span class="c1"># Elastic scattering off an isomer, use alias for reaction label</span>
                            <span class="n">secondParticle</span> <span class="o">=</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">newGNDSParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">info</span><span class="o">.</span><span class="n">targetID</span><span class="p">,</span> <span class="n">crossSection</span> <span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">secondParticle</span> <span class="o">=</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">newGNDSParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span>
                                    <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">residuals</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">level</span> <span class="o">=</span> <span class="n">level</span><span class="p">,</span> <span class="n">levelIndex</span> <span class="o">=</span> <span class="n">levelIndex</span> <span class="p">),</span>
                                    <span class="n">crossSection</span><span class="p">,</span> <span class="n">outputChannel</span> <span class="o">=</span> <span class="n">decayChannel</span> <span class="p">)</span>
                        <span class="n">addRecoilDistributionAndRemove</span><span class="p">(</span> <span class="n">secondParticle</span><span class="p">,</span> <span class="n">firstParticle</span><span class="p">,</span> <span class="n">resYo</span><span class="p">,</span> <span class="n">yosDatas</span> <span class="p">)</span>
                <span class="k">else</span> <span class="p">:</span>                                          <span class="c1"># Two-body with residual breaking up.</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;w/breakup&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                    <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s1">&#39;For C = </span><span class="si">%d</span><span class="s1">, breakup of product not supported for two-body reaction for natural target.&#39;</span> <span class="p">)</span>
                    <span class="n">mYos</span> <span class="o">=</span> <span class="n">getMultiplicityYos</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">yos</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">residuals</span><span class="p">,</span> <span class="n">yosDatas</span> <span class="p">)</span>
                    <span class="n">residualZA</span> <span class="o">=</span> <span class="n">targetZA</span> <span class="o">+</span> <span class="n">endl2</span><span class="o">.</span><span class="n">yoToZA</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">yi</span> <span class="p">)</span> <span class="o">-</span> <span class="n">yos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">level</span> <span class="o">=</span> <span class="mf">0.0</span>
                    <span class="n">levelIndex</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">S</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span>
                        <span class="n">level</span> <span class="o">=</span> <span class="n">I0</span><span class="o">.</span><span class="n">getX1</span><span class="p">(</span> <span class="p">)</span>
                        <span class="n">levelIndex</span> <span class="o">=</span> <span class="n">residualExcitationIndexLevels</span><span class="p">[</span><span class="n">residualZA</span><span class="p">][</span><span class="n">level</span><span class="p">]</span>
                    <span class="k">elif</span><span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">S</span> <span class="o">==</span> <span class="mi">8</span> <span class="p">)</span> <span class="p">:</span> 
                        <span class="n">levelIndex</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">I0</span><span class="o">.</span><span class="n">getX1</span><span class="p">(</span> <span class="p">)</span>
                    <span class="n">Q_MeV</span> <span class="o">=</span> <span class="n">endl2</span><span class="o">.</span><span class="n">reactionQByZAs</span><span class="p">(</span> <span class="p">[</span> <span class="n">endl2</span><span class="o">.</span><span class="n">yoToZA</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">yi</span> <span class="p">),</span> <span class="n">targetZA</span> <span class="p">],</span> <span class="p">[</span> <span class="n">yos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">residualZA</span> <span class="p">]</span> <span class="p">)</span> <span class="o">-</span> <span class="n">level</span>
                    <span class="n">residualName</span> <span class="o">=</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">residualZA</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="n">level</span><span class="p">,</span> <span class="n">levelIndex</span> <span class="o">=</span> <span class="n">levelIndex</span> <span class="p">)</span>
                    <span class="n">decayChannel</span> <span class="o">=</span> <span class="n">makeNBodyChannelFrom_mYos</span><span class="p">(</span> <span class="n">channelsModule</span><span class="o">.</span><span class="n">NBodyOutputChannel</span><span class="p">,</span> <span class="n">mYos</span><span class="p">,</span> <span class="n">ZAsYos</span><span class="p">,</span> <span class="n">yosDatas</span><span class="p">,</span> 
                            <span class="n">I0</span><span class="o">.</span><span class="n">getQ</span><span class="p">(</span> <span class="p">)</span> <span class="o">-</span> <span class="n">Q_MeV</span><span class="p">,</span> <span class="n">crossSection</span><span class="p">,</span> <span class="n">specialCase</span> <span class="o">=</span> <span class="n">specialCase</span> <span class="p">)</span>
                    <span class="n">secondParticle</span> <span class="o">=</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">newGNDSParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">residualName</span><span class="p">,</span> <span class="n">crossSection</span><span class="p">,</span>
                            <span class="n">outputChannel</span> <span class="o">=</span> <span class="n">decayChannel</span> <span class="p">)</span>
                    <span class="n">Q</span> <span class="o">=</span> <span class="n">returnConstantQ</span><span class="p">(</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">Q_MeV</span><span class="p">,</span> <span class="n">crossSection</span> <span class="p">)</span>
                <span class="n">outputChannel</span> <span class="o">=</span> <span class="n">channelsModule</span><span class="o">.</span><span class="n">twoBodyOutputChannel</span><span class="p">(</span> <span class="p">)</span>
                <span class="n">outputChannel</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">Q</span> <span class="p">)</span>
                <span class="n">outputChannel</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">outputChannel</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">uniqueLabel</span><span class="p">(</span> <span class="n">firstParticle</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">outputChannel</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">outputChannel</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">uniqueLabel</span><span class="p">(</span> <span class="n">secondParticle</span> <span class="p">)</span> <span class="p">)</span>
            <span class="k">else</span> <span class="p">:</span>                                              <span class="c1"># Mutli-particle breakup (i.e., not two body).</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;NBody&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="n">mYos</span> <span class="o">=</span> <span class="n">getMultiplicityYos</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">yos</span><span class="p">,</span> <span class="n">residuals</span><span class="p">,</span> <span class="n">yosDatas</span> <span class="p">)</span>
                <span class="n">gammaPresent</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">yo</span> <span class="ow">in</span> <span class="n">mYos</span> <span class="p">:</span> <span class="n">gammaPresent</span> <span class="o">=</span> <span class="n">gammaPresent</span> <span class="ow">or</span> <span class="p">(</span> <span class="n">yo</span> <span class="o">==</span> <span class="mi">7</span> <span class="p">)</span>
                <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="ow">not</span> <span class="n">gammaPresent</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">!=</span> <span class="p">[]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">mYos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span> <span class="p">]</span> <span class="p">)</span>
                <span class="n">decayChannelInfo</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">specialCase</span> <span class="o">==</span> <span class="s1">&#39;Be_9(n, 2n)&#39;</span> <span class="p">)</span> <span class="p">:</span>                                            <span class="c1"># Special case for endl Be_9(n, 2n)</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="p">[]</span> <span class="p">)</span> <span class="p">:</span> <span class="n">mYos</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2004</span><span class="p">]</span> <span class="p">]</span>
                <span class="k">elif</span><span class="p">(</span> <span class="n">specialCase</span> <span class="o">==</span> <span class="s1">&#39;Be_10(n, 3n)&#39;</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="p">[]</span> <span class="p">)</span> <span class="p">:</span> <span class="n">mYos</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2004</span><span class="p">]</span> <span class="p">]</span>
                <span class="k">elif</span><span class="p">(</span> <span class="n">specialCase</span> <span class="o">==</span> <span class="s1">&#39;Be_11(n, 4n)&#39;</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="p">[]</span> <span class="p">)</span> <span class="p">:</span> <span class="n">mYos</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2004</span><span class="p">]</span> <span class="p">]</span>

                <span class="n">outputChannel</span> <span class="o">=</span> <span class="n">makeNBodyChannelFrom_mYos</span><span class="p">(</span> <span class="n">channelsModule</span><span class="o">.</span><span class="n">NBodyOutputChannel</span><span class="p">,</span> <span class="n">mYos</span><span class="p">,</span> <span class="n">ZAsYos</span><span class="p">,</span> <span class="n">yosDatas</span><span class="p">,</span> <span class="n">I0</span><span class="o">.</span><span class="n">getQ</span><span class="p">(</span> <span class="p">),</span> 
                        <span class="n">crossSection</span><span class="p">,</span> <span class="n">specialCase</span> <span class="o">=</span> <span class="n">specialCase</span><span class="p">,</span> <span class="n">decayChannelInfo</span> <span class="o">=</span> <span class="n">decayChannelInfo</span><span class="p">,</span> <span class="n">process</span> <span class="o">=</span> <span class="n">channelProcess</span> <span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span>  <span class="c1"># Reactions that are not two-body, two-body + break-up or discrete N-body except C = 71 to 74.</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">C</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span>                                 <span class="c1"># (n,total)</span>
                <span class="n">outputChannel</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">elif</span><span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">C</span> <span class="o">==</span> <span class="mi">15</span> <span class="p">)</span> <span class="p">:</span>                              <span class="c1"># Fission</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Fission&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="n">outputChannel</span> <span class="o">=</span> <span class="n">channelsModule</span><span class="o">.</span><span class="n">fissionChannel</span><span class="p">(</span> <span class="n">fissionGenre</span> <span class="o">=</span> <span class="n">channelsModule</span><span class="o">.</span><span class="n">fissionGenreTotal</span> <span class="p">)</span>
                <span class="n">outputChannel</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">returnConstantQ</span><span class="p">(</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">I0</span><span class="o">.</span><span class="n">getQ</span><span class="p">(</span> <span class="p">),</span> <span class="n">crossSection</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">particle</span> <span class="o">=</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">newGNDSParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="mi">1</span> <span class="p">),</span> <span class="n">crossSection</span> <span class="p">)</span>
                <span class="n">addDistributionDataAndRemove</span><span class="p">(</span> <span class="n">particle</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">yosDatas</span><span class="p">,</span> <span class="n">crossSection</span> <span class="p">)</span>
                <span class="n">outputChannel</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">outputChannel</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">uniqueLabel</span><span class="p">(</span> <span class="n">particle</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">decayRates</span> <span class="o">=</span> <span class="n">delayedNeutrons</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span> <span class="p">)</span>
                <span class="n">decayRates</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span> <span class="p">)</span>
                <span class="n">decayRates</span><span class="o">.</span><span class="n">reverse</span><span class="p">(</span> <span class="p">)</span>
                <span class="k">for</span> <span class="n">decayRate</span> <span class="ow">in</span> <span class="n">decayRates</span><span class="p">:</span>
                    <span class="n">gammasRemoved</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">delayedDatum</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="n">delayedNeutrons</span><span class="p">[</span><span class="n">decayRate</span><span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
                        <span class="k">if</span><span class="p">(</span> <span class="n">delayedDatum</span><span class="o">.</span><span class="n">yo</span> <span class="o">==</span> <span class="mi">7</span> <span class="p">)</span> <span class="p">:</span> <span class="n">gammasRemoved</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">index</span> <span class="p">)</span>
                    <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">gammasRemoved</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="nb">print</span><span class="p">()</span>
                    <span class="k">while</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">gammasRemoved</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>
                        <span class="n">gammaRemoved</span> <span class="o">=</span> <span class="n">delayedNeutrons</span><span class="p">[</span><span class="n">decayRate</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span> <span class="n">gammasRemoved</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;        remove delayed gamma data&#39;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">gammaRemoved</span><span class="p">))</span>
                        <span class="n">gammasRemoved</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span> <span class="p">)</span>
                    <span class="n">delayedData</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">delayedNeutrons</span><span class="p">[</span><span class="n">decayRate</span><span class="p">]</span> <span class="p">}</span>
                    <span class="n">delayedParticle</span> <span class="o">=</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">newGNDSParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="mi">1</span> <span class="p">),</span> <span class="n">crossSection</span> <span class="p">)</span>
                    <span class="n">Is_</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span> <span class="p">[</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">delayedData</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">]</span> <span class="p">)</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">Is_</span> <span class="o">==</span> <span class="p">[</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">13</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
                        <span class="k">if</span><span class="p">(</span> <span class="n">verbose</span> <span class="p">)</span> <span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  delayed neutron has I = 7, 10 and 13 but no others&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">:</span>
                        <span class="n">addDistributionDataAndRemove</span><span class="p">(</span> <span class="n">delayedParticle</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">delayedData</span><span class="p">,</span> <span class="n">crossSection</span><span class="p">,</span> <span class="n">promptNeutronParticle</span> <span class="o">=</span> <span class="n">particle</span> <span class="p">)</span>
                    <span class="n">outputChannel</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">outputChannel</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">uniqueLabel</span><span class="p">(</span> <span class="n">delayedParticle</span> <span class="p">)</span> <span class="p">)</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">!=</span> <span class="p">[]</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="n">gammaParticle</span> <span class="o">=</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">newGNDSParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="mi">7</span> <span class="p">),</span> <span class="n">crossSection</span> <span class="p">)</span>
                    <span class="n">addDistributionDataAndRemove</span><span class="p">(</span> <span class="n">gammaParticle</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">yosDatas</span><span class="p">,</span> <span class="n">crossSection</span> <span class="p">)</span>
                    <span class="n">outputChannel</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">outputChannel</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">uniqueLabel</span><span class="p">(</span> <span class="n">gammaParticle</span> <span class="p">)</span> <span class="p">)</span>
            <span class="k">elif</span><span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">C</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">74</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;7[124]&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">4</span> <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span> <span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">C</span> <span class="o">==</span> <span class="mi">74</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">10</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">del</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span>
                <span class="n">firstParticle</span> <span class="o">=</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">newGNDSParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="mi">7</span> <span class="p">),</span> <span class="n">crossSection</span> <span class="p">)</span>
                <span class="n">doubleDifferentialCrossSectionForm</span> <span class="o">=</span> <span class="n">addDistributionDataAndRemove</span><span class="p">(</span> <span class="n">firstParticle</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">yosDatas</span><span class="p">,</span> <span class="n">crossSection</span> <span class="p">)</span>
                <span class="n">secondParticle</span> <span class="o">=</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">newGNDSParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">targetID</span><span class="p">,</span> <span class="n">crossSection</span> <span class="p">)</span>
                <span class="n">process</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">71</span> <span class="p">:</span> <span class="s1">&#39;coherent&#39;</span><span class="p">,</span> <span class="mi">72</span> <span class="p">:</span> <span class="s1">&#39;incoherent&#39;</span><span class="p">,</span> <span class="mi">74</span> <span class="p">:</span> <span class="s1">&#39;pair production: electron field&#39;</span> <span class="p">}[</span><span class="n">I0</span><span class="o">.</span><span class="n">C</span><span class="p">]</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">C</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">72</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="n">outputChannel</span> <span class="o">=</span> <span class="n">channelsModule</span><span class="o">.</span><span class="n">twoBodyOutputChannel</span><span class="p">(</span> <span class="n">process</span> <span class="o">=</span> <span class="n">process</span> <span class="p">)</span>
                <span class="k">else</span> <span class="p">:</span>
                    <span class="n">outputChannel</span> <span class="o">=</span> <span class="n">channelsModule</span><span class="o">.</span><span class="n">NBodyOutputChannel</span><span class="p">(</span> <span class="n">process</span> <span class="o">=</span> <span class="n">process</span> <span class="p">)</span>
                <span class="n">outputChannel</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">returnConstantQ</span><span class="p">(</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">I0</span><span class="o">.</span><span class="n">getQ</span><span class="p">(</span> <span class="p">),</span> <span class="n">crossSection</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">outputChannel</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">outputChannel</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">uniqueLabel</span><span class="p">(</span> <span class="n">firstParticle</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">outputChannel</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">outputChannel</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">uniqueLabel</span><span class="p">(</span> <span class="n">secondParticle</span> <span class="p">)</span> <span class="p">)</span>
            <span class="k">elif</span><span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">C</span> <span class="o">==</span> <span class="mi">73</span> <span class="p">)</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;73&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="n">firstParticle</span> <span class="o">=</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">newGNDSParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="mi">9</span> <span class="p">),</span> <span class="n">crossSection</span> <span class="p">)</span>
                <span class="n">secondParticle</span> <span class="o">=</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">newGNDSParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">targetID</span><span class="p">,</span> <span class="n">crossSection</span> <span class="p">)</span>
                <span class="n">outputChannel</span> <span class="o">=</span> <span class="n">channelsModule</span><span class="o">.</span><span class="n">NBodyOutputChannel</span><span class="p">(</span> <span class="n">process</span> <span class="o">=</span> <span class="s2">&quot;photo-electric&quot;</span> <span class="p">)</span>
                <span class="n">outputChannel</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">returnConstantQ</span><span class="p">(</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">I0</span><span class="o">.</span><span class="n">getQ</span><span class="p">(</span> <span class="p">),</span> <span class="n">crossSection</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">outputChannel</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">outputChannel</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">uniqueLabel</span><span class="p">(</span> <span class="n">firstParticle</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">outputChannel</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">outputChannel</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">uniqueLabel</span><span class="p">(</span> <span class="n">secondParticle</span> <span class="p">)</span> <span class="p">)</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">C</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">C</span> <span class="o">&lt;</span> <span class="mi">57</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> 
                    <span class="k">if</span><span class="p">(</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;production&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">yos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">4</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                        <span class="s1">&#39;Does not appear to be production channel. Internal error. C = </span><span class="si">%d</span><span class="s1">, yos = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">yos</span><span class="p">))</span> <span class="p">)</span>
                    <span class="n">multiplicity</span> <span class="o">=</span> <span class="n">multiplicityModule</span><span class="o">.</span><span class="n">partialProduction</span><span class="p">(</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span> <span class="p">)</span>
                    <span class="n">particle</span> <span class="o">=</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">newGNDSParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">yos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">),</span>
                            <span class="n">crossSection</span><span class="p">,</span> <span class="n">multiplicity</span> <span class="o">=</span> <span class="n">multiplicity</span> <span class="p">)</span>
                    <span class="n">addDistributionDataAndRemove</span><span class="p">(</span> <span class="n">particle</span><span class="p">,</span> <span class="n">ZAsYos</span><span class="p">[</span><span class="n">yos</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">yosDatas</span><span class="p">,</span> <span class="n">crossSection</span> <span class="p">)</span>
                    <span class="n">outputChannel</span> <span class="o">=</span> <span class="n">channelsModule</span><span class="o">.</span><span class="n">NBodyOutputChannel</span><span class="p">(</span> <span class="p">)</span>
                    <span class="n">outputChannel</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">returnConstantQ</span><span class="p">(</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">I0</span><span class="o">.</span><span class="n">getQ</span><span class="p">(</span> <span class="p">),</span> <span class="n">crossSection</span> <span class="p">)</span> <span class="p">)</span>
                    <span class="n">outputChannel</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">outputChannel</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">uniqueLabel</span><span class="p">(</span> <span class="n">particle</span> <span class="p">)</span> <span class="p">)</span>
                <span class="k">else</span> <span class="p">:</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="nb">print</span><span class="p">()</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;NONO:&quot;</span><span class="p">,</span> <span class="n">I0</span><span class="p">)</span>
                    <span class="k">continue</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="nb">print</span><span class="p">()</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span> <span class="n">outputChannel</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">S</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">tmp</span> <span class="o">+=</span> <span class="s1">&#39; S2&#39;</span>
        <span class="k">elif</span><span class="p">(</span> <span class="n">C</span> <span class="o">==</span> <span class="mi">9</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">tmp</span> <span class="o">+=</span> <span class="s1">&#39; n+i&#39;</span>
        <span class="k">elif</span><span class="p">(</span> <span class="n">C</span> <span class="o">==</span> <span class="mi">55</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">tmp</span> <span class="o">+=</span> <span class="s1">&#39; discreteEnergy = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">I0</span><span class="o">.</span><span class="n">getX1</span><span class="p">(</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">tmp</span> <span class="ow">in</span> <span class="n">channelList</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">endlmisc</span><span class="o">.</span><span class="n">printWarning</span><span class="p">(</span> <span class="s1">&#39;    WARNING: </span><span class="si">%s</span><span class="s1"> already in list for </span><span class="si">%d</span><span class="s1">: C=</span><span class="si">%s</span><span class="s1">, S=</span><span class="si">%s</span><span class="s1">, X1=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">tmp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ZA</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">I0</span><span class="o">.</span><span class="n">getX1</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">channelList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">tmp</span> <span class="p">)</span>

        <span class="k">if</span><span class="p">(</span> <span class="n">I12</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> 
            <span class="n">Q</span> <span class="o">=</span> <span class="n">QModule</span><span class="o">.</span><span class="n">XYs1d</span><span class="p">(</span> <span class="n">label</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">I12</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">QAxes</span><span class="p">,</span> <span class="n">interpolation</span> <span class="o">=</span> <span class="n">getXYInterpolation</span><span class="p">(</span> <span class="n">I12</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">outputChannel</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span> <span class="p">)</span>    <span class="c1"># replace constant approximation with energy-dependent version</span>
            <span class="n">outputChannel</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">Q</span> <span class="p">)</span>

        <span class="n">CCounts</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">findDatas</span><span class="p">(</span> <span class="n">C</span> <span class="o">=</span> <span class="n">I0</span><span class="o">.</span><span class="n">C</span><span class="p">,</span> <span class="n">I</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">isThermalNeutronScatteringLaw</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">MT</span> <span class="o">=</span> <span class="n">TNSL_MT</span>
        <span class="k">elif</span><span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">C</span> <span class="ow">in</span> <span class="p">(</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">MT</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">elif</span><span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">C</span> <span class="o">==</span> <span class="mi">20</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">findDatas</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mi">21</span><span class="p">))</span><span class="o">==</span><span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">MT</span> <span class="o">=</span> <span class="mi">28</span>
        <span class="k">elif</span><span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">C</span> <span class="o">==</span> <span class="mi">21</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">findDatas</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mi">20</span><span class="p">))</span><span class="o">==</span><span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">MT</span> <span class="o">=</span> <span class="mi">28</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">I0S</span> <span class="o">=</span> <span class="n">I0</span><span class="o">.</span><span class="n">S</span>
            <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="n">outputChannel</span><span class="p">,</span> <span class="n">channelsModule</span><span class="o">.</span><span class="n">twoBodyOutputChannel</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">I0S</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">MT</span> <span class="o">=</span> <span class="n">ENDLCS_To_ENDFMT</span><span class="o">.</span><span class="n">getMTFromCS</span><span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">C</span><span class="p">,</span> <span class="n">I0S</span><span class="p">,</span> <span class="n">CCounts</span> <span class="o">=</span> <span class="n">CCounts</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">I20</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> <span class="n">endlmisc</span><span class="o">.</span><span class="n">printWarning</span><span class="p">(</span> <span class="s1">&#39;    WARNING: I20 URR data not currently supported.&#39;</span> <span class="p">)</span>

        <span class="k">if</span><span class="p">(</span> <span class="n">C</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">summands</span> <span class="o">=</span> <span class="p">[</span> <span class="n">sumsModule</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">link</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">crossSection</span> <span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">reactionSuite</span><span class="o">.</span><span class="n">reactions</span> <span class="p">]</span>    <span class="c1"># all other reactions have already been read in</span>
            <span class="n">reaction</span> <span class="o">=</span> <span class="n">sumsModule</span><span class="o">.</span><span class="n">crossSectionSum</span><span class="p">(</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;total&quot;</span><span class="p">,</span> <span class="n">ENDF_MT</span> <span class="o">=</span> <span class="n">MT</span><span class="p">,</span>
                    <span class="n">summands</span> <span class="o">=</span> <span class="n">sumsModule</span><span class="o">.</span><span class="n">listOfSummands</span><span class="p">(</span> <span class="n">summandList</span> <span class="o">=</span> <span class="n">summands</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">iChannel</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">reaction</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">returnConstantQ</span><span class="p">(</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">I0</span><span class="o">.</span><span class="n">getQ</span><span class="p">(</span> <span class="p">),</span> <span class="n">crossSection</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">reaction</span> <span class="o">=</span> <span class="n">reactionModule</span><span class="o">.</span><span class="n">reaction</span><span class="p">(</span> <span class="n">outputChannel</span><span class="p">,</span> <span class="n">ENDF_MT</span> <span class="o">=</span> <span class="n">MT</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="mi">99000</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">ZA</span> <span class="o">&lt;</span> <span class="mi">99200</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">C</span> <span class="o">==</span> <span class="mi">11</span> <span class="p">)</span> <span class="p">:</span> <span class="n">reaction</span><span class="o">.</span><span class="n">process</span> <span class="o">=</span> <span class="s1">&#39;inelastic&#39;</span>
        <span class="k">elif</span><span class="p">(</span> <span class="n">S</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">)</span> <span class="p">:</span> <span class="n">reaction</span><span class="o">.</span><span class="n">process</span> <span class="o">=</span> <span class="s1">&#39;S:2&#39;</span>
        <span class="n">reaction</span><span class="o">.</span><span class="n">crossSection</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">crossSection</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">doubleDifferentialCrossSectionForm</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> <span class="n">reaction</span><span class="o">.</span><span class="n">doubleDifferentialCrossSection</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">doubleDifferentialCrossSectionForm</span> <span class="p">)</span>

        <span class="k">if</span><span class="p">(</span> <span class="n">S</span> <span class="o">==</span> <span class="mi">8</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">reaction</span><span class="o">.</span><span class="n">process</span> <span class="o">=</span> <span class="s2">&quot;ENDL_S8&quot;</span>
        <span class="k">elif</span><span class="p">(</span> <span class="n">C</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">C</span><span class="o">==</span><span class="mi">8</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">findDatas</span><span class="p">(</span> <span class="n">C</span><span class="o">=</span><span class="mi">9</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                <span class="k">continue</span>    <span class="c1"># if both C=8 and C=9 are present, follow C==9 logic</span>

            <span class="c1"># convert cross section / distribution into nuclearPlusInterference instance:</span>

            <span class="n">identicalParticles</span> <span class="o">=</span> <span class="n">target</span> <span class="ow">is</span> <span class="n">projectile</span>
            <span class="n">firstProduct</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">outputChannel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">C</span><span class="o">==</span><span class="mi">9</span> <span class="p">):</span>
                <span class="n">cutoffs</span> <span class="o">=</span> <span class="p">[</span><span class="n">tmp</span><span class="o">.</span><span class="n">trim</span><span class="p">()</span><span class="o">.</span><span class="n">domainMax</span> <span class="k">for</span> <span class="n">tmp</span> <span class="ow">in</span> <span class="n">firstProduct</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">evaluated</span><span class="o">.</span><span class="n">angularSubform</span><span class="p">]</span>
                <span class="n">muCutoff</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span> <span class="n">cutoffs</span> <span class="p">)</span>
                <span class="n">effXsc</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">crossSection</span><span class="o">.</span><span class="n">evaluated</span>
                <span class="n">effDist</span> <span class="o">=</span> <span class="n">firstProduct</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">evaluated</span><span class="o">.</span><span class="n">angularSubform</span>
                <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">effDist</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="n">identicalParticles</span><span class="p">:</span>  <span class="c1"># ENDL covers mu=-cutoff .. cutoff, but only need to store 0 .. cutoff</span>
                        <span class="n">tmpDist</span> <span class="o">=</span> <span class="n">effDist</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">domainSlice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">muCutoff</span><span class="p">)</span>
                        <span class="n">tmpDist</span> <span class="o">=</span> <span class="n">tmpDist</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">tmpDist</span> <span class="o">=</span> <span class="n">effDist</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">domainSlice</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">muCutoff</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span> <span class="n">tmpDist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span>
                            <span class="n">tmpDist</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">muCutoff</span> <span class="o">&gt;</span> <span class="mf">0.9999</span> <span class="p">):</span>   <span class="c1"># Get rid of &#39;blurred edge&#39; at cutoff angle</span>
                        <span class="n">rawDat</span> <span class="o">=</span> <span class="n">tmpDist</span><span class="o">.</span><span class="n">copyDataToXYs</span><span class="p">()</span>
                        <span class="n">rawDat</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">rawDat</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">rawDat</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
                        <span class="n">tmpDist</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span> <span class="n">rawDat</span> <span class="p">)</span>
                    <span class="n">effDist</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmpDist</span>

                <span class="n">NCPI</span> <span class="o">=</span> <span class="n">nuclearPlusInterferenceModule</span><span class="o">.</span><span class="n">nuclearPlusInterference</span><span class="p">(</span> <span class="n">muCutoff</span><span class="o">=</span><span class="n">muCutoff</span><span class="p">,</span>
                        <span class="n">crossSection</span><span class="o">=</span><span class="n">nuclearPlusInterferenceModule</span><span class="o">.</span><span class="n">crossSection</span><span class="p">(</span> <span class="n">effXsc</span><span class="p">),</span>
                        <span class="n">distribution</span><span class="o">=</span><span class="n">nuclearPlusInterferenceModule</span><span class="o">.</span><span class="n">distribution</span><span class="p">(</span> <span class="n">effDist</span><span class="p">)</span>
                        <span class="p">)</span>
                <span class="n">Rutherford</span> <span class="o">=</span> <span class="n">RutherfordScatteringModule</span><span class="o">.</span><span class="n">RutherfordScattering</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>   <span class="c1"># Only have C=8 data. Only give the Rutherford scattering term</span>
                <span class="n">NCPI</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">Rutherford</span> <span class="o">=</span> <span class="n">RutherfordScatteringModule</span><span class="o">.</span><span class="n">RutherfordScattering</span><span class="p">(</span>
                        <span class="n">reaction</span><span class="o">.</span><span class="n">crossSection</span><span class="o">.</span><span class="n">domainMin</span><span class="p">,</span> <span class="n">reaction</span><span class="o">.</span><span class="n">crossSection</span><span class="o">.</span><span class="n">domainMax</span><span class="p">,</span>
                        <span class="n">reaction</span><span class="o">.</span><span class="n">crossSection</span><span class="o">.</span><span class="n">domainUnit</span> <span class="p">)</span>

            <span class="n">CPElastic</span> <span class="o">=</span> <span class="n">CoulombPlusNuclearElasticModule</span><span class="o">.</span><span class="n">form</span><span class="p">(</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">projectile</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">NCPI</span><span class="p">,</span>
                    <span class="n">RutherfordTerm</span> <span class="o">=</span> <span class="n">Rutherford</span><span class="p">,</span> <span class="n">identicalParticles</span><span class="o">=</span><span class="n">identicalParticles</span> <span class="p">)</span>
            <span class="n">reaction</span><span class="o">.</span><span class="n">doubleDifferentialCrossSection</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">CPElastic</span> <span class="p">)</span>
            <span class="n">reaction</span><span class="o">.</span><span class="n">crossSection</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span> <span class="p">)</span>
            <span class="n">reaction</span><span class="o">.</span><span class="n">crossSection</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">crossSectionModule</span><span class="o">.</span><span class="n">CoulombPlusNuclearElastic</span><span class="p">(</span>
                    <span class="n">link</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">doubleDifferentialCrossSection</span><span class="o">.</span><span class="n">evaluated</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">relative</span> <span class="o">=</span> <span class="kc">True</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">firstProduct</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span> <span class="p">)</span>
            <span class="n">firstProduct</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">referenceModule</span><span class="o">.</span><span class="n">CoulombPlusNuclearElastic</span><span class="p">(</span>
                    <span class="n">link</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">doubleDifferentialCrossSection</span><span class="o">.</span><span class="n">evaluated</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">relative</span> <span class="o">=</span> <span class="kc">True</span> <span class="p">)</span> <span class="p">)</span>

            <span class="n">secondProduct</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">outputChannel</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">secondProduct</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">evaluated</span><span class="o">.</span><span class="n">angularSubform</span><span class="o">.</span><span class="n">link</span> <span class="o">=</span> <span class="n">firstProduct</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">evaluated</span>
        <span class="k">elif</span><span class="p">(</span> <span class="n">specialCase</span> <span class="ow">in</span> <span class="p">(</span> <span class="s1">&#39;Be_9(n, 2n)&#39;</span><span class="p">,</span> <span class="s1">&#39;Be_10(n, 3n)&#39;</span><span class="p">,</span> <span class="s1">&#39;Be_11(n, 4n)&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">reaction</span><span class="o">.</span><span class="n">process</span> <span class="o">=</span> <span class="n">specialCase</span>

        <span class="k">if</span><span class="p">(</span> <span class="n">C</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">reactionSuite</span><span class="o">.</span><span class="n">sums</span><span class="o">.</span><span class="n">crossSections</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">reaction</span> <span class="p">)</span>
        <span class="k">elif</span><span class="p">(</span> <span class="n">C</span> <span class="o">==</span> <span class="mi">55</span> <span class="p">)</span> <span class="p">:</span>
            <span class="c1"># wait until all other reactions are done to handle C55</span>
            <span class="n">c55s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">reaction</span> <span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">reactionSuite</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">reaction</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">excludeAverageProductData</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">for</span> <span class="n">yo</span> <span class="ow">in</span> <span class="n">yosDatas</span> <span class="p">:</span>
                <span class="n">datas</span> <span class="o">=</span> <span class="n">yosDatas</span><span class="p">[</span><span class="n">yo</span><span class="p">]</span>
                <span class="n">IsToDelete</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">i1</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="n">datas</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">13</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span> <span class="n">IsToDelete</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span> <span class="n">i1</span> <span class="p">)</span>
                <span class="k">for</span> <span class="n">i1</span> <span class="ow">in</span> <span class="n">IsToDelete</span> <span class="p">:</span> <span class="k">del</span> <span class="n">datas</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">yo</span> <span class="ow">in</span> <span class="n">yosDatas</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="n">yo</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">message</span> <span class="o">=</span> <span class="p">[</span><span class="nb">repr</span><span class="p">(</span><span class="n">yosData</span><span class="p">)</span> <span class="k">for</span> <span class="n">yosData</span> <span class="ow">in</span> <span class="n">yosDatas</span><span class="p">[</span><span class="n">yo</span><span class="p">]]</span>
                <span class="n">endlmisc</span><span class="o">.</span><span class="n">printWarning</span><span class="p">(</span> <span class="s1">&#39;    WARNING: unused data for ZA = </span><span class="si">%d</span><span class="s1">, yo = </span><span class="si">%d</span><span class="se">\n</span><span class="s1">        </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">ZA</span><span class="p">,</span> <span class="n">yo</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">        &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="n">message</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">if</span> <span class="n">c55s</span><span class="p">:</span>
        <span class="c1"># C=55 stores (total xsc)*multiplicity, but we want multiplicity for nonelastic only.</span>
        <span class="c1"># sigma_total * mult_total = sigma_nonelastic * M, so M = (C55 data) / sigma_nonelastic.</span>
        <span class="c1"># Also need to store non-elastic as a cross section sum</span>

        <span class="n">summands</span> <span class="o">=</span> <span class="p">[</span> <span class="n">sumsModule</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">link</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">crossSection</span> <span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">reactionSuite</span><span class="o">.</span><span class="n">reactions</span>
                <span class="k">if</span> <span class="n">r</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">reactionSuite</span><span class="o">.</span><span class="n">getReaction</span><span class="p">(</span><span class="s1">&#39;elastic&#39;</span><span class="p">)</span> <span class="p">]</span>
        <span class="n">nonElastic</span> <span class="o">=</span> <span class="n">sumsModule</span><span class="o">.</span><span class="n">crossSectionSum</span><span class="p">(</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;nonelastic&quot;</span><span class="p">,</span> <span class="n">ENDF_MT</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
                <span class="n">summands</span> <span class="o">=</span> <span class="n">sumsModule</span><span class="o">.</span><span class="n">listOfSummands</span><span class="p">(</span> <span class="n">summandList</span> <span class="o">=</span> <span class="n">summands</span> <span class="p">)</span> <span class="p">)</span>

        <span class="c1"># calculate nonElastic cross section by addition  (total - elastic sometimes has numeric issues)</span>
        <span class="n">nonElasticXSec</span> <span class="o">=</span> <span class="n">summands</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">evaluated</span> <span class="o">+</span> <span class="n">PQUModule</span><span class="o">.</span><span class="n">PQU</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>   <span class="c1"># FIXME hack since copy() not implemented!</span>
        <span class="k">for</span> <span class="n">summand</span> <span class="ow">in</span> <span class="n">summands</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">addend</span> <span class="o">=</span> <span class="n">summand</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">evaluated</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">nonElasticXSec</span><span class="o">.</span><span class="n">areDomainsMutual</span><span class="p">(</span> <span class="n">addend</span> <span class="p">):</span>
                <span class="n">nonElasticXSec</span><span class="p">,</span> <span class="n">addend</span> <span class="o">=</span> <span class="n">nonElasticXSec</span><span class="o">.</span><span class="n">mutualify</span><span class="p">(</span> <span class="o">-</span><span class="mf">1e-7</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">addend</span><span class="p">,</span> <span class="o">-</span><span class="mf">1e-7</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span> <span class="p">)</span>
            <span class="n">nonElasticXSec</span> <span class="o">+=</span> <span class="n">addend</span>

        <span class="n">nonElasticXSec</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">nonElasticXSec</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span>
        <span class="n">nonElastic</span><span class="o">.</span><span class="n">crossSection</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">nonElasticXSec</span> <span class="p">)</span>
        <span class="n">nonElastic</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">returnConstantQ</span><span class="p">(</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">crossSection</span> <span class="p">)</span> <span class="p">)</span>
        <span class="n">reactionSuite</span><span class="o">.</span><span class="n">sums</span><span class="o">.</span><span class="n">crossSections</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">nonElastic</span> <span class="p">)</span>

        <span class="k">for</span> <span class="n">i1</span><span class="p">,</span> <span class="n">C55</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="n">c55s</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">gammaProduction</span> <span class="o">=</span> <span class="n">reactionModule</span><span class="o">.</span><span class="n">reaction</span><span class="p">(</span> <span class="n">outputChannel</span> <span class="o">=</span> <span class="n">C55</span><span class="o">.</span><span class="n">outputChannel</span><span class="p">,</span> <span class="n">ENDF_MT</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span> <span class="n">i1</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">gammaProduction</span><span class="o">.</span><span class="n">crossSection</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">crossSectionModule</span><span class="o">.</span><span class="n">reference</span><span class="p">(</span> <span class="n">link</span> <span class="o">=</span> <span class="n">nonElastic</span><span class="o">.</span><span class="n">crossSection</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">gammaProduction</span><span class="o">.</span><span class="n">outputChannel</span><span class="o">.</span><span class="n">products</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">multiplicity</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span> <span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">nonElasticXSec</span><span class="o">.</span><span class="n">areDomainsMutual</span><span class="p">(</span> <span class="n">C55</span><span class="o">.</span><span class="n">crossSection</span><span class="o">.</span><span class="n">evaluated</span> <span class="p">):</span>
                <span class="n">num</span><span class="p">,</span> <span class="n">den</span> <span class="o">=</span> <span class="n">C55</span><span class="o">.</span><span class="n">crossSection</span><span class="o">.</span><span class="n">evaluated</span><span class="o">.</span><span class="n">mutualify</span><span class="p">(</span><span class="o">-</span><span class="mf">1e-8</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">nonElasticXSec</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">newMultiplicity</span> <span class="o">=</span> <span class="n">num</span> <span class="o">/</span> <span class="n">den</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">newMultiplicity</span> <span class="o">=</span> <span class="n">C55</span><span class="o">.</span><span class="n">crossSection</span><span class="o">.</span><span class="n">evaluated</span> <span class="o">/</span> <span class="n">nonElasticXSec</span>
            <span class="n">newMultiplicity</span> <span class="o">=</span> <span class="n">multiplicityModule</span><span class="o">.</span><span class="n">XYs1d</span><span class="p">(</span> <span class="n">data</span> <span class="o">=</span> <span class="n">newMultiplicity</span><span class="o">.</span><span class="n">thin</span><span class="p">(</span> <span class="mf">0.001</span> <span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> 
                    <span class="n">axes</span> <span class="o">=</span> <span class="n">multiplicityAxes</span> <span class="p">)</span>
            <span class="n">gammaProduction</span><span class="o">.</span><span class="n">outputChannel</span><span class="o">.</span><span class="n">products</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">multiplicity</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">newMultiplicity</span> <span class="p">)</span>
            <span class="n">reactionSuite</span><span class="o">.</span><span class="n">orphanProducts</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">gammaProduction</span> <span class="p">)</span>

    <span class="k">if</span><span class="p">(</span> <span class="n">isThermalNeutronScatteringLaw</span> <span class="p">)</span> <span class="p">:</span>
        <span class="n">TNSLStyle</span> <span class="o">=</span> <span class="n">gnds</span><span class="o">.</span><span class="n">miscellaneous</span><span class="o">.</span><span class="n">style</span><span class="p">(</span><span class="s1">&#39;ENDL_TNSL&#39;</span><span class="p">,</span>       <span class="c1"># FIXME this logic is broken. Need to revisit thermal scattering law translation</span>
                <span class="n">attributes</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;target&#39;</span> <span class="p">:</span> <span class="n">targetName</span><span class="o">.</span><span class="n">split</span><span class="p">(</span> <span class="s1">&#39;_&#39;</span> <span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;energyMax&#39;</span> <span class="p">:</span> <span class="n">TNSL_EMax</span> <span class="p">}</span> <span class="p">)</span>
        <span class="n">reactionSuite</span><span class="o">.</span><span class="n">styles</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">TNSLStyle</span> <span class="p">)</span>

    <span class="n">documentation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDocumentation</span><span class="p">()</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">documentation</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">)</span> <span class="p">:</span> <span class="n">documentation</span> <span class="o">=</span> <span class="s2">&quot;No documentation!&quot;</span>
    <span class="n">docs</span> <span class="o">=</span> <span class="n">gnds</span><span class="o">.</span><span class="n">documentation</span><span class="o">.</span><span class="n">documentation</span><span class="p">(</span><span class="s2">&quot;ENDL&quot;</span><span class="p">,</span> <span class="n">documentation</span><span class="p">)</span>
    <span class="n">reactionSuite</span><span class="o">.</span><span class="n">addDocumentation</span><span class="p">(</span> <span class="n">docs</span> <span class="p">)</span>

    <span class="c1"># Fix incident energy domain limits:</span>
    <span class="n">evaluatedStyle</span><span class="o">.</span><span class="n">projectileEnergyDomain</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span>
        <span class="p">[</span><span class="n">reac</span><span class="o">.</span><span class="n">crossSection</span><span class="o">.</span><span class="n">domainMin</span> <span class="k">for</span> <span class="n">reac</span> <span class="ow">in</span> <span class="n">reactionSuite</span><span class="o">.</span><span class="n">reactions</span><span class="p">])</span>
    <span class="n">evaluatedStyle</span><span class="o">.</span><span class="n">projectileEnergyDomain</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span>
        <span class="p">[</span><span class="n">reac</span><span class="o">.</span><span class="n">crossSection</span><span class="o">.</span><span class="n">domainMax</span> <span class="k">for</span> <span class="n">reac</span> <span class="ow">in</span> <span class="n">reactionSuite</span><span class="o">.</span><span class="n">reactions</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="n">reactionSuite</span><span class="o">.</span><span class="n">reactions</span> <span class="p">:</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">addUnspecifiedDistributions</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">reaction</span><span class="o">.</span><span class="n">outputChannel</span> <span class="p">)</span>
    <span class="k">for</span> <span class="n">production</span> <span class="ow">in</span> <span class="n">reactionSuite</span><span class="o">.</span><span class="n">productions</span> <span class="p">:</span> <span class="n">toGNDSMiscModule</span><span class="o">.</span><span class="n">addUnspecifiedDistributions</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">production</span><span class="o">.</span><span class="n">outputChannel</span> <span class="p">)</span>

    <span class="k">for</span> <span class="n">chemicalElement</span> <span class="ow">in</span> <span class="n">reactionSuite</span><span class="o">.</span><span class="n">PoPs</span><span class="o">.</span><span class="n">chemicalElements</span> <span class="p">:</span>
        <span class="k">for</span> <span class="n">isotope</span> <span class="ow">in</span> <span class="n">chemicalElement</span> <span class="p">:</span>
            <span class="n">nuclide</span> <span class="o">=</span> <span class="n">isotope</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">nuclide</span><span class="o">.</span><span class="n">mass</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="k">continue</span>
            <span class="n">ZA</span> <span class="o">=</span> <span class="n">chemicalElementMiscPoPsModule</span><span class="o">.</span><span class="n">ZA</span><span class="p">(</span> <span class="n">nuclide</span> <span class="p">)</span>
            <span class="n">mass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bdflsFile</span><span class="o">.</span><span class="n">mass</span><span class="p">(</span> <span class="n">ZA</span> <span class="p">)</span>
            <span class="n">mass</span> <span class="o">=</span> <span class="n">massPoPsModule</span><span class="o">.</span><span class="n">double</span><span class="p">(</span> <span class="n">info</span><span class="o">.</span><span class="n">PoPsLabel</span><span class="p">,</span> <span class="n">mass</span><span class="p">,</span> <span class="n">quantityPoPsModule</span><span class="o">.</span><span class="n">stringToPhysicalUnit</span><span class="p">(</span> <span class="s1">&#39;amu&#39;</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">nuclide</span><span class="o">.</span><span class="n">mass</span><span class="o">.</span><span class="n">add</span><span class="p">(</span> <span class="n">mass</span> <span class="p">)</span>

    <span class="k">return</span><span class="p">(</span> <span class="n">reactionSuite</span> <span class="p">)</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../../index.html">
              <img class="logo" src="../../../../_static/gnd.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">Fudge and GNDS 4.2.3 beta documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2012, B.Beck, D. Brown, C. Mattoon, N. Patel, N. Summers.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.3.
    </div>
  </body>
</html>