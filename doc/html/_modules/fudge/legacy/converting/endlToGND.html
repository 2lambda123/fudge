
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>fudge.legacy.converting.endlToGND &mdash; Fudge and GND 1.2 beta documentation</title>
    
    <link rel="stylesheet" href="../../../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '1.2 beta',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../../../_static/gnd-20121206-favicon.ico"/>
    <link rel="top" title="Fudge and GND 1.2 beta documentation" href="../../../../index.html" />
    <link rel="up" title="Module code" href="../../../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../../index.html">Fudge and GND 1.2 beta documentation</a> &raquo;</li>
          <li><a href="../../../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for fudge.legacy.converting.endlToGND</h1><div class="highlight"><pre>
<span class="c"># &lt;&lt;BEGIN-copyright&gt;&gt;</span>
<span class="c"># &lt;&lt;END-copyright&gt;&gt;</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This module contains the method toGND for the class endlZA. This module must only be import by the</span>
<span class="sd">toGND method of the endlZA class.</span>

<span class="sd">Nuclear particle name: Name depends on whether natural or specific isotope as follows,</span>
<span class="sd">    isotope: An isotope&#39;s name is composed of SA[_L]</span>
<span class="sd">        S is the element&#39;s symbol (e.g., &#39;He&#39; for helium).</span>
<span class="sd">        A is the nucleon number (e.g., &#39;He4&#39; for He-4).</span>
<span class="sd">        L is an optional level designation (e.g., &#39;O16_e3&#39; for the third excition state of O16).</span>
<span class="sd">            The level name can be an excitation level designation (e.g., &#39;e#&#39;), a metastable </span>
<span class="sd">            designation (e.g., &#39;m#&#39;), or an unknown designation (i.e., &#39;c&#39;) where &#39;#&#39; is an </span>
<span class="sd">            integer (e.g., &#39;e2&#39; or &#39;m1&#39; for the second excited state of &#39;Am242&#39;).</span>
<span class="sd">    natural: A natural&#39;s name is composed of SA[_L] (see above for meanings of S, A and L except A is</span>
<span class="sd">            always &#39;natural&#39;.</span>

<span class="sd">gamma: name is simply given as &#39;gamma&#39;.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">copy</span>

<span class="kn">from</span> <span class="nn">pqu</span> <span class="kn">import</span> <span class="n">physicalQuantityWithUncertainty</span>
<span class="kn">from</span> <span class="nn">fudge.core.math.xData</span> <span class="kn">import</span> <span class="n">axes</span><span class="p">,</span> <span class="n">XYs</span><span class="p">,</span> <span class="n">W_XYs</span>
<span class="kn">from</span> <span class="nn">fudge</span> <span class="kn">import</span> <span class="n">gnd</span>
<span class="kn">from</span> <span class="nn">fudge.gnd.productData</span> <span class="kn">import</span> <span class="n">distributions</span>
<span class="kn">from</span> <span class="nn">fudge.structure</span> <span class="kn">import</span> <span class="n">masses</span> <span class="k">as</span> <span class="n">massModule</span>
<span class="kn">from</span> <span class="nn">fudge.legacy.endl</span> <span class="kn">import</span> <span class="p">(</span><span class="n">endl2</span><span class="p">,</span> <span class="n">endlmisc</span><span class="p">,</span> <span class="n">endl_C</span><span class="p">,</span> <span class="n">endl_y</span><span class="p">,</span> <span class="n">endlIClasses</span><span class="p">,)</span>
<span class="kn">import</span> <span class="nn">endf_endl</span>

<span class="n">ENDL_Accuracy</span> <span class="o">=</span> <span class="mf">1e-3</span>
<span class="n">FUDGE_EPS</span> <span class="o">=</span> <span class="mf">1e-8</span>

<span class="n">linlinInterpolation</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">interpolationXY</span><span class="p">(</span> <span class="n">axes</span><span class="o">.</span><span class="n">linearToken</span><span class="p">,</span> <span class="n">axes</span><span class="o">.</span><span class="n">linearToken</span> <span class="p">)</span>
<span class="n">linlinUnitbaseInterpolation</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">interpolationXY</span><span class="p">(</span> <span class="n">axes</span><span class="o">.</span><span class="n">linearToken</span><span class="p">,</span> <span class="n">axes</span><span class="o">.</span><span class="n">linearToken</span><span class="p">,</span> <span class="n">axes</span><span class="o">.</span><span class="n">unitBaseToken</span> <span class="p">)</span>
<div class="viewcode-block" id="getXYInterpolation"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.converting.html#fudge.legacy.converting.endlToGND.getXYInterpolation">[docs]</a><span class="k">def</span> <span class="nf">getXYInterpolation</span><span class="p">(</span> <span class="n">data</span> <span class="p">)</span> <span class="p">:</span>

    <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="mi">2</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s">&#39;Only 2 column data supported, # of columns = </span><span class="si">%s</span><span class="s"> for </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span> <span class="n">data</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">interpolation</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="n">axes</span><span class="o">.</span><span class="n">linearToken</span><span class="p">,</span> <span class="n">axes</span><span class="o">.</span><span class="n">linearToken</span><span class="p">,</span> <span class="p">)</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">interpolation</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="n">axes</span><span class="o">.</span><span class="n">logToken</span><span class="p">,</span>    <span class="n">axes</span><span class="o">.</span><span class="n">linearToken</span> <span class="p">)</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">interpolation</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="n">axes</span><span class="o">.</span><span class="n">linearToken</span><span class="p">,</span> <span class="n">axes</span><span class="o">.</span><span class="n">logToken</span> <span class="p">)</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">interpolation</span> <span class="o">==</span> <span class="mi">3</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="n">axes</span><span class="o">.</span><span class="n">logToken</span><span class="p">,</span>    <span class="n">axes</span><span class="o">.</span><span class="n">logToken</span> <span class="p">)</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s">&#39;Unsupported interpolation = &quot;</span><span class="si">%s</span><span class="s">&quot; for </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">interpolation</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span> <span class="n">data</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
</div>
<div class="viewcode-block" id="infos"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.converting.html#fudge.legacy.converting.endlToGND.infos">[docs]</a><span class="k">class</span> <span class="nc">infos</span> <span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">xenslIsotopes</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">transportables</span> <span class="o">=</span> <span class="p">[]</span> <span class="p">)</span> <span class="p">:</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">masses</span> <span class="o">=</span> <span class="n">massModule</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xenslIsotopes</span> <span class="o">=</span> <span class="n">xenslIsotopes</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">xenslIsotopes</span> <span class="ow">is</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">xenslIsotopes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transportables</span> <span class="o">=</span> <span class="n">transportables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">particleList</span> <span class="o">=</span> <span class="n">gnd</span><span class="o">.</span><span class="n">xParticleList</span><span class="o">.</span><span class="n">xParticleList</span><span class="p">(</span> <span class="p">)</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">newIndices</span><span class="p">(</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ZAMasses</span> <span class="o">=</span> <span class="p">{}</span>

<div class="viewcode-block" id="infos.newIndices"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.converting.html#fudge.legacy.converting.endlToGND.infos.newIndices">[docs]</a>    <span class="k">def</span> <span class="nf">newIndices</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">indices</span> <span class="o">=</span> <span class="n">tokenAndIndices</span><span class="p">(</span> <span class="p">)</span>
</div>
<div class="viewcode-block" id="infos.setReactionSuite"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.converting.html#fudge.legacy.converting.endlToGND.infos.setReactionSuite">[docs]</a>    <span class="k">def</span> <span class="nf">setReactionSuite</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">reactionSuite</span> <span class="p">)</span>  <span class="p">:</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">reactionSuite</span> <span class="o">=</span> <span class="n">reactionSuite</span>
</div></div>
<div class="viewcode-block" id="getTypeName"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.converting.html#fudge.legacy.converting.endlToGND.getTypeName">[docs]</a><span class="k">def</span> <span class="nf">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">ZA</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">levelIndex</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">levelUnit</span> <span class="o">=</span> <span class="s">&#39;MeV&#39;</span><span class="p">,</span> <span class="n">metaStableIndex</span> <span class="o">=</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns the name for this ZA and level if present. Returned name is of the form Am_242, Am_242_m1, Am_242_e2.</span>
<span class="sd">    levelIndex must be None, &#39;c&#39;, &#39;s&#39; or an integer &gt; 0.&quot;&quot;&quot;</span>

    <span class="k">if</span><span class="p">(</span> <span class="n">levelIndex</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span> <span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="s">&#39;s&#39;</span><span class="p">,</span> <span class="bp">None</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
        <span class="n">levelIndex</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">levelIndex</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">levelIndex</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s">&#39;levelIndex = </span><span class="si">%d</span><span class="s"> must be &gt;= 0&#39;</span> <span class="o">%</span> <span class="n">levelIndex</span> <span class="p">)</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">ZA</span> <span class="o">==</span> <span class="mi">17</span> <span class="p">)</span> <span class="p">:</span> <span class="n">ZA</span> <span class="o">=</span> <span class="mi">7</span>
    <span class="n">particleType</span><span class="p">,</span> <span class="n">particleQualifiers</span> <span class="o">=</span> <span class="n">gnd</span><span class="o">.</span><span class="n">xParticle</span><span class="o">.</span><span class="n">particleType_Nuclear</span><span class="p">,</span> <span class="p">{}</span> <span class="c"># Default values.</span>
    <span class="k">if</span><span class="p">(</span> <span class="ow">not</span> <span class="p">(</span> <span class="n">name</span> <span class="ow">is</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> 
        <span class="k">pass</span>
    <span class="k">elif</span><span class="p">(</span> <span class="n">ZA</span> <span class="o">==</span> <span class="mi">7</span> <span class="p">)</span> <span class="p">:</span> 
        <span class="n">particleType</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="n">gnd</span><span class="o">.</span><span class="n">xParticle</span><span class="o">.</span><span class="n">particleType_Photon</span><span class="p">,</span> <span class="s">&#39;gamma&#39;</span>
    <span class="k">elif</span><span class="p">(</span> <span class="n">ZA</span> <span class="o">==</span> <span class="mi">9</span> <span class="p">)</span> <span class="p">:</span>
        <span class="n">particleType</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="n">gnd</span><span class="o">.</span><span class="n">xParticle</span><span class="o">.</span><span class="n">particleType_Lepton</span><span class="p">,</span> <span class="s">&#39;electron&#39;</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">endl2</span><span class="o">.</span><span class="n">endlToGNDName</span><span class="p">(</span> <span class="n">ZA</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">levelIndex</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span> <span class="bp">None</span><span class="p">,</span> <span class="mi">0</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">level</span> <span class="o">&lt;</span> <span class="mf">0.</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s">&#39;Negative value = </span><span class="si">%s</span><span class="s"> for continuum is not allowed&#39;</span> <span class="o">%</span> <span class="n">level</span> <span class="p">)</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">levelIndex</span> <span class="ow">in</span> <span class="p">[</span> <span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="s">&#39;s&#39;</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span>        <span class="c"># to continuum or sum of all levels.</span>
                <span class="n">particleQualifiers</span><span class="p">[</span><span class="s">&#39;level&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gnd</span><span class="o">.</span><span class="n">miscellaneous</span><span class="o">.</span><span class="n">undefinedLevel</span><span class="p">(</span> <span class="n">physicalQuantityWithUncertainty</span><span class="o">.</span><span class="n">PhysicalQuantityWithUncertainty</span><span class="p">(</span> <span class="n">level</span><span class="p">,</span> <span class="n">levelUnit</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">name</span> <span class="o">+=</span> <span class="s">&quot;_</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">levelIndex</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="n">particleQualifiers</span><span class="p">[</span><span class="s">&#39;level&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">physicalQuantityWithUncertainty</span><span class="o">.</span><span class="n">PhysicalQuantityWithUncertainty</span><span class="p">(</span> <span class="n">level</span><span class="p">,</span> <span class="n">levelUnit</span> <span class="p">)</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">metaStableIndex</span> <span class="ow">is</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">levelIndex</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="n">name</span> <span class="o">+=</span> <span class="s">&#39;_e</span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">levelIndex</span>
                <span class="k">else</span> <span class="p">:</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">metaStableIndex</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="n">name</span> <span class="o">+=</span> <span class="s">&#39;_m</span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">metaStableIndex</span>
    <span class="k">if</span><span class="p">(</span> <span class="ow">not</span><span class="p">(</span> <span class="n">info</span><span class="o">.</span><span class="n">particleList</span><span class="o">.</span><span class="n">hasParticle</span><span class="p">(</span> <span class="n">name</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">ZA</span> <span class="ow">in</span> <span class="n">info</span><span class="o">.</span><span class="n">ZAMasses</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="ow">not</span><span class="p">(</span> <span class="n">info</span><span class="o">.</span><span class="n">ZAMasses</span><span class="p">[</span><span class="n">ZA</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">info</span><span class="o">.</span><span class="n">ZAMasses</span><span class="p">[</span><span class="n">ZA</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">info</span><span class="o">.</span><span class="n">ZAMasses</span><span class="p">[</span><span class="n">ZA</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">mass</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">ZAMasses</span><span class="p">[</span><span class="n">ZA</span><span class="p">]</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">mass</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">masses</span><span class="o">.</span><span class="n">getMassFromZA</span><span class="p">(</span> <span class="n">ZA</span> <span class="p">)</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">mass</span> <span class="o">==</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span>                                        <span class="c"># If mass is not found, let&#39;s attempt to make something up that is close.</span>
                <span class="n">A</span> <span class="o">=</span> <span class="n">ZA</span> <span class="o">%</span> <span class="mi">1000</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">A</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="n">massLower</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">masses</span><span class="o">.</span><span class="n">getMassFromZA</span><span class="p">(</span> <span class="n">ZA</span> <span class="o">-</span> <span class="n">i</span> <span class="p">)</span>
                    <span class="n">massHigher</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">masses</span><span class="o">.</span><span class="n">getMassFromZA</span><span class="p">(</span> <span class="n">ZA</span> <span class="o">+</span> <span class="n">i</span> <span class="p">)</span>
                    <span class="k">if</span><span class="p">(</span> <span class="ow">not</span><span class="p">(</span> <span class="n">massLower</span> <span class="ow">is</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                        <span class="n">mass</span> <span class="o">=</span> <span class="n">massLower</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">info</span><span class="o">.</span><span class="n">masses</span><span class="o">.</span><span class="n">getMassFromZA</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>
                        <span class="k">break</span>
                    <span class="k">elif</span><span class="p">(</span> <span class="ow">not</span><span class="p">(</span> <span class="n">massHigher</span> <span class="ow">is</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                        <span class="n">mass</span> <span class="o">=</span> <span class="n">massHigher</span> <span class="o">-</span> <span class="n">i</span> <span class="o">*</span> <span class="n">info</span><span class="o">.</span><span class="n">masses</span><span class="o">.</span><span class="n">getMassFromZA</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>
                        <span class="k">break</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">mass</span> <span class="o">==</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s">&#39;Could not obtain mass for ZA = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">ZA</span> <span class="p">)</span>
                <span class="n">mass</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">mass</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>    <span class="c"># since we&#39;re extrapolating</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">mass</span> <span class="ow">is</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">massUnit</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">massUnit</span> <span class="o">=</span> <span class="n">physicalQuantityWithUncertainty</span><span class="o">.</span><span class="n">PhysicalQuantityWithUncertainty</span><span class="p">(</span> <span class="n">mass</span><span class="p">,</span> <span class="s">&#39;amu&#39;</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">info</span><span class="o">.</span><span class="n">transportables</span> <span class="p">)</span> <span class="p">:</span> <span class="n">particleQualifiers</span><span class="p">[</span><span class="s">&#39;transportable&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;true&#39;</span>
        <span class="k">if</span><span class="p">(</span> <span class="ow">not</span><span class="p">(</span> <span class="n">levelIndex</span> <span class="ow">is</span> <span class="bp">None</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">levelIndex</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">particleQualifiers</span><span class="p">[</span><span class="s">&#39;levelIndex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">levelIndex</span>
        <span class="k">if</span><span class="p">(</span> <span class="ow">not</span><span class="p">(</span> <span class="n">metaStableIndex</span> <span class="ow">is</span> <span class="bp">None</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">metaStableIndex</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">particleQualifiers</span><span class="p">[</span><span class="s">&#39;metaStableIndex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">metaStableIndex</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span> <span class="s">&#39;n&#39;</span><span class="p">,</span> <span class="s">&#39;H1&#39;</span><span class="p">,</span> <span class="s">&#39;H2&#39;</span><span class="p">,</span> <span class="s">&#39;H3&#39;</span><span class="p">,</span> <span class="s">&#39;He3&#39;</span><span class="p">,</span> <span class="s">&#39;He4&#39;</span><span class="p">,</span> <span class="s">&#39;gamma&#39;</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span> <span class="n">particleQualifiers</span><span class="p">[</span><span class="s">&#39;transportable&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;true&#39;</span>

        <span class="k">if</span><span class="p">(</span> <span class="n">particleQualifiers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span> <span class="s">&#39;level&#39;</span> <span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span>                   <span class="c"># Add new particle or level.</span>
            <span class="c"># careful, always need to add ground state before excited level:</span>
            <span class="n">baseName</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span><span class="p">(</span> <span class="s">&#39;natural&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">baseName</span> <span class="o">=</span> <span class="s">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)[:</span><span class="mi">2</span><span class="p">]</span> <span class="p">)</span>
            <span class="k">elif</span><span class="p">(</span> <span class="s">&quot;FissionProduct&quot;</span> <span class="ow">in</span> <span class="n">name</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">baseName</span> <span class="o">=</span> <span class="s">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)[:</span><span class="mi">2</span><span class="p">]</span> <span class="p">)</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">baseName</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">info</span><span class="o">.</span><span class="n">particleList</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">info</span><span class="o">.</span><span class="n">particleList</span><span class="o">.</span><span class="n">addParticle</span><span class="p">(</span> <span class="n">gnd</span><span class="o">.</span><span class="n">xParticle</span><span class="o">.</span><span class="n">xParticle</span><span class="p">(</span> <span class="n">baseName</span><span class="p">,</span> <span class="n">particleType</span><span class="p">,</span> <span class="n">mass</span> <span class="o">=</span> <span class="n">massUnit</span><span class="p">,</span> <span class="n">attributes</span><span class="o">=</span><span class="p">{}</span> <span class="p">)</span> <span class="p">)</span>
            <span class="c"># now ground state is present, add excited state</span>
            <span class="k">if</span><span class="p">(</span> <span class="s">&#39;levelIndex&#39;</span> <span class="ow">in</span> <span class="n">particleQualifiers</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">index</span> <span class="o">=</span> <span class="n">particleQualifiers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;levelIndex&#39;</span><span class="p">)</span>
            <span class="k">elif</span><span class="p">(</span> <span class="n">particleQualifiers</span><span class="p">[</span><span class="s">&#39;level&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">getValueAs</span><span class="p">(</span> <span class="s">&#39;MeV&#39;</span> <span class="p">)</span> <span class="o">==</span> <span class="s">&#39;0.&#39;</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s">&#39;Index could not be determined for name = &quot;</span><span class="si">%s</span><span class="s">&quot;, level = &quot;</span><span class="si">%s</span><span class="s">&quot;, levelIndex = &quot;</span><span class="si">%s</span><span class="s">&quot;&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">name</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">levelIndex</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">energy</span> <span class="o">=</span> <span class="n">particleQualifiers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span> <span class="s">&#39;level&#39;</span> <span class="p">)</span>
            <span class="n">particleOrLevel</span> <span class="o">=</span> <span class="n">gnd</span><span class="o">.</span><span class="n">xParticle</span><span class="o">.</span><span class="n">nuclearLevel</span><span class="p">(</span> <span class="n">name</span><span class="p">,</span> <span class="n">energy</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">attributes</span> <span class="o">=</span> <span class="n">particleQualifiers</span> <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">particleOrLevel</span> <span class="o">=</span> <span class="n">gnd</span><span class="o">.</span><span class="n">xParticle</span><span class="o">.</span><span class="n">xParticle</span><span class="p">(</span> <span class="n">name</span><span class="p">,</span> <span class="n">particleType</span><span class="p">,</span> <span class="n">mass</span> <span class="o">=</span> <span class="n">massUnit</span><span class="p">,</span> <span class="n">attributes</span> <span class="o">=</span> <span class="n">particleQualifiers</span> <span class="p">)</span>
        <span class="n">info</span><span class="o">.</span><span class="n">particleList</span><span class="o">.</span><span class="n">addParticle</span><span class="p">(</span> <span class="n">particleOrLevel</span> <span class="p">)</span>

    <span class="k">return</span><span class="p">(</span> <span class="n">info</span><span class="o">.</span><span class="n">particleList</span><span class="o">.</span><span class="n">getParticle</span><span class="p">(</span> <span class="n">name</span> <span class="p">)</span> <span class="p">)</span>
</div>
<div class="viewcode-block" id="newGNDParticle"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.converting.html#fudge.legacy.converting.endlToGND.newGNDParticle">[docs]</a><span class="k">def</span> <span class="nf">newGNDParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">particle</span><span class="p">,</span> <span class="n">attributes</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">multiplicity</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">decayChannel</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> 
        <span class="n">ancestryName</span> <span class="o">=</span> <span class="s">&#39;product&#39;</span> <span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;The arguments to this function must match those of product.product excluding self and label.&quot;&quot;&quot;</span>

    <span class="n">label</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">indices</span><span class="o">.</span><span class="n">getLabel</span><span class="p">(</span> <span class="n">particle</span><span class="o">.</span><span class="n">getToken</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span>
    <span class="k">return</span><span class="p">(</span> <span class="n">gnd</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">product</span><span class="p">(</span> <span class="n">particle</span><span class="p">,</span> <span class="n">ancestryName</span> <span class="o">=</span> <span class="n">ancestryName</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">label</span><span class="p">,</span> <span class="n">attributes</span> <span class="o">=</span> <span class="n">attributes</span><span class="p">,</span>
        <span class="n">multiplicity</span> <span class="o">=</span> <span class="n">multiplicity</span><span class="p">,</span> <span class="n">decayChannel</span> <span class="o">=</span> <span class="n">decayChannel</span> <span class="p">)</span> <span class="p">)</span>
</div>
<div class="viewcode-block" id="tokenAndIndices"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.converting.html#fudge.legacy.converting.endlToGND.tokenAndIndices">[docs]</a><span class="k">class</span> <span class="nc">tokenAndIndices</span> <span class="p">:</span>

    <span class="n">suffixCharacters</span> <span class="o">=</span> <span class="s">&#39;abcdefghijklmnopqrstuvwxyz&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tokens</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delayedFissionNeutron</span> <span class="o">=</span> <span class="bp">False</span>

<div class="viewcode-block" id="tokenAndIndices.getLabel"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.converting.html#fudge.legacy.converting.endlToGND.tokenAndIndices.getLabel">[docs]</a>    <span class="k">def</span> <span class="nf">getLabel</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">token</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">delayedFissionNeutron</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">token</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokens</span> <span class="p">)</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokens</span><span class="p">[</span><span class="n">token</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tokens</span><span class="p">[</span><span class="n">token</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span><span class="p">(</span> <span class="n">token</span> <span class="o">+</span> <span class="s">&#39;__&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">suffixCharacters</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tokens</span><span class="p">[</span><span class="n">token</span><span class="p">]]</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">token</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokens</span> <span class="p">)</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tokens</span><span class="p">[</span><span class="n">token</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">return</span><span class="p">(</span> <span class="n">token</span> <span class="p">)</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokens</span><span class="p">[</span><span class="n">token</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tokens</span><span class="p">[</span><span class="n">token</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">suffix</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
        <span class="k">while</span><span class="p">(</span> <span class="bp">True</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">index1</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">index</span> <span class="o">%</span> <span class="mi">26</span><span class="p">,</span> <span class="n">index</span> <span class="o">/</span> <span class="mi">26</span>
            <span class="n">suffix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">suffixCharacters</span><span class="p">[</span><span class="n">index1</span><span class="p">]</span> <span class="o">+</span> <span class="n">suffix</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="k">break</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">token</span> <span class="o">+</span> <span class="s">&#39;__&#39;</span> <span class="o">+</span> <span class="n">suffix</span> <span class="p">)</span>
</div></div>
<div class="viewcode-block" id="returnConstantQ"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.converting.html#fudge.legacy.converting.endlToGND.returnConstantQ">[docs]</a><span class="k">def</span> <span class="nf">returnConstantQ</span><span class="p">(</span> <span class="n">Q_MeV</span> <span class="p">)</span> <span class="p">:</span>

    <span class="k">return</span><span class="p">(</span> <span class="n">gnd</span><span class="o">.</span><span class="n">channelData</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">component</span><span class="p">(</span> <span class="n">gnd</span><span class="o">.</span><span class="n">channelData</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span> <span class="n">physicalQuantityWithUncertainty</span><span class="o">.</span><span class="n">PhysicalQuantityWithUncertainty</span><span class="p">(</span> <span class="n">Q_MeV</span><span class="p">,</span> <span class="s">&#39;MeV&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
</div>
<div class="viewcode-block" id="toGND"><a class="viewcode-back" href="../../../../fudge/fudge.legacy.converting.html#fudge.legacy.converting.endlToGND.toGND">[docs]</a><span class="k">def</span> <span class="nf">toGND</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">xenslIsotopes</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">testing</span> <span class="o">=</span> <span class="bp">False</span> <span class="p">)</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns an gnd.reactionSuite.reactionSuite for self where self is an endlZA class.&quot;&quot;&quot;</span>
<span class="c">#</span>
<span class="c">#   A discrete N-body reaction is one where all the yo&#39;s are known and they have energy independent multiplicities.</span>
<span class="c">#</span>
    <span class="k">def</span> <span class="nf">getDistributionIs</span><span class="p">(</span> <span class="n">yo</span><span class="p">,</span> <span class="n">yosDatas</span> <span class="p">)</span> <span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Gets the list of I-values matching the list [ 1, 3, 4, 7, 9 ] for yo.&quot;&quot;&quot;</span>

        <span class="n">Is</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">yosDatas</span><span class="p">[</span><span class="n">yo</span><span class="p">]</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="ow">in</span> <span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">Is</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">Is</span> <span class="p">)</span>

    <span class="k">def</span> <span class="nf">getIDistributionData</span><span class="p">(</span> <span class="n">yo</span><span class="p">,</span> <span class="n">yosDatas</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return the data for the requested yo/I/S or None if not data present.&quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">yosDatas</span><span class="p">[</span><span class="n">yo</span><span class="p">]</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">S</span> <span class="o">==</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span> <span class="n">S</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">S</span>
            <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="n">I</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">S</span> <span class="o">==</span> <span class="n">S</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="n">data</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="bp">None</span> <span class="p">)</span>

    <span class="k">def</span> <span class="nf">getAllDistributionIs</span><span class="p">(</span> <span class="n">yoDatas</span><span class="p">,</span> <span class="n">IMax</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span> <span class="n">IExtras</span> <span class="o">=</span> <span class="p">[]</span> <span class="p">)</span> <span class="p">:</span>

        <span class="n">Is</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">yoData</span> <span class="ow">in</span> <span class="n">yoDatas</span> <span class="p">:</span>
            <span class="n">I</span> <span class="o">=</span> <span class="n">yoData</span><span class="o">.</span><span class="n">I</span>
            <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="p">(</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">IExtras</span> <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span> <span class="n">I</span> <span class="o">&lt;=</span> <span class="n">IMax</span> <span class="p">)</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">I</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">Is</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">Is</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">I</span> <span class="p">)</span>
        <span class="n">Is</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">Is</span> <span class="p">)</span>

    <span class="k">def</span> <span class="nf">isYoAndResidaulDataTheSame</span><span class="p">(</span> <span class="n">yo</span><span class="p">,</span> <span class="n">yosDatas</span> <span class="p">)</span> <span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Test if yo and the residual have the same distribution data (i.e., I = 1, 3, 4, 7 and 9).&quot;&quot;&quot;</span>

        <span class="n">yoData</span> <span class="o">=</span> <span class="n">yosDatas</span><span class="p">[</span><span class="n">yo</span><span class="p">]</span>
        <span class="n">resData</span> <span class="o">=</span> <span class="n">yosDatas</span><span class="p">[</span><span class="n">yo</span><span class="o">+</span><span class="mi">10</span><span class="p">]</span>
        <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">yoData</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">resData</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="bp">False</span> <span class="p">)</span>
        <span class="n">yoIs</span> <span class="o">=</span> <span class="n">getDistributionIs</span><span class="p">(</span> <span class="n">yo</span><span class="p">,</span> <span class="n">yosDatas</span> <span class="p">)</span>
        <span class="n">resIs</span> <span class="o">=</span> <span class="n">getDistributionIs</span><span class="p">(</span> <span class="n">yo</span> <span class="o">+</span> <span class="mi">10</span><span class="p">,</span> <span class="n">yosDatas</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">yoIs</span> <span class="o">!=</span> <span class="n">resIs</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="bp">False</span> <span class="p">)</span>
        <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">yoIs</span> <span class="p">:</span>
            <span class="n">yoIData</span> <span class="o">=</span> <span class="n">getIDistributionData</span><span class="p">(</span> <span class="n">yo</span><span class="p">,</span> <span class="n">yosDatas</span><span class="p">,</span> <span class="n">I</span> <span class="p">)</span>
            <span class="n">resIData</span> <span class="o">=</span> <span class="n">getIDistributionData</span><span class="p">(</span> <span class="n">yo</span> <span class="o">+</span> <span class="mi">10</span><span class="p">,</span> <span class="n">yosDatas</span><span class="p">,</span> <span class="n">I</span> <span class="p">)</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">yoIData</span><span class="o">.</span><span class="n">data</span> <span class="o">!=</span> <span class="n">resIData</span><span class="o">.</span><span class="n">data</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="bp">False</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="bp">True</span> <span class="p">)</span>

    <span class="k">def</span> <span class="nf">getMultiplicityYos</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">yos</span><span class="p">,</span> <span class="n">residuals</span><span class="p">,</span> <span class="n">yosDatas</span> <span class="p">)</span> <span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Gets the (multiplicty, yo) pairs and adjust residuals if needed.&quot;&quot;&quot;</span>

        <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">residuals</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s">&#39;len( residuals ) &gt; 1 not supported: residual = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="sb">`residuals`</span> <span class="p">)</span>
        <span class="n">yoOld</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">mYos</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">yo</span> <span class="ow">in</span> <span class="n">yos</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">yo</span> <span class="o">==</span> <span class="n">yoOld</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">yoOld</span> <span class="o">!=</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span> <span class="n">mYos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">[</span> <span class="n">n</span><span class="p">,</span> <span class="n">yoOld</span> <span class="p">]</span> <span class="p">)</span>
                <span class="n">yoOld</span> <span class="o">=</span> <span class="n">yo</span>
                <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">yos</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">residuals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">yo</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">rYo</span> <span class="o">=</span> <span class="n">endl2</span><span class="o">.</span><span class="n">ZAToYo</span><span class="p">(</span> <span class="n">residuals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">isYoAndResidaulDataTheSame</span><span class="p">(</span> <span class="n">rYo</span><span class="p">,</span> <span class="n">yosDatas</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="n">residuals</span> <span class="o">=</span> <span class="n">residuals</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>           <span class="c"># residuals should now be empty.</span>
                    <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">yosDatas</span><span class="p">[</span><span class="n">rYo</span> <span class="o">+</span> <span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">yosData</span> <span class="ow">in</span> <span class="n">yosDatas</span><span class="p">[</span><span class="n">rYo</span><span class="p">]</span> <span class="p">:</span>
                        <span class="k">if</span><span class="p">(</span> <span class="n">yosData</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">10</span> <span class="p">)</span> <span class="p">:</span> <span class="n">yosData</span><span class="o">.</span><span class="n">set</span><span class="p">(</span> <span class="n">yosData</span> <span class="o">*</span> <span class="p">(</span> <span class="n">n</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>

            <span class="n">mYos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">[</span> <span class="n">n</span><span class="p">,</span> <span class="n">yo</span> <span class="p">]</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">residuals</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="n">mYos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="n">residuals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">]</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">mYos</span> <span class="p">)</span>

    <span class="k">def</span> <span class="nf">addDistributionDataAndRemove</span><span class="p">(</span> <span class="n">particle</span><span class="p">,</span> <span class="n">yo</span><span class="p">,</span> <span class="n">yosDatas</span><span class="p">,</span> <span class="n">promptNeutronParticle</span> <span class="o">=</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span>

        <span class="k">def</span> <span class="nf">angular</span><span class="p">(</span> <span class="n">data</span> <span class="p">)</span> <span class="p">:</span>

            <span class="n">muProbabilityFrame</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">labToken</span>
            <span class="k">if</span><span class="p">(</span> <span class="nb">hasattr</span><span class="p">(</span> <span class="n">data</span><span class="p">,</span> <span class="s">&#39;muProbabilityFrame&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">muProbabilityFrame</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">muProbabilityFrame</span>
            <span class="n">axes_</span> <span class="o">=</span> <span class="n">distributions</span><span class="o">.</span><span class="n">angular</span><span class="o">.</span><span class="n">pointwise</span><span class="o">.</span><span class="n">defaultAxes</span><span class="p">(</span> <span class="n">energyUnit</span> <span class="o">=</span> <span class="s">&#39;MeV&#39;</span><span class="p">,</span> <span class="n">muProbabilityFrame</span> <span class="o">=</span> <span class="n">muProbabilityFrame</span> <span class="p">)</span>
            <span class="n">form</span> <span class="o">=</span> <span class="n">distributions</span><span class="o">.</span><span class="n">angular</span><span class="o">.</span><span class="n">pointwise</span><span class="p">(</span> <span class="n">axes_</span> <span class="p">)</span>
            <span class="n">axesMuP</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">referenceAxes</span><span class="p">(</span> <span class="n">form</span> <span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">EMuP</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">E</span><span class="p">,</span> <span class="n">muP</span> <span class="o">=</span> <span class="n">EMuP</span>
                <span class="n">form</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">XYs</span><span class="o">.</span><span class="n">XYs</span><span class="p">(</span> <span class="n">axesMuP</span><span class="p">,</span> <span class="n">muP</span><span class="p">,</span> <span class="n">accuracy</span> <span class="o">=</span> <span class="n">ENDL_Accuracy</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">E</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="n">parent</span> <span class="o">=</span> <span class="n">form</span> <span class="p">)</span>
            <span class="k">return</span><span class="p">(</span> <span class="n">form</span> <span class="p">)</span>

        <span class="k">def</span> <span class="nf">energy</span><span class="p">(</span> <span class="n">data</span> <span class="p">)</span> <span class="p">:</span>

            <span class="n">axes_</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span> <span class="n">dimension</span> <span class="o">=</span> <span class="mi">3</span> <span class="p">)</span>
            <span class="n">axes_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span> <span class="s">&#39;energy_in&#39;</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;MeV&#39;</span><span class="p">,</span> <span class="n">frame</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">labToken</span><span class="p">,</span> <span class="n">interpolation</span> <span class="o">=</span> <span class="n">linlinUnitbaseInterpolation</span> <span class="p">)</span>
            <span class="n">axes_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span> <span class="s">&#39;energy_out&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;MeV&#39;</span><span class="p">,</span> <span class="n">frame</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">labToken</span><span class="p">,</span> <span class="n">interpolation</span> <span class="o">=</span> <span class="n">linlinInterpolation</span> <span class="p">)</span>
            <span class="n">axes_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span> <span class="s">&#39;P(energy_in|energy_out)&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;1/MeV&#39;</span><span class="p">,</span> <span class="n">frame</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">labToken</span> <span class="p">)</span>
            <span class="n">form</span> <span class="o">=</span> <span class="n">distributions</span><span class="o">.</span><span class="n">energy</span><span class="o">.</span><span class="n">pointwise</span><span class="p">(</span> <span class="n">axes_</span> <span class="p">)</span>
            <span class="n">axes_xy</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span> <span class="p">)</span>
            <span class="n">axes_xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">axes_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">axes_xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">axes_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">E</span><span class="p">,</span> <span class="n">EpP</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="p">:</span> <span class="n">form</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">XYs</span><span class="o">.</span><span class="n">XYs</span><span class="p">(</span> <span class="n">axes_xy</span><span class="p">,</span> <span class="n">EpP</span><span class="p">,</span> <span class="n">accuracy</span> <span class="o">=</span> <span class="n">ENDL_Accuracy</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">E</span> <span class="p">)</span> <span class="p">)</span>
            <span class="k">return</span><span class="p">(</span> <span class="n">form</span> <span class="p">)</span>

        <span class="k">def</span> <span class="nf">LLNLLegendrePointwise</span><span class="p">(</span> <span class="n">data</span> <span class="p">)</span> <span class="p">:</span>

            <span class="n">axes_</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span> <span class="n">dimension</span> <span class="o">=</span> <span class="mi">4</span> <span class="p">)</span>
            <span class="n">axes_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span> <span class="s">&#39;l&#39;</span><span class="p">,</span>          <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">,</span>      <span class="n">frame</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">labToken</span><span class="p">,</span> <span class="n">interpolation</span> <span class="o">=</span> <span class="n">linlinInterpolation</span> <span class="p">)</span>
            <span class="n">axes_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span> <span class="s">&#39;energy_in&#39;</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;MeV&#39;</span><span class="p">,</span>   <span class="n">frame</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">labToken</span><span class="p">,</span> <span class="n">interpolation</span> <span class="o">=</span> <span class="n">linlinUnitbaseInterpolation</span> <span class="p">)</span>
            <span class="n">axes_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span> <span class="s">&#39;energy_out&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;MeV&#39;</span><span class="p">,</span>   <span class="n">frame</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">labToken</span><span class="p">,</span> <span class="n">interpolation</span> <span class="o">=</span> <span class="n">linlinInterpolation</span> <span class="p">)</span>
            <span class="n">axes_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span> <span class="s">&#39;c_l&#39;</span><span class="p">,</span>        <span class="mi">3</span><span class="p">,</span> <span class="s">&#39;1/MeV&#39;</span><span class="p">,</span> <span class="n">frame</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">labToken</span> <span class="p">)</span>
            <span class="n">form</span> <span class="o">=</span> <span class="n">distributions</span><span class="o">.</span><span class="n">Legendre</span><span class="o">.</span><span class="n">LLNLPointwise</span><span class="p">(</span> <span class="n">axes_</span> <span class="p">)</span>
            <span class="n">axesRefXY</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">referenceAxes</span><span class="p">(</span> <span class="n">form</span> <span class="p">)</span>
            <span class="k">for</span> <span class="n">l</span><span class="p">,</span> <span class="n">EEpPs</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span> <span class="p">:</span>
                <span class="n">EEpP</span> <span class="o">=</span> <span class="n">distributions</span><span class="o">.</span><span class="n">Legendre</span><span class="o">.</span><span class="n">LLNLPointwiseEEpP</span><span class="p">(</span> <span class="nb">int</span><span class="p">(</span> <span class="n">l</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">xPrior</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">E_EpPs</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="n">EEpPs</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="n">E</span><span class="p">,</span> <span class="n">EpPs</span> <span class="o">=</span> <span class="n">E_EpPs</span>
                    <span class="k">for</span> <span class="n">xy</span> <span class="ow">in</span> <span class="n">EpPs</span> <span class="p">:</span>
                        <span class="k">if</span><span class="p">(</span> <span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">xPrior</span> <span class="p">)</span> <span class="p">:</span> <span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*=</span> <span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">FUDGE_EPS</span> <span class="p">)</span>
                        <span class="n">xPrior</span> <span class="o">=</span> <span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">EEpP</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">XYs</span><span class="o">.</span><span class="n">XYs</span><span class="p">(</span> <span class="n">axesRefXY</span><span class="p">,</span> <span class="n">EpPs</span><span class="p">,</span> <span class="n">ENDL_Accuracy</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">E</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">index</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">form</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">EEpP</span> <span class="p">)</span>
            <span class="k">return</span><span class="p">(</span> <span class="n">form</span> <span class="p">)</span>

        <span class="k">def</span> <span class="nf">LLNLAngularEnergy</span><span class="p">(</span> <span class="n">data</span> <span class="p">)</span> <span class="p">:</span>

            <span class="n">axes_</span> <span class="o">=</span> <span class="n">distributions</span><span class="o">.</span><span class="n">angularEnergy</span><span class="o">.</span><span class="n">pointwise</span><span class="o">.</span><span class="n">defaultAxes</span><span class="p">(</span> <span class="n">energyUnit</span> <span class="o">=</span> <span class="s">&quot;MeV&quot;</span><span class="p">,</span> <span class="n">energyInterpolationQualifier</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">unitBaseToken</span><span class="p">,</span>
                <span class="n">energy_outUnit</span> <span class="o">=</span> <span class="s">&#39;MeV&#39;</span><span class="p">,</span> <span class="n">probabilityUnit</span> <span class="o">=</span> <span class="s">&#39;1/MeV&#39;</span> <span class="p">)</span>
            <span class="n">axes_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="s">&#39;P(energy_in,mu|energy_out)&#39;</span>
            <span class="n">form</span> <span class="o">=</span> <span class="n">distributions</span><span class="o">.</span><span class="n">angularEnergy</span><span class="o">.</span><span class="n">pointwise</span><span class="p">(</span> <span class="n">axes_</span> <span class="p">)</span>
            <span class="n">axesW_XY</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">referenceAxes</span><span class="p">(</span> <span class="n">form</span><span class="p">,</span> <span class="n">dimension</span> <span class="o">=</span> <span class="mi">3</span> <span class="p">)</span>
            <span class="n">axesXY</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">referenceAxes</span><span class="p">(</span> <span class="n">form</span> <span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">E_MuEpPs</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">w_xys</span> <span class="o">=</span> <span class="n">W_XYs</span><span class="o">.</span><span class="n">W_XYs</span><span class="p">(</span> <span class="n">axesW_XY</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">E_MuEpPs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">Mu_EpPs</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="n">E_MuEpPs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="n">w_xys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">XYs</span><span class="o">.</span><span class="n">XYs</span><span class="p">(</span> <span class="n">axesXY</span><span class="p">,</span> <span class="n">Mu_EpPs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">accuracy</span> <span class="o">=</span> <span class="n">ENDL_Accuracy</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">Mu_EpPs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">index</span> <span class="o">=</span> <span class="n">j</span><span class="p">,</span> <span class="n">parent</span> <span class="o">=</span> <span class="n">w_xys</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">form</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">w_xys</span> <span class="p">)</span>
            <span class="k">return</span><span class="p">(</span> <span class="n">form</span> <span class="p">)</span>

        <span class="k">def</span> <span class="nf">addForm</span><span class="p">(</span> <span class="n">component</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">datas</span><span class="p">,</span> <span class="n">func</span> <span class="p">)</span> <span class="p">:</span>

            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="n">datas</span> <span class="p">)</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="n">I</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="n">component</span><span class="o">.</span><span class="n">addForm</span><span class="p">(</span> <span class="n">func</span><span class="p">(</span> <span class="n">data</span> <span class="p">)</span> <span class="p">)</span>
                    <span class="k">del</span> <span class="n">datas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="k">return</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s">&#39;I = </span><span class="si">%d</span><span class="s"> not in datas&#39;</span> <span class="o">%</span> <span class="n">I</span> <span class="p">)</span>

        <span class="k">if</span><span class="p">(</span> <span class="n">particle</span><span class="o">.</span><span class="n">getName</span><span class="p">(</span> <span class="p">)</span> <span class="o">==</span> <span class="s">&#39;gamma&#39;</span> <span class="p">)</span> <span class="p">:</span> <span class="n">particle</span><span class="o">.</span><span class="n">addAttribute</span><span class="p">(</span> <span class="s">&#39;ENDFconversionFlag&#39;</span><span class="p">,</span> <span class="s">&#39;MF6&#39;</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">yo</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">yosDatas</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span>
        <span class="n">datas</span> <span class="o">=</span> <span class="n">yosDatas</span><span class="p">[</span><span class="n">yo</span><span class="p">]</span>
        <span class="n">Is</span> <span class="o">=</span> <span class="n">getAllDistributionIs</span><span class="p">(</span> <span class="n">datas</span><span class="p">,</span> <span class="n">IMax</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">IExtras</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">941</span><span class="p">,</span> <span class="mi">942</span> <span class="p">]</span> <span class="p">)</span>
        <span class="n">component</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">Is</span> <span class="o">==</span> <span class="p">[]</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">datas</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">datas</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">datas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">S</span> <span class="o">==</span> <span class="mi">7</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">datas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">7</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>   <span class="c"># Special case for endl I, S = 7, 7 with no distribution data.</span>
                    <span class="n">component</span> <span class="o">=</span> <span class="n">distributions</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">referenceComponent</span><span class="p">(</span> <span class="n">promptNeutronParticle</span><span class="o">.</span><span class="n">distributions</span> <span class="p">)</span>
                <span class="k">else</span> <span class="p">:</span>
                    <span class="k">print</span>
                    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">datas</span> <span class="p">:</span> <span class="k">print</span> <span class="n">data</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s">&quot;Unsupported data for particle </span><span class="si">%s</span><span class="s"> genre.&quot;</span> <span class="o">%</span> <span class="p">(</span> <span class="sb">`Is`</span><span class="p">,</span> <span class="n">particle</span><span class="o">.</span><span class="n">getName</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">elif</span><span class="p">(</span> <span class="p">(</span> <span class="mi">941</span> <span class="ow">in</span> <span class="n">Is</span> <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span> <span class="mi">942</span> <span class="ow">in</span> <span class="n">Is</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s">&#39;I = 941 or 942 not supported&#39;</span> <span class="p">)</span>
        <span class="k">elif</span><span class="p">(</span> <span class="n">Is</span> <span class="o">==</span> <span class="p">[</span> <span class="mi">1</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span> 
            <span class="k">if</span><span class="p">(</span> <span class="n">datas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">S</span> <span class="o">==</span> <span class="mi">3</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">component</span> <span class="o">=</span> <span class="n">distributions</span><span class="o">.</span><span class="n">angular</span><span class="o">.</span><span class="n">component</span><span class="p">(</span> <span class="n">nativeData</span> <span class="o">=</span> <span class="n">distributions</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">pointwiseFormToken</span> <span class="p">)</span>
                <span class="n">addForm</span><span class="p">(</span> <span class="n">component</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">datas</span><span class="p">,</span> <span class="n">angular</span> <span class="p">)</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">datas</span> <span class="p">:</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">muProbabilityFrame</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">centerOfMassToken</span>
                <span class="n">component</span> <span class="o">=</span> <span class="n">distributions</span><span class="o">.</span><span class="n">angular</span><span class="o">.</span><span class="n">twoBodyComponent</span><span class="p">(</span> <span class="n">distributions</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">pointwiseFormToken</span> <span class="p">)</span>
                <span class="n">addForm</span><span class="p">(</span> <span class="n">component</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">datas</span><span class="p">,</span> <span class="n">angular</span> <span class="p">)</span>
        <span class="k">elif</span><span class="p">(</span> <span class="n">Is</span> <span class="o">==</span> <span class="p">[</span> <span class="mi">4</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">component</span> <span class="o">=</span> <span class="n">distributions</span><span class="o">.</span><span class="n">Legendre</span><span class="o">.</span><span class="n">component</span><span class="p">(</span> <span class="n">distributions</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">LLNLLegendrePointwiseFormToken</span> <span class="p">)</span>
            <span class="n">addForm</span><span class="p">(</span> <span class="n">component</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">datas</span><span class="p">,</span> <span class="n">LLNLLegendrePointwise</span> <span class="p">)</span>
        <span class="k">elif</span><span class="p">(</span> <span class="n">Is</span> <span class="o">==</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">angularComponent</span> <span class="o">=</span> <span class="n">distributions</span><span class="o">.</span><span class="n">angular</span><span class="o">.</span><span class="n">component</span><span class="p">(</span> <span class="n">nativeData</span> <span class="o">=</span> <span class="n">distributions</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">pointwiseFormToken</span> <span class="p">)</span>
            <span class="n">addForm</span><span class="p">(</span> <span class="n">angularComponent</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">datas</span><span class="p">,</span> <span class="n">angular</span> <span class="p">)</span>

            <span class="n">angularEnergyComponent</span> <span class="o">=</span> <span class="n">distributions</span><span class="o">.</span><span class="n">angularEnergy</span><span class="o">.</span><span class="n">LLNLComponent</span><span class="p">(</span> <span class="n">distributions</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">pointwiseFormToken</span> <span class="p">)</span>
            <span class="n">addForm</span><span class="p">(</span> <span class="n">angularEnergyComponent</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">datas</span><span class="p">,</span> <span class="n">LLNLAngularEnergy</span> <span class="p">)</span>

            <span class="n">component</span> <span class="o">=</span> <span class="n">distributions</span><span class="o">.</span><span class="n">angularEnergy</span><span class="o">.</span><span class="n">LLNL_withAngularComponent</span><span class="p">(</span> <span class="n">angularComponent</span><span class="p">,</span> <span class="n">angularEnergyComponent</span> <span class="p">)</span>
        <span class="k">elif</span><span class="p">(</span> <span class="n">Is</span> <span class="o">==</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">angularComponent</span> <span class="o">=</span> <span class="n">distributions</span><span class="o">.</span><span class="n">angular</span><span class="o">.</span><span class="n">component</span><span class="p">(</span> <span class="n">nativeData</span> <span class="o">=</span> <span class="n">distributions</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">pointwiseFormToken</span> <span class="p">)</span>
            <span class="n">addForm</span><span class="p">(</span> <span class="n">angularComponent</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">datas</span><span class="p">,</span> <span class="n">angular</span> <span class="p">)</span>

            <span class="n">energyComponent</span> <span class="o">=</span> <span class="n">distributions</span><span class="o">.</span><span class="n">energy</span><span class="o">.</span><span class="n">component</span><span class="p">(</span> <span class="n">distributions</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">pointwiseFormToken</span> <span class="p">)</span>
            <span class="n">addForm</span><span class="p">(</span> <span class="n">energyComponent</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">datas</span><span class="p">,</span> <span class="n">energy</span> <span class="p">)</span>

            <span class="n">component</span> <span class="o">=</span> <span class="n">distributions</span><span class="o">.</span><span class="n">uncorrelated</span><span class="o">.</span><span class="n">component</span><span class="p">(</span> <span class="n">angularComponent</span><span class="p">,</span> <span class="n">energyComponent</span> <span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s">&quot;I&#39;s = </span><span class="si">%s</span><span class="s"> not supported for particle </span><span class="si">%s</span><span class="s"> genre.&quot;</span> <span class="o">%</span> <span class="p">(</span> <span class="sb">`Is`</span><span class="p">,</span> <span class="n">particle</span><span class="o">.</span><span class="n">getName</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">datas</span> <span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">datas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">941</span><span class="p">,</span> <span class="mi">942</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">7</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">S</span> <span class="o">==</span> <span class="mi">7</span> <span class="p">)</span> <span class="p">:</span> 
                        <span class="n">particle</span><span class="o">.</span><span class="n">addAttribute</span><span class="p">(</span> <span class="s">&#39;emissionMode&#39;</span><span class="p">,</span> <span class="s">&#39;delayed&#39;</span> <span class="p">)</span>
                        <span class="n">particle</span><span class="o">.</span><span class="n">addAttribute</span><span class="p">(</span> <span class="s">&#39;decayRate&#39;</span><span class="p">,</span> <span class="n">physicalQuantityWithUncertainty</span><span class="o">.</span><span class="n">PhysicalQuantityWithUncertainty</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">getX1</span><span class="p">(</span> <span class="p">),</span> <span class="s">&quot;1/s&quot;</span> <span class="p">)</span> <span class="p">)</span>
                    <span class="k">else</span> <span class="p">:</span>
                        <span class="n">particle</span><span class="o">.</span><span class="n">addAttribute</span><span class="p">(</span> <span class="s">&#39;emissionMode&#39;</span><span class="p">,</span> <span class="s">&#39;prompt&#39;</span> <span class="p">)</span>
                <span class="n">xInterpolationStr</span><span class="p">,</span> <span class="n">yInterpolationStr</span> <span class="o">=</span> <span class="n">getXYInterpolation</span><span class="p">(</span> <span class="n">data</span> <span class="p">)</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span> 
                    <span class="n">axes_</span> <span class="o">=</span> <span class="n">gnd</span><span class="o">.</span><span class="n">productData</span><span class="o">.</span><span class="n">multiplicity</span><span class="o">.</span><span class="n">pointwise</span><span class="o">.</span><span class="n">defaultAxes</span><span class="p">(</span> <span class="n">energyUnit</span> <span class="o">=</span> <span class="s">&#39;MeV&#39;</span><span class="p">,</span> <span class="n">energyInterpolation</span> <span class="o">=</span> <span class="n">xInterpolationStr</span><span class="p">,</span> \
                            <span class="n">multiplicityInterpolation</span> <span class="o">=</span> <span class="n">yInterpolationStr</span> <span class="p">)</span>
                    <span class="n">particle</span><span class="o">.</span><span class="n">setMultiplicity</span><span class="p">(</span> <span class="n">gnd</span><span class="o">.</span><span class="n">productData</span><span class="o">.</span><span class="n">multiplicity</span><span class="o">.</span><span class="n">pointwise</span><span class="p">(</span> <span class="n">axes_</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">ENDL_Accuracy</span> <span class="p">)</span> <span class="p">)</span>
                <span class="k">else</span> <span class="p">:</span>          <span class="c"># for I = 10 and 13</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">10</span> <span class="p">)</span> <span class="p">:</span>
                        <span class="n">axes_</span> <span class="o">=</span> <span class="n">gnd</span><span class="o">.</span><span class="n">productData</span><span class="o">.</span><span class="n">energyDeposition</span><span class="o">.</span><span class="n">pointwise</span><span class="o">.</span><span class="n">defaultAxes</span><span class="p">(</span> <span class="n">energyUnit</span> <span class="o">=</span> <span class="s">&#39;MeV&#39;</span><span class="p">,</span> <span class="n">energyInterpolation</span> <span class="o">=</span> <span class="n">xInterpolationStr</span><span class="p">,</span> \
                            <span class="n">energyDepositionInterpolation</span> <span class="o">=</span> <span class="n">yInterpolationStr</span> <span class="p">)</span>
                        <span class="n">dataComponent</span> <span class="o">=</span> <span class="n">gnd</span><span class="o">.</span><span class="n">productData</span><span class="o">.</span><span class="n">energyDeposition</span><span class="o">.</span><span class="n">component</span><span class="p">(</span> <span class="n">gnd</span><span class="o">.</span><span class="n">tokens</span><span class="o">.</span><span class="n">pointwiseFormToken</span> <span class="p">)</span>
                        <span class="n">dataComponent</span><span class="o">.</span><span class="n">addForm</span><span class="p">(</span> <span class="n">gnd</span><span class="o">.</span><span class="n">productData</span><span class="o">.</span><span class="n">energyDeposition</span><span class="o">.</span><span class="n">pointwise</span><span class="p">(</span> <span class="n">axes_</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">ENDL_Accuracy</span> <span class="p">)</span> <span class="p">)</span>
                    <span class="k">elif</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">13</span> <span class="p">)</span> <span class="p">:</span>
                        <span class="n">axes_</span> <span class="o">=</span> <span class="n">gnd</span><span class="o">.</span><span class="n">productData</span><span class="o">.</span><span class="n">momentumDeposition</span><span class="o">.</span><span class="n">pointwise</span><span class="o">.</span><span class="n">defaultAxes</span><span class="p">(</span> <span class="n">energyUnit</span> <span class="o">=</span> <span class="s">&#39;MeV&#39;</span><span class="p">,</span> <span class="n">energyInterpolation</span> <span class="o">=</span> <span class="n">xInterpolationStr</span><span class="p">,</span> \
                            <span class="n">momentumDepositionInterpolation</span> <span class="o">=</span> <span class="n">yInterpolationStr</span><span class="p">,</span> <span class="n">momentumDepositionUnit</span> <span class="o">=</span> <span class="s">&#39;MeV/c&#39;</span> <span class="p">)</span>
                        <span class="n">dataComponent</span> <span class="o">=</span> <span class="n">gnd</span><span class="o">.</span><span class="n">productData</span><span class="o">.</span><span class="n">momentumDeposition</span><span class="o">.</span><span class="n">component</span><span class="p">(</span> <span class="n">gnd</span><span class="o">.</span><span class="n">tokens</span><span class="o">.</span><span class="n">pointwiseFormToken</span> <span class="p">)</span>
                        <span class="n">dataComponent</span><span class="o">.</span><span class="n">addForm</span><span class="p">(</span> <span class="n">gnd</span><span class="o">.</span><span class="n">productData</span><span class="o">.</span><span class="n">momentumDeposition</span><span class="o">.</span><span class="n">pointwise</span><span class="p">(</span> <span class="n">axes_</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">ENDL_Accuracy</span> <span class="p">)</span> <span class="p">)</span>
                    <span class="n">particle</span><span class="o">.</span><span class="n">addData</span><span class="p">(</span> <span class="n">dataComponent</span> <span class="p">)</span>
                <span class="k">del</span> <span class="n">datas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span><span class="p">(</span> <span class="ow">not</span> <span class="n">component</span> <span class="ow">is</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">particle</span><span class="o">.</span><span class="n">addDistributionComponent</span><span class="p">(</span> <span class="n">component</span> <span class="p">)</span>
            <span class="n">particle</span><span class="o">.</span><span class="n">distributions</span><span class="o">.</span><span class="n">setNativeData</span><span class="p">(</span> <span class="n">component</span><span class="o">.</span><span class="n">moniker</span> <span class="p">)</span>

    <span class="k">def</span> <span class="nf">makeNBodyChannelFrom_mYos</span><span class="p">(</span> <span class="n">channelClass</span><span class="p">,</span> <span class="n">mYos</span><span class="p">,</span> <span class="n">ZAsYos</span><span class="p">,</span> <span class="n">yosDatas</span><span class="p">,</span> <span class="n">Q_MeV</span><span class="p">,</span> <span class="n">specialCase</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">decayChannelInfo</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">levelIndex</span> <span class="o">=</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;This routine does not support yo&#39;s (including the residual) in an excited state. This is consistent with endl99.</span>
<span class="sd">        This routine does not work if decayChannelInfo has data (see note Note_Be_9) due to added gndPath logic (gndPath has been</span>
<span class="sd">        removed and may be so should this last sentence).&quot;&quot;&quot;</span>

        <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="nb">hasattr</span><span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="s">&#39;specialCase&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">specialCase</span> <span class="o">=</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">specialCase</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">specialCase</span> <span class="o">==</span> <span class="s">&#39;Am_242_m1&#39;</span> <span class="p">)</span> <span class="p">:</span> <span class="n">level</span> <span class="o">=</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">level</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s">&#39; &#39;</span>
        <span class="n">channel</span> <span class="o">=</span> <span class="n">channelClass</span><span class="p">(</span> <span class="n">returnConstantQ</span><span class="p">(</span> <span class="n">Q_MeV</span> <span class="p">)</span> <span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span> <span class="n">mYos</span> <span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">ZA</span> <span class="ow">in</span> <span class="n">mYos</span> <span class="p">:</span>
            <span class="n">decayChannel</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">decayChannelInfo</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">decayChannelInfo</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span> <span class="p">)</span> <span class="p">:</span> <span class="n">decayChannel</span> <span class="o">=</span> <span class="n">decayChannelInfo</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">m</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">particle</span> <span class="o">=</span> <span class="n">newGNDParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">ZA</span> <span class="p">),</span> <span class="n">multiplicity</span> <span class="o">=</span> <span class="n">m</span><span class="p">,</span> <span class="n">decayChannel</span> <span class="o">=</span> <span class="n">decayChannel</span> <span class="p">)</span>
            <span class="k">elif</span><span class="p">(</span> <span class="p">(</span> <span class="n">specialCase</span> <span class="o">==</span> <span class="s">&#39;unknown level&#39;</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">particle</span> <span class="o">=</span> <span class="n">newGNDParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">ZA</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">levelIndex</span> <span class="o">=</span> <span class="n">levelIndex</span> <span class="p">),</span> <span class="n">decayChannel</span> <span class="o">=</span> <span class="n">decayChannel</span> <span class="p">)</span>
            <span class="k">elif</span><span class="p">(</span> <span class="p">(</span> <span class="n">specialCase</span> <span class="o">==</span> <span class="s">&#39;Am_242_m1&#39;</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">ZA</span> <span class="o">==</span> <span class="mi">95242</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">particle</span> <span class="o">=</span> <span class="n">newGNDParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">ZA</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="n">level</span><span class="p">,</span> <span class="n">levelIndex</span> <span class="o">=</span> <span class="mi">2</span> <span class="p">),</span> <span class="n">decayChannel</span> <span class="o">=</span> <span class="n">decayChannel</span> <span class="p">)</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="n">particle</span> <span class="o">=</span> <span class="n">newGNDParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">ZA</span> <span class="p">),</span> <span class="n">decayChannel</span> <span class="o">=</span> <span class="n">decayChannel</span> <span class="p">)</span>
            <span class="n">s</span> <span class="o">=</span> <span class="s">&#39; + &#39;</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">ZA</span> <span class="ow">in</span> <span class="n">ZAsYos</span> <span class="p">)</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="n">specialCase</span> <span class="o">==</span> <span class="s">&#39;S8&#39;</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">ZA</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="n">yo</span> <span class="o">=</span> <span class="mi">11</span>
                <span class="k">else</span> <span class="p">:</span>
                    <span class="n">yo</span> <span class="o">=</span> <span class="n">ZAsYos</span><span class="p">[</span><span class="n">ZA</span><span class="p">]</span>
                    <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="n">i</span> <span class="o">==</span> <span class="n">n</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="n">yo</span><span class="p">]</span> <span class="o">==</span> <span class="p">[]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">yo</span> <span class="o">+=</span> <span class="mi">10</span>
                <span class="n">addDistributionDataAndRemove</span><span class="p">(</span> <span class="n">particle</span><span class="p">,</span> <span class="n">yo</span><span class="p">,</span> <span class="n">yosDatas</span> <span class="p">)</span>
            <span class="n">channel</span><span class="o">.</span><span class="n">addProduct</span><span class="p">(</span> <span class="n">particle</span> <span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span><span class="p">(</span> <span class="n">channel</span> <span class="p">)</span>

    <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">ZA</span> <span class="o">==</span> <span class="mi">95241</span> <span class="p">)</span> <span class="p">:</span>
        <span class="n">I0s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findDatas</span><span class="p">(</span> <span class="n">C</span> <span class="o">=</span> <span class="mi">46</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">I</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">I0s</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">I0m1</span><span class="p">,</span> <span class="n">I0g</span> <span class="o">=</span> <span class="n">I0s</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">I0m1</span><span class="o">.</span><span class="n">getQ</span><span class="p">(</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="n">I0g</span><span class="o">.</span><span class="n">getQ</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">I0m1</span><span class="p">,</span> <span class="n">I0g</span> <span class="o">=</span> <span class="n">I0g</span><span class="p">,</span> <span class="n">I0m1</span>
            <span class="n">level</span> <span class="o">=</span> <span class="n">I0g</span><span class="o">.</span><span class="n">getQ</span><span class="p">(</span> <span class="p">)</span> <span class="o">-</span> <span class="n">I0m1</span><span class="o">.</span><span class="n">getQ</span><span class="p">(</span> <span class="p">)</span>
            <span class="n">dataM1s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findDatas</span><span class="p">(</span> <span class="n">C</span> <span class="o">=</span> <span class="mi">46</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">I0m1</span><span class="o">.</span><span class="n">getQ</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span>
            <span class="k">for</span> <span class="n">dataM1</span> <span class="ow">in</span> <span class="n">dataM1s</span> <span class="p">:</span>
                <span class="n">dataM1</span><span class="o">.</span><span class="n">specialCase</span> <span class="o">=</span> <span class="s">&#39;Am_242_m1&#39;</span>
                <span class="n">dataM1</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="n">level</span>
    <span class="n">yosDatas</span> <span class="o">=</span> <span class="p">{</span>  <span class="mi">0</span> <span class="p">:</span> <span class="p">[],</span>  <span class="mi">1</span> <span class="p">:</span> <span class="p">[],</span>  <span class="mi">2</span> <span class="p">:</span> <span class="p">[],</span>  <span class="mi">3</span> <span class="p">:</span> <span class="p">[],</span>  <span class="mi">4</span> <span class="p">:</span> <span class="p">[],</span>  <span class="mi">5</span> <span class="p">:</span> <span class="p">[],</span>  <span class="mi">6</span> <span class="p">:</span> <span class="p">[],</span>  <span class="mi">7</span> <span class="p">:</span> <span class="p">[],</span>  <span class="mi">8</span> <span class="p">:</span> <span class="p">[],</span>  <span class="mi">9</span> <span class="p">:</span> <span class="p">[],</span>
                     <span class="mi">10</span> <span class="p">:</span> <span class="p">[],</span> <span class="mi">11</span> <span class="p">:</span> <span class="p">[],</span> <span class="mi">12</span> <span class="p">:</span> <span class="p">[],</span> <span class="mi">13</span> <span class="p">:</span> <span class="p">[],</span> <span class="mi">14</span> <span class="p">:</span> <span class="p">[],</span> <span class="mi">15</span> <span class="p">:</span> <span class="p">[],</span> <span class="mi">16</span> <span class="p">:</span> <span class="p">[],</span> <span class="mi">17</span> <span class="p">:</span> <span class="p">[],</span> <span class="mi">18</span> <span class="p">:</span> <span class="p">[],</span> <span class="mi">19</span> <span class="p">:</span> <span class="p">[]</span> <span class="p">}</span>
    <span class="n">yosZAs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">yo</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">17</span> <span class="p">)</span> <span class="p">:</span> <span class="n">yosZAs</span><span class="p">[</span><span class="n">yo</span><span class="p">]</span> <span class="o">=</span> <span class="n">endl2</span><span class="o">.</span><span class="n">yoToZA</span><span class="p">(</span> <span class="n">yo</span> <span class="p">)</span>
    <span class="n">ZAsYos</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">yo</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span> <span class="p">)</span> <span class="p">:</span> <span class="n">ZAsYos</span><span class="p">[</span><span class="n">endl2</span><span class="o">.</span><span class="n">yoToZA</span><span class="p">(</span> <span class="n">yo</span> <span class="p">)]</span> <span class="o">=</span> <span class="n">yo</span>
    <span class="n">ZAsYos</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mi">7</span>
    <span class="n">ENDLCS_To_ENDFMT</span> <span class="o">=</span> <span class="n">endf_endl</span><span class="o">.</span><span class="n">ENDLCS_To_ENDFMT</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">projectileName</span> <span class="p">)</span>

    <span class="n">level</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">I0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findDatas</span><span class="p">(</span> <span class="n">I</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">getELevel</span><span class="p">(</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="n">level</span> <span class="o">=</span> <span class="n">I0</span><span class="o">.</span><span class="n">getELevel</span><span class="p">(</span> <span class="p">)</span>
    <span class="k">if</span><span class="p">(</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="s">&#39;evaluation&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
        <span class="k">if</span><span class="p">(</span> <span class="s">&#39;/yi0&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">evaluation</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">split</span><span class="p">(</span> <span class="s">&#39;/yi0&#39;</span> <span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">evaluation</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="p">)</span>
    <span class="n">evaluation</span> <span class="o">=</span> <span class="s">&quot;ENDL&quot;</span>                     <span class="c"># Override above for now. Note, this is used in reactionSuite.toENDF6</span>
    <span class="n">evaluatedStyle</span> <span class="o">=</span> <span class="n">gnd</span><span class="o">.</span><span class="n">miscellaneous</span><span class="o">.</span><span class="n">style</span><span class="p">(</span> <span class="s">&#39;evaluated&#39;</span><span class="p">,</span> <span class="n">attributes</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&#39;version&#39;</span> <span class="p">:</span> <span class="n">evaluation</span> <span class="p">}</span> <span class="p">)</span>
    <span class="n">info</span> <span class="o">=</span> <span class="n">infos</span><span class="p">(</span> <span class="n">xenslIsotopes</span><span class="p">,</span> <span class="n">transportables</span> <span class="o">=</span> <span class="p">[</span> <span class="s">&#39;n&#39;</span><span class="p">,</span> <span class="s">&#39;H1&#39;</span><span class="p">,</span> <span class="s">&#39;H2&#39;</span><span class="p">,</span> <span class="s">&#39;H3&#39;</span><span class="p">,</span> <span class="s">&#39;He3&#39;</span><span class="p">,</span> <span class="s">&#39;He4&#39;</span><span class="p">,</span> <span class="s">&#39;gamma&#39;</span> <span class="p">]</span> <span class="p">)</span>
    <span class="n">projectile</span> <span class="o">=</span> <span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">endl2</span><span class="o">.</span><span class="n">yoToZA</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">yi</span> <span class="p">)</span> <span class="p">)</span>

    <span class="n">CsAndSs</span><span class="p">,</span> <span class="n">residualExcitationIndexLevels</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{}</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">level</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span> <span class="n">residualExcitationIndexLevels</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ZA</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span> <span class="bp">None</span><span class="p">,</span> <span class="n">level</span> <span class="p">]</span> <span class="p">]</span>
    <span class="n">reactionsDatas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findReactionsDatas</span><span class="p">(</span> <span class="p">)</span>
    <span class="n">compoundZA</span> <span class="o">=</span> <span class="n">endl2</span><span class="o">.</span><span class="n">yoToZA</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">yi</span> <span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ZA</span>
    <span class="k">for</span> <span class="n">reactionDatas</span> <span class="ow">in</span> <span class="n">reactionsDatas</span> <span class="p">:</span>               <span class="c"># Determine a unique set of levels for excited residuals.</span>
        <span class="n">C</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="n">reactionDatas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">C</span><span class="p">,</span> <span class="n">reactionDatas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">S</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">C</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">CsAndSs</span> <span class="p">)</span> <span class="p">:</span> <span class="n">CsAndSs</span><span class="p">[</span><span class="n">C</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">S</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">CsAndSs</span><span class="p">[</span><span class="n">C</span><span class="p">]</span> <span class="p">)</span> <span class="p">:</span> <span class="n">CsAndSs</span><span class="p">[</span><span class="n">C</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">S</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">S</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">yos</span> <span class="o">=</span> <span class="n">endl_C</span><span class="o">.</span><span class="n">endl_C_yoInfo</span><span class="p">(</span> <span class="n">C</span> <span class="p">)</span>
            <span class="n">residualZA</span> <span class="o">=</span> <span class="n">compoundZA</span> <span class="o">-</span> <span class="n">yos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">residualZA</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">residualExcitationIndexLevels</span> <span class="p">)</span> <span class="p">:</span> <span class="n">residualExcitationIndexLevels</span><span class="p">[</span><span class="n">residualZA</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">residualExcitationIndexLevels</span><span class="p">[</span><span class="n">residualZA</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">[</span> <span class="bp">None</span><span class="p">,</span> <span class="n">reactionDatas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">X1</span> <span class="p">]</span> <span class="p">)</span>
    <span class="k">for</span> <span class="n">residualZA</span> <span class="ow">in</span> <span class="n">residualExcitationIndexLevels</span> <span class="p">:</span>
        <span class="n">residualExcitationIndexLevels</span><span class="p">[</span><span class="n">residualZA</span><span class="p">]</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span> <span class="p">)</span>
        <span class="n">indexLevels</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">indexAndLevel</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="n">residualExcitationIndexLevels</span><span class="p">[</span><span class="n">residualZA</span><span class="p">]</span> <span class="p">)</span> <span class="p">:</span> 
            <span class="n">indexLevel</span> <span class="o">=</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">indexAndLevel</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="n">indexLevel</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">indexLevels</span><span class="p">[</span><span class="n">indexAndLevel</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">indexLevel</span>
        <span class="n">residualExcitationIndexLevels</span><span class="p">[</span><span class="n">residualZA</span><span class="p">]</span> <span class="o">=</span> <span class="n">indexLevels</span>

    <span class="n">levelIndex</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">level</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span>
        <span class="n">levelIndex</span> <span class="o">=</span> <span class="n">residualExcitationIndexLevels</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ZA</span><span class="p">][</span><span class="n">level</span><span class="p">]</span>
        <span class="n">metaStableIndex</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span> <span class="s">&#39;_m&#39;</span> <span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>
    <span class="n">target</span> <span class="o">=</span> <span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ZA</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="n">level</span><span class="p">,</span> <span class="n">levelIndex</span> <span class="o">=</span> <span class="n">levelIndex</span> <span class="p">)</span>

    <span class="n">reactionSuite</span> <span class="o">=</span> <span class="n">gnd</span><span class="o">.</span><span class="n">reactionSuite</span><span class="o">.</span><span class="n">reactionSuite</span><span class="p">(</span> <span class="n">projectile</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">particleList</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">particleList</span><span class="p">,</span> <span class="n">style</span> <span class="o">=</span> <span class="n">evaluatedStyle</span> <span class="p">)</span>
    <span class="n">info</span><span class="o">.</span><span class="n">setReactionSuite</span><span class="p">(</span> <span class="n">reactionSuite</span> <span class="p">)</span>
    <span class="n">reactionSuite</span><span class="o">.</span><span class="n">setAttribute</span><span class="p">(</span> <span class="s">&#39;temperature&#39;</span><span class="p">,</span> <span class="n">physicalQuantityWithUncertainty</span><span class="o">.</span><span class="n">PhysicalQuantityWithUncertainty</span><span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">getTemperature</span><span class="p">(</span> <span class="p">),</span> <span class="s">&#39;MeV&#39;</span> <span class="p">)</span> <span class="p">)</span>
    <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">ZA</span> <span class="o">==</span> <span class="mi">95242</span> <span class="p">)</span> <span class="p">:</span>
        <span class="n">metaStableName</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">getName</span><span class="p">(</span> <span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span> <span class="s">&#39;_&#39;</span> <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">metaStableName</span> <span class="o">+=</span> <span class="s">&#39;_m</span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="mi">1</span>
        <span class="n">reactionSuite</span><span class="o">.</span><span class="n">addAlias</span><span class="p">(</span> <span class="n">metaStableName</span><span class="p">,</span> <span class="n">target</span><span class="o">.</span><span class="n">getName</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span>

    <span class="n">I20s</span> <span class="o">=</span> <span class="p">[]</span>                                           <span class="c"># Some I20 data has bad Q values, so let&#39;s ignore all I20 data.</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">reactionDatas</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="n">reactionsDatas</span> <span class="p">)</span> <span class="p">:</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">reactionData</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="n">reactionDatas</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">reactionData</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">20</span> <span class="p">)</span> <span class="p">:</span> <span class="n">I20s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">[</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="p">]</span> <span class="p">)</span>
    <span class="n">I20s</span><span class="o">.</span><span class="n">reverse</span><span class="p">(</span> <span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">I20s</span> <span class="p">:</span>
        <span class="k">del</span> <span class="n">reactionsDatas</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
        <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">reactionsDatas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="k">del</span> <span class="n">reactionsDatas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="n">channelList</span><span class="p">,</span> <span class="n">maxDate</span><span class="p">,</span> <span class="n">delayedNeutrons</span> <span class="o">=</span> <span class="p">[],</span> <span class="mi">0</span><span class="p">,</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">iChannel</span><span class="p">,</span> <span class="n">reactionDatas</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="n">reactionsDatas</span> <span class="p">)</span> <span class="p">:</span>
        <span class="n">C</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="n">reactionDatas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">C</span><span class="p">,</span> <span class="n">reactionDatas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">S</span>   <span class="c"># Phase 1</span>
        <span class="n">c_Or_s_Level</span> <span class="o">=</span> <span class="s">&#39;c&#39;</span>
        <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="n">S</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="mi">1</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">CsAndSs</span><span class="p">[</span><span class="n">C</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">c_Or_s_Level</span> <span class="o">=</span> <span class="s">&#39;s&#39;</span>
        <span class="n">info</span><span class="o">.</span><span class="n">newIndices</span><span class="p">(</span> <span class="p">)</span>
        <span class="n">maxReactionDate</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">I0</span><span class="p">,</span> <span class="n">I12</span><span class="p">,</span> <span class="n">I20</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span>
        <span class="n">specialCase</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">yo</span> <span class="ow">in</span> <span class="n">yosDatas</span> <span class="p">:</span> <span class="n">yosDatas</span><span class="p">[</span><span class="n">yo</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">reactionDatas</span> <span class="p">:</span>                         <span class="c"># yosDatas should only contain I = 1, 3, 4, 7, 9, 10 and 13 type data.</span>
            <span class="n">data</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="p">(</span> <span class="n">endlmisc</span><span class="o">.</span><span class="n">getNumberOfColumns_</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span><span class="p">,</span> <span class="s">&#39;&#39;</span> <span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s">,&#39;</span> <span class="o">%</span> <span class="n">axes</span><span class="o">.</span><span class="n">labToken</span> <span class="p">)</span> <span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">S</span> <span class="o">==</span> <span class="mi">7</span> <span class="p">)</span> <span class="p">:</span>                             <span class="c"># Special treatment for delayed neutron data.</span>
                <span class="n">decayRate</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">getX1</span><span class="p">(</span> <span class="p">)</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">decayRate</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">delayedNeutrons</span> <span class="p">)</span> <span class="p">:</span> <span class="n">delayedNeutrons</span><span class="p">[</span><span class="n">decayRate</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">delayedNeutrons</span><span class="p">[</span><span class="n">decayRate</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">data</span> <span class="p">)</span>
                <span class="k">continue</span>
            <span class="k">if</span><span class="p">(</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">data</span><span class="o">.</span><span class="n">yo</span> <span class="o">&lt;=</span> <span class="mi">16</span> <span class="p">)</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">92</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span> <span class="k">continue</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">20</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="n">date</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">getDate</span><span class="p">(</span> <span class="p">)</span> <span class="o">+</span> <span class="mi">19</span> <span class="o">*</span> <span class="mi">1000000</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">date</span> <span class="o">&lt;</span> <span class="mi">600000</span> <span class="p">)</span> <span class="p">:</span> <span class="n">date</span> <span class="o">+=</span> <span class="mi">1000000</span>   <span class="c"># Must treat dates after 2000 different then those before (600000 is arbitrary).</span>
                    <span class="n">maxReactionDate</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span> <span class="n">date</span><span class="p">,</span> <span class="n">maxReactionDate</span> <span class="p">)</span>
                    <span class="n">maxDate</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span> <span class="n">date</span><span class="p">,</span> <span class="n">maxDate</span> <span class="p">)</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="n">I0</span> <span class="o">=</span> <span class="n">data</span>
                <span class="k">elif</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">11</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">elif</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">12</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="n">I12</span> <span class="o">=</span> <span class="n">data</span>
                <span class="k">elif</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">20</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="n">I20</span> <span class="o">=</span> <span class="n">data</span>
                <span class="k">elif</span><span class="p">(</span> <span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">yo</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">13</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">else</span> <span class="p">:</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">941</span><span class="p">,</span> <span class="mi">942</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
                        <span class="k">print</span> <span class="n">data</span>
                        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s">&#39;I = </span><span class="si">%d</span><span class="s"> data not currently supported&#39;</span> <span class="o">%</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="p">)</span>
                    <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">S</span> <span class="o">==</span> <span class="mi">8</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">yo</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">4</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">C</span> <span class="o">==</span> <span class="mi">12</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>   <span class="c"># This should only be for endl n+d-&gt;2n+p</span>
                        <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">ZA</span> <span class="o">!=</span> <span class="mi">1002</span> <span class="p">)</span> <span class="p">:</span>
                            <span class="k">print</span> <span class="n">data</span>
                            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s">&#39;S = 8, yo = 1, I = 4 only supported for ZA = 1002&#39;</span> <span class="p">)</span>
                        <span class="n">yosDatas</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">yo</span> <span class="o">+</span> <span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">data</span> <span class="p">)</span>
                        <span class="n">specialCase</span> <span class="o">=</span> <span class="s">&#39;S8&#39;</span>
                    <span class="k">else</span> <span class="p">:</span>
                        <span class="n">yosDatas</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">yo</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">data</span> <span class="p">)</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="k">print</span> <span class="n">data</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s">&#39;Unsupported yo = </span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">data</span><span class="o">.</span><span class="n">yo</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">specialCase</span> <span class="o">==</span> <span class="s">&#39;S8&#39;</span> <span class="p">)</span> <span class="p">:</span>                         <span class="c"># May need to add I = 10 data to yo = 11 and readjust yo = 1&#39;s I = 10 data.</span>
            <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">I10Present</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="p">:</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">10</span> <span class="p">)</span> <span class="p">:</span> <span class="n">I10Present</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="k">if</span><span class="p">(</span> <span class="ow">not</span> <span class="n">I10Present</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="n">yo1I10</span> <span class="o">=</span> <span class="bp">None</span>
                    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">:</span>
                        <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">10</span> <span class="p">)</span> <span class="p">:</span> <span class="n">yo1I10</span> <span class="o">=</span> <span class="n">data</span>
                    <span class="n">yo12I10</span> <span class="o">=</span> <span class="bp">None</span>
                    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="p">:</span>
                        <span class="k">if</span><span class="p">(</span> <span class="n">data</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">10</span> <span class="p">)</span> <span class="p">:</span> <span class="n">yo12I10</span> <span class="o">=</span> <span class="n">data</span>
                    <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="n">yo1I10</span> <span class="o">!=</span> <span class="bp">None</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">yo12I10</span> <span class="o">!=</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                        <span class="n">yosDatas</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">yo12I10</span> <span class="p">)</span>
                        <span class="n">yo1I10</span><span class="o">.</span><span class="n">set</span><span class="p">(</span> <span class="n">yo1I10</span> <span class="o">-</span> <span class="n">yo12I10</span> <span class="p">)</span>
        <span class="k">for</span> <span class="n">yo</span> <span class="ow">in</span> <span class="n">yosDatas</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="n">yo</span><span class="p">]</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="n">yo</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">10</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">yosDatas</span><span class="p">[</span><span class="n">yo</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">I0</span> <span class="o">==</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s">&#39;Missing cross section data for reaction C = </span><span class="si">%d</span><span class="s"> S = </span><span class="si">%d</span><span class="s">.&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">C</span><span class="p">,</span> <span class="n">S</span> <span class="p">)</span> <span class="p">)</span>   <span class="c"># End of Phase 1</span>

        <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="n">C</span> <span class="o">==</span> <span class="mi">12</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">ZA</span> <span class="o">==</span> <span class="mi">4009</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">yi</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>  <span class="c"># Special case for Be_9(n,2n) which should really be Be_9(n,2n a)</span>
            <span class="n">specialCase</span> <span class="o">=</span> <span class="s">&#39;Be_9(n, 2n)&#39;</span>
            <span class="n">yos</span> <span class="o">=</span> <span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2004</span> <span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">yos</span> <span class="o">=</span> <span class="n">endl_C</span><span class="o">.</span><span class="n">endl_C_yoInfo</span><span class="p">(</span> <span class="n">C</span> <span class="p">)</span>                 <span class="c"># Phase 2. Determine products (i.e., yos and residuals).</span>
        <span class="k">for</span> <span class="n">yo</span> <span class="ow">in</span> <span class="n">yos</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">yo</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">C</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">74</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span> <span class="k">continue</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s">&#39;Electron, positron or electron capture (i.e., yo = 8, 9 or 10) not supported: C = </span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">C</span> <span class="p">)</span>
        <span class="n">residuals</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">yos</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">C</span> <span class="o">!=</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span> <span class="k">print</span> <span class="s">&#39;C = </span><span class="si">%d</span><span class="s"> with no yos is currently not handled by toGND&#39;</span> <span class="o">%</span> <span class="n">C</span>
            <span class="k">continue</span>
        <span class="k">elif</span><span class="p">(</span> <span class="n">yos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span> <span class="p">:</span>                              <span class="c"># Unknown yos.</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">C</span> <span class="o">!=</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span> <span class="k">print</span> <span class="s">&#39;C = </span><span class="si">%d</span><span class="s"> has unknown products which is currently not handled by toGND&#39;</span> <span class="o">%</span> <span class="n">C</span>
            <span class="k">continue</span>
        <span class="k">elif</span><span class="p">(</span> <span class="n">yos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span> <span class="p">)</span> <span class="p">:</span>                              <span class="c"># yo = yi</span>
            <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">yos</span> <span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span>
                <span class="k">print</span> <span class="s">&#39;product list = &#39;</span><span class="p">,</span> <span class="n">yos</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s">&#39;For C = </span><span class="si">%d</span><span class="s">, endl_C.endl_C_yoInfo returned -2 plus other products, only the -2 is supported.&#39;</span> <span class="o">%</span> <span class="n">C</span> <span class="p">)</span>
            <span class="n">yos</span> <span class="o">=</span> <span class="p">(</span> <span class="n">yosZAs</span><span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">yi</span> <span class="p">],</span> <span class="p">)</span>
            <span class="n">residuals</span> <span class="o">=</span> <span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">ZA</span> <span class="p">]</span>
        <span class="k">elif</span><span class="p">(</span> <span class="n">yos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">3</span> <span class="p">)</span> <span class="p">:</span>                                          <span class="c"># fission</span>
            <span class="n">residuals</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">99120</span><span class="p">,</span> <span class="mi">99120</span> <span class="p">]</span>
        <span class="k">elif</span><span class="p">(</span> <span class="n">yos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">4</span> <span class="p">)</span> <span class="p">:</span>                                          <span class="c"># nX?</span>
            <span class="k">pass</span>                                                        <span class="c"># Leave residuals empty as residual is undefined.</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">yiZA</span> <span class="o">=</span> <span class="n">endl2</span><span class="o">.</span><span class="n">yoToZA</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">yi</span> <span class="p">)</span>
            <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="n">yiZA</span> <span class="o">=</span> <span class="mi">1000</span> <span class="o">*</span> <span class="p">(</span> <span class="n">yiZA</span> <span class="o">/</span> <span class="mi">1000</span> <span class="p">)</span>
            <span class="n">productsZA</span> <span class="o">=</span> <span class="o">-</span><span class="n">yiZA</span>
            <span class="k">for</span> <span class="n">yo</span> <span class="ow">in</span> <span class="n">yos</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">yo</span> <span class="o">!=</span> <span class="mi">7</span> <span class="p">)</span> <span class="p">:</span> <span class="n">productsZA</span> <span class="o">+=</span> <span class="n">yo</span>
            <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="n">productsZA</span> <span class="o">=</span> <span class="mi">1000</span> <span class="o">*</span> <span class="p">(</span> <span class="n">productsZA</span> <span class="o">/</span> <span class="mi">1000</span> <span class="p">)</span>
            <span class="n">residuals</span> <span class="o">=</span> <span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">ZA</span> <span class="o">-</span> <span class="n">productsZA</span> <span class="p">]</span>        <span class="c"># End of phase 2</span>

        <span class="k">if</span><span class="p">(</span> <span class="mi">4008</span> <span class="ow">in</span> <span class="n">residuals</span> <span class="p">)</span> <span class="p">:</span>                                       <span class="c"># Special case for Be_8 breakup into two alphas</span>
            <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="mi">2004</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">yos</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">!=</span> <span class="p">[]</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">==</span> <span class="p">[]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                <span class="n">yosDatas</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
                <span class="n">yosDatas</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span><span class="p">(</span> <span class="mi">99000</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">ZA</span> <span class="o">&lt;</span> <span class="mi">99200</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">residuals</span> <span class="o">=</span> <span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">ZA</span> <span class="p">]</span>
        <span class="k">elif</span><span class="p">(</span> <span class="p">(</span> <span class="n">C</span> <span class="o">==</span> <span class="mi">30</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">endl2</span><span class="o">.</span><span class="n">yoToZA</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">yi</span> <span class="p">)</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">1002</span><span class="p">,</span> <span class="mi">1003</span> <span class="p">]</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">ZA</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">1002</span><span class="p">,</span> <span class="mi">1003</span> <span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>   <span class="c"># Special treatment for C = 30 as </span>
            <span class="k">if</span><span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">!=</span> <span class="p">[]</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s">&#39;C = 30 as yo = 6 data&#39;</span> <span class="p">)</span>                    <span class="c"># yos should be [ g, n ] and not [ g, n, a ].</span>
            <span class="n">yos</span> <span class="o">=</span> <span class="p">(</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span>
            <span class="n">residuals</span> <span class="o">=</span> <span class="p">(</span> <span class="mi">2004</span><span class="p">,</span> <span class="p">)</span>

        <span class="k">if</span><span class="p">(</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="k">print</span> <span class="s">&#39;   &#39;</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span>
        <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="n">yos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">C</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">74</span> <span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>  <span class="c"># Reactions that are two-body, two-body + break-up or discrete N-body except C = 71 - 74.</span>
            <span class="n">outputChannel</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="n">Is</span> <span class="o">=</span> <span class="n">getAllDistributionIs</span><span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="n">ZAsYos</span><span class="p">[</span><span class="n">yos</span><span class="p">[</span><span class="mi">0</span><span class="p">]]]</span> <span class="p">)</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">Is</span> <span class="o">==</span> <span class="p">[</span> <span class="mi">1</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span>     <span class="c"># Two-body initial product state.</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="k">print</span> <span class="s">&#39;2Body&#39;</span><span class="p">,</span>
                <span class="n">firstParticle</span> <span class="o">=</span> <span class="n">newGNDParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">yos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>    <span class="c"># Assume first particle is in the ground state.</span>
                <span class="n">addDistributionDataAndRemove</span><span class="p">(</span> <span class="n">firstParticle</span><span class="p">,</span> <span class="n">ZAsYos</span><span class="p">[</span><span class="n">yos</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">yosDatas</span> <span class="p">)</span>
                <span class="n">Q</span> <span class="o">=</span> <span class="n">returnConstantQ</span><span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">getQ</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span>
                <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">yos</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span>                                 <span class="c"># Simple two-body, yos[0] + Residual [ + gamma].</span>
                    <span class="n">resYo</span> <span class="o">=</span> <span class="n">residuals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">resYo</span> <span class="ow">in</span> <span class="n">ZAsYos</span> <span class="p">)</span> <span class="p">:</span> <span class="n">resYo</span> <span class="o">=</span> <span class="n">ZAsYos</span><span class="p">[</span><span class="n">resYo</span><span class="p">]</span> <span class="o">+</span> <span class="mi">10</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">S</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span>
                        <span class="n">Q</span> <span class="o">=</span> <span class="n">returnConstantQ</span><span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">getQ</span><span class="p">(</span> <span class="p">)</span> <span class="o">-</span> <span class="n">I0</span><span class="o">.</span><span class="n">getX1</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span>
                        <span class="n">resParticle</span> <span class="o">=</span> <span class="n">newGNDParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">residuals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>
                        <span class="n">addDistributionDataAndRemove</span><span class="p">(</span> <span class="n">resParticle</span><span class="p">,</span> <span class="n">resYo</span><span class="p">,</span> <span class="n">yosDatas</span> <span class="p">)</span>

                        <span class="n">decayChannel</span> <span class="o">=</span> <span class="bp">None</span>
                        <span class="k">if</span><span class="p">(</span> <span class="mi">7</span> <span class="ow">in</span> <span class="n">yos</span> <span class="p">)</span> <span class="p">:</span> <span class="k">print</span> <span class="s">&#39;7 in yos&#39;</span>
                        <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="mi">7</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">yos</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">getX1</span><span class="p">(</span> <span class="p">)</span> <span class="o">!=</span> <span class="mf">0.</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                            <span class="n">decayChannel</span> <span class="o">=</span> <span class="n">gnd</span><span class="o">.</span><span class="n">channels</span><span class="o">.</span><span class="n">NBodyDecayChannel</span><span class="p">(</span> <span class="n">returnConstantQ</span><span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">getX1</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>     <span class="c"># Assume residual returns to ground</span>
                            <span class="n">decayChannel</span><span class="o">.</span><span class="n">addProduct</span><span class="p">(</span> <span class="n">resParticle</span> <span class="p">)</span>                                              <span class="c"># state, hence Q = getX1( )</span>
                            <span class="n">gammaParticle</span> <span class="o">=</span> <span class="n">newGNDParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="mi">7</span> <span class="p">)</span> <span class="p">)</span>
                            <span class="k">if</span><span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">!=</span> <span class="p">[]</span> <span class="p">)</span> <span class="p">:</span>
                                <span class="n">addDistributionDataAndRemove</span><span class="p">(</span> <span class="n">gammaParticle</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">yosDatas</span> <span class="p">)</span>
                            <span class="n">decayChannel</span><span class="o">.</span><span class="n">addProduct</span><span class="p">(</span> <span class="n">gammaParticle</span> <span class="p">)</span>

                        <span class="n">level</span> <span class="o">=</span> <span class="n">I0</span><span class="o">.</span><span class="n">getX1</span><span class="p">(</span> <span class="p">)</span>
                        <span class="n">levelIndex</span> <span class="o">=</span> <span class="n">residualExcitationIndexLevels</span><span class="p">[</span><span class="n">residuals</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">level</span><span class="p">]</span>
                        <span class="k">if</span><span class="p">(</span> <span class="n">levelIndex</span> <span class="ow">is</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span> <span class="n">level</span> <span class="o">=</span> <span class="bp">None</span>
                        <span class="n">secondParticle</span> <span class="o">=</span> <span class="n">newGNDParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">residuals</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">level</span> <span class="o">=</span> <span class="n">level</span><span class="p">,</span> <span class="n">levelIndex</span> <span class="o">=</span> <span class="n">levelIndex</span> <span class="p">),</span> 
                            <span class="n">decayChannel</span> <span class="o">=</span> <span class="n">decayChannel</span> <span class="p">)</span>
                    <span class="k">else</span> <span class="p">:</span>
                        <span class="n">decayChannel</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">levelIndex</span><span class="p">,</span> <span class="n">resName</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span>
                        <span class="k">if</span><span class="p">(</span> <span class="n">S</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>
                            <span class="n">level</span> <span class="o">=</span> <span class="n">I0</span><span class="o">.</span><span class="n">getELevel</span><span class="p">(</span> <span class="p">)</span>
                            <span class="k">if</span><span class="p">(</span> <span class="n">C</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
                                <span class="n">levelIndex</span> <span class="o">=</span> <span class="n">c_Or_s_Level</span>
                                <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">!=</span> <span class="p">[]</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">residuals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">7</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
                                    <span class="n">decayChannel</span> <span class="o">=</span> <span class="n">gnd</span><span class="o">.</span><span class="n">channels</span><span class="o">.</span><span class="n">NBodyDecayChannel</span><span class="p">(</span> <span class="n">returnConstantQ</span><span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">getX1</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
                                    <span class="n">resParticle</span> <span class="o">=</span> <span class="n">newGNDParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">residuals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>       <span class="c"># Residual in ground state.</span>
                                    <span class="n">addDistributionDataAndRemove</span><span class="p">(</span> <span class="n">resParticle</span><span class="p">,</span> <span class="n">resYo</span><span class="p">,</span> <span class="n">yosDatas</span> <span class="p">)</span>
                                    <span class="n">decayChannel</span><span class="o">.</span><span class="n">addProduct</span><span class="p">(</span> <span class="n">resParticle</span> <span class="p">)</span>
                                    <span class="n">gammaParticle</span> <span class="o">=</span> <span class="n">newGNDParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="mi">7</span> <span class="p">)</span> <span class="p">)</span>
                                    <span class="n">addDistributionDataAndRemove</span><span class="p">(</span> <span class="n">gammaParticle</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">yosDatas</span> <span class="p">)</span>
                                    <span class="n">decayChannel</span><span class="o">.</span><span class="n">addProduct</span><span class="p">(</span> <span class="n">gammaParticle</span> <span class="p">)</span>
                            <span class="k">elif</span><span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">getELevel</span><span class="p">(</span> <span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span>            <span class="c"># Elastic scattering off an isomer</span>
                                <span class="n">levelIndex</span> <span class="o">=</span> <span class="n">residualExcitationIndexLevels</span><span class="p">[</span><span class="n">residuals</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">level</span><span class="p">]</span>
                                <span class="n">resName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
                            <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="n">level</span> <span class="o">==</span> <span class="mf">0.0</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">levelIndex</span> <span class="ow">is</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">level</span> <span class="o">=</span> <span class="bp">None</span>
                        <span class="k">if</span><span class="p">(</span> <span class="n">residuals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">2004</span> <span class="p">)</span> <span class="p">:</span> <span class="n">level</span><span class="p">,</span> <span class="n">levelIndex</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span>
                        <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s">&#39;Am242_m1&#39;</span> <span class="p">)</span> <span class="p">:</span> <span class="n">resName</span> <span class="o">=</span> <span class="n">reactionSuite</span><span class="o">.</span><span class="n">aliases</span><span class="p">[</span><span class="n">metaStableName</span><span class="p">]</span>
                        <span class="n">secondParticle</span> <span class="o">=</span> <span class="n">newGNDParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">residuals</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">level</span> <span class="o">=</span> <span class="n">level</span><span class="p">,</span> <span class="n">levelIndex</span> <span class="o">=</span> <span class="n">levelIndex</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="n">resName</span> <span class="p">),</span> 
                            <span class="n">decayChannel</span> <span class="o">=</span> <span class="n">decayChannel</span> <span class="p">)</span>
                        <span class="n">addDistributionDataAndRemove</span><span class="p">(</span> <span class="n">secondParticle</span><span class="p">,</span> <span class="n">resYo</span><span class="p">,</span> <span class="n">yosDatas</span> <span class="p">)</span>
                <span class="k">else</span> <span class="p">:</span>                                          <span class="c"># Two-body with residual breaking up.</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="k">print</span> <span class="s">&#39;w/breakup&#39;</span><span class="p">,</span>
                    <span class="k">if</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s">&#39;For C = </span><span class="si">%d</span><span class="s">, breakup of product not supported for two-body reaction for natural target.&#39;</span> <span class="p">)</span>
                    <span class="n">mYos</span> <span class="o">=</span> <span class="n">getMultiplicityYos</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">yos</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">residuals</span><span class="p">,</span> <span class="n">yosDatas</span> <span class="p">)</span>
                    <span class="n">residualZA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ZA</span> <span class="o">+</span> <span class="n">endl2</span><span class="o">.</span><span class="n">yoToZA</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">yi</span> <span class="p">)</span> <span class="o">-</span> <span class="n">yos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">levelIndex</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="n">c_Or_s_Level</span><span class="p">,</span> <span class="mf">0.0</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">S</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">:</span>
                        <span class="n">level</span> <span class="o">=</span> <span class="n">I0</span><span class="o">.</span><span class="n">getX1</span><span class="p">(</span> <span class="p">)</span>

                        <span class="n">levelIndex</span> <span class="o">=</span> <span class="n">residualExcitationIndexLevels</span><span class="p">[</span><span class="n">residualZA</span><span class="p">][</span><span class="n">level</span><span class="p">]</span>
                    <span class="k">elif</span><span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">S</span> <span class="o">==</span> <span class="mi">8</span> <span class="p">)</span> <span class="p">:</span> 
                        <span class="n">levelIndex</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">I0</span><span class="o">.</span><span class="n">getX1</span><span class="p">(</span> <span class="p">)</span>
                    <span class="n">Q_MeV</span> <span class="o">=</span> <span class="n">endl2</span><span class="o">.</span><span class="n">reactionQByZAs</span><span class="p">(</span> <span class="p">[</span> <span class="n">endl2</span><span class="o">.</span><span class="n">yoToZA</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">yi</span> <span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">ZA</span> <span class="p">],</span> <span class="p">[</span> <span class="n">yos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">residualZA</span> <span class="p">]</span> <span class="p">)</span> <span class="o">-</span> <span class="n">level</span>
                    <span class="n">residualName</span> <span class="o">=</span> <span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">residualZA</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="n">level</span><span class="p">,</span> <span class="n">levelIndex</span> <span class="o">=</span> <span class="n">levelIndex</span> <span class="p">)</span>
                    <span class="n">decayChannel</span> <span class="o">=</span> <span class="n">makeNBodyChannelFrom_mYos</span><span class="p">(</span> <span class="n">gnd</span><span class="o">.</span><span class="n">channels</span><span class="o">.</span><span class="n">NBodyDecayChannel</span><span class="p">,</span> <span class="n">mYos</span><span class="p">,</span> <span class="n">ZAsYos</span><span class="p">,</span> <span class="n">yosDatas</span><span class="p">,</span> <span class="n">I0</span><span class="o">.</span><span class="n">getQ</span><span class="p">(</span> <span class="p">)</span> <span class="o">-</span> <span class="n">Q_MeV</span><span class="p">,</span> 
                        <span class="n">specialCase</span> <span class="o">=</span> <span class="n">specialCase</span> <span class="p">)</span>
                    <span class="n">secondParticle</span> <span class="o">=</span> <span class="n">newGNDParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">residualName</span><span class="p">,</span> <span class="n">decayChannel</span> <span class="o">=</span> <span class="n">decayChannel</span> <span class="p">)</span>
                    <span class="n">Q</span> <span class="o">=</span> <span class="n">returnConstantQ</span><span class="p">(</span> <span class="n">Q_MeV</span> <span class="p">)</span>
                <span class="n">outputChannel</span> <span class="o">=</span> <span class="n">gnd</span><span class="o">.</span><span class="n">channels</span><span class="o">.</span><span class="n">twoBodyOutputChannel</span><span class="p">(</span> <span class="n">Q</span> <span class="p">)</span>
                <span class="n">outputChannel</span><span class="o">.</span><span class="n">addProduct</span><span class="p">(</span> <span class="n">firstParticle</span> <span class="p">)</span>
                <span class="n">outputChannel</span><span class="o">.</span><span class="n">addProduct</span><span class="p">(</span> <span class="n">secondParticle</span> <span class="p">)</span>
            <span class="k">else</span> <span class="p">:</span>                                              <span class="c"># Mutli-particle breakup (i.e., not two body).</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="k">print</span> <span class="s">&#39;NBody&#39;</span><span class="p">,</span>
                <span class="n">mYos</span> <span class="o">=</span> <span class="n">getMultiplicityYos</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">yos</span><span class="p">,</span> <span class="n">residuals</span><span class="p">,</span> <span class="n">yosDatas</span> <span class="p">)</span>
                <span class="n">gammaPresent</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">yo</span> <span class="ow">in</span> <span class="n">mYos</span> <span class="p">:</span> <span class="n">gammaPresent</span> <span class="o">=</span> <span class="n">gammaPresent</span> <span class="ow">or</span> <span class="p">(</span> <span class="n">yo</span> <span class="o">==</span> <span class="mi">7</span> <span class="p">)</span>
                <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="ow">not</span> <span class="n">gammaPresent</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">!=</span> <span class="p">[]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">mYos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span> <span class="p">]</span> <span class="p">)</span>
                <span class="n">decayChannelInfo</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">specialCase</span> <span class="o">==</span> <span class="s">&#39;Be_9(n, 2n)&#39;</span> <span class="p">)</span> <span class="p">:</span>                                            <span class="c"># Special case for endl Be_9(n, 2n)</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="p">[]</span> <span class="p">)</span> <span class="p">:</span> <span class="n">mYos</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2004</span><span class="p">]</span> <span class="p">]</span>
                <span class="k">elif</span><span class="p">(</span> <span class="p">(</span> <span class="n">mYos</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4008</span> <span class="p">]</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">!=</span> <span class="p">[]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>                <span class="c"># Note_Be_9: Special case for breakup of Be_8 into two He_4&#39;s.</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s">&#39;See note &quot;Note_Be_9&quot;&#39;</span> <span class="p">)</span>
                    <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">!=</span> <span class="p">[]</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">!=</span> <span class="p">[]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span>                    <span class="c"># This elif is probably not used anymore, replaced by</span>
                        <span class="n">decayChannel</span> <span class="o">=</span> <span class="n">gnd</span><span class="o">.</span><span class="n">channels</span><span class="o">.</span><span class="n">NBodyDecayChannel</span><span class="p">(</span> <span class="p">)</span>                        <span class="c"># prior if.</span>

                        <span class="n">He4Particle</span> <span class="o">=</span> <span class="n">newGNDParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="mi">2004</span> <span class="p">)</span> <span class="p">)</span>
                        <span class="n">addDistributionDataAndRemove</span><span class="p">(</span> <span class="n">He4Particle</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">yosDatas</span> <span class="p">)</span>
                        <span class="n">decayChannel</span><span class="o">.</span><span class="n">addProduct</span><span class="p">(</span> <span class="n">He4Particle</span> <span class="p">)</span>

                        <span class="n">He4Particle</span> <span class="o">=</span> <span class="n">newGNDParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="mi">2004</span> <span class="p">)</span> <span class="p">)</span> 
                        <span class="n">addDistributionDataAndRemove</span><span class="p">(</span> <span class="n">He4Particle</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">yosDatas</span> <span class="p">)</span>
                        <span class="n">decayChannel</span><span class="o">.</span><span class="n">addProduct</span><span class="p">(</span> <span class="n">He4Particle</span> <span class="p">)</span>
                        <span class="n">decayChannelInfo</span> <span class="o">=</span> <span class="p">[</span> <span class="nb">len</span><span class="p">(</span> <span class="n">mYos</span> <span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">decayChannel</span> <span class="p">]</span>
                    <span class="k">else</span> <span class="p">:</span>
                        <span class="n">He4Particle</span> <span class="o">=</span> <span class="n">newGNDParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="mi">2004</span> <span class="p">),</span> <span class="n">multiplicity</span> <span class="o">=</span> <span class="mi">2</span> <span class="p">)</span>
                        <span class="n">addDistributionDataAndRemove</span><span class="p">(</span> <span class="n">He4Particle</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">yosDatas</span> <span class="p">)</span>
                        <span class="n">decayChannel</span> <span class="o">=</span> <span class="n">gnd</span><span class="o">.</span><span class="n">channels</span><span class="o">.</span><span class="n">NBodyDecayChannel</span><span class="p">(</span> <span class="p">)</span>
                        <span class="n">decayChannel</span><span class="o">.</span><span class="n">addProduct</span><span class="p">(</span> <span class="n">He4Particle</span> <span class="p">)</span>
                        <span class="n">decayChannelInfo</span> <span class="o">=</span> <span class="p">[</span> <span class="nb">len</span><span class="p">(</span> <span class="n">mYos</span> <span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">decayChannel</span> <span class="p">]</span>
                        <span class="n">specialCase</span> <span class="o">=</span> <span class="bp">None</span>
                <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="n">S</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">C</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">45</span> <span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">specialCase</span> <span class="o">=</span> <span class="s">&#39;unknown level&#39;</span>
                <span class="n">outputChannel</span> <span class="o">=</span> <span class="n">makeNBodyChannelFrom_mYos</span><span class="p">(</span> <span class="n">gnd</span><span class="o">.</span><span class="n">channels</span><span class="o">.</span><span class="n">NBodyOutputChannel</span><span class="p">,</span> <span class="n">mYos</span><span class="p">,</span> <span class="n">ZAsYos</span><span class="p">,</span> <span class="n">yosDatas</span><span class="p">,</span> <span class="n">I0</span><span class="o">.</span><span class="n">getQ</span><span class="p">(</span> <span class="p">),</span> 
                    <span class="n">specialCase</span> <span class="o">=</span> <span class="n">specialCase</span><span class="p">,</span> <span class="n">decayChannelInfo</span> <span class="o">=</span> <span class="n">decayChannelInfo</span><span class="p">,</span> <span class="n">levelIndex</span> <span class="o">=</span> <span class="n">c_Or_s_Level</span> <span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span>  <span class="c"># Reactions that are not two-body, two-body + break-up or discrete N-body except C = 71 to 74.</span>
            <span class="k">if</span><span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">C</span> <span class="o">==</span> <span class="mi">15</span> <span class="p">)</span> <span class="p">:</span>                              <span class="c"># Fission</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="k">print</span> <span class="s">&#39;Fission&#39;</span><span class="p">,</span>
                <span class="n">outputChannel</span> <span class="o">=</span> <span class="n">gnd</span><span class="o">.</span><span class="n">channels</span><span class="o">.</span><span class="n">fissionChannel</span><span class="p">(</span> <span class="n">returnConstantQ</span><span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">getQ</span><span class="p">(</span> <span class="p">)</span> <span class="p">),</span> <span class="n">fissionGenre</span> <span class="o">=</span> <span class="n">gnd</span><span class="o">.</span><span class="n">channels</span><span class="o">.</span><span class="n">fissionGenreTotal</span> <span class="p">)</span>
                <span class="n">particle</span> <span class="o">=</span> <span class="n">newGNDParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">addDistributionDataAndRemove</span><span class="p">(</span> <span class="n">particle</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">yosDatas</span> <span class="p">)</span>
                <span class="n">outputChannel</span><span class="o">.</span><span class="n">addProduct</span><span class="p">(</span> <span class="n">particle</span> <span class="p">)</span>
                <span class="n">decayRates</span> <span class="o">=</span> <span class="n">delayedNeutrons</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span> <span class="p">)</span>
                <span class="n">decayRates</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span> <span class="p">)</span>
                <span class="n">decayRates</span><span class="o">.</span><span class="n">reverse</span><span class="p">(</span> <span class="p">)</span>
                <span class="k">for</span> <span class="n">decayRate</span> <span class="ow">in</span> <span class="n">decayRates</span><span class="p">:</span>
                    <span class="n">delayedData</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">delayedNeutrons</span><span class="p">[</span><span class="n">decayRate</span><span class="p">]</span> <span class="p">}</span>
                    <span class="n">delayedParticle</span> <span class="o">=</span> <span class="n">newGNDParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span>
                    <span class="n">addDistributionDataAndRemove</span><span class="p">(</span> <span class="n">delayedParticle</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">delayedData</span><span class="p">,</span> <span class="n">promptNeutronParticle</span> <span class="o">=</span> <span class="n">particle</span> <span class="p">)</span>
                    <span class="n">outputChannel</span><span class="o">.</span><span class="n">addProduct</span><span class="p">(</span> <span class="n">delayedParticle</span> <span class="p">)</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">!=</span> <span class="p">[]</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="n">gammaParticle</span> <span class="o">=</span> <span class="n">newGNDParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="mi">7</span> <span class="p">)</span> <span class="p">)</span>
                    <span class="n">addDistributionDataAndRemove</span><span class="p">(</span> <span class="n">gammaParticle</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">yosDatas</span> <span class="p">)</span>
                    <span class="n">outputChannel</span><span class="o">.</span><span class="n">addProduct</span><span class="p">(</span> <span class="n">gammaParticle</span> <span class="p">)</span>
            <span class="k">elif</span><span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">C</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">74</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="k">print</span> <span class="s">&quot;7[124]&quot;</span><span class="p">,</span>
                <span class="n">qualifier</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">71</span> <span class="p">:</span> <span class="s">&#39;coherent&#39;</span><span class="p">,</span> <span class="mi">72</span> <span class="p">:</span> <span class="s">&#39;incoherent&#39;</span><span class="p">,</span> <span class="mi">74</span> <span class="p">:</span> <span class="s">&#39;pair production&#39;</span> <span class="p">}[</span><span class="n">I0</span><span class="o">.</span><span class="n">C</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">4</span> <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span> <span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">C</span> <span class="o">==</span> <span class="mi">74</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">I</span> <span class="o">==</span> <span class="mi">10</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">del</span> <span class="n">yosDatas</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                <span class="n">firstParticle</span> <span class="o">=</span> <span class="n">newGNDParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="mi">7</span> <span class="p">),</span> <span class="n">attributes</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&#39;scattering&#39;</span> <span class="p">:</span> <span class="n">qualifier</span> <span class="p">}</span> <span class="p">)</span>
                <span class="n">addDistributionDataAndRemove</span><span class="p">(</span> <span class="n">firstParticle</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">yosDatas</span> <span class="p">)</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">C</span> <span class="o">==</span> <span class="mi">74</span> <span class="p">)</span> <span class="p">:</span> 
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s">&#39;A distribution class is needed here&#39;</span> <span class="p">)</span>
                    <span class="n">firstParticle</span><span class="o">.</span><span class="n">setGenre</span><span class="p">(</span> <span class="n">distributions</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">NBodyGenre</span> <span class="p">)</span>
                <span class="n">secondParticle</span> <span class="o">=</span> <span class="n">newGNDParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">residuals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">C</span> <span class="ow">in</span> <span class="p">[</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">72</span> <span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
                    <span class="n">outputChannel</span> <span class="o">=</span> <span class="n">gnd</span><span class="o">.</span><span class="n">channels</span><span class="o">.</span><span class="n">twoBodyOutputChannel</span><span class="p">(</span> <span class="n">returnConstantQ</span><span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">getQ</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
                <span class="k">else</span> <span class="p">:</span>
                    <span class="n">outputChannel</span> <span class="o">=</span> <span class="n">gnd</span><span class="o">.</span><span class="n">channels</span><span class="o">.</span><span class="n">NBodyOutputChannel</span><span class="p">(</span> <span class="n">returnConstantQ</span><span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">getQ</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">outputChannel</span><span class="o">.</span><span class="n">addProduct</span><span class="p">(</span> <span class="n">firstParticle</span> <span class="p">)</span>
                <span class="n">outputChannel</span><span class="o">.</span><span class="n">addProduct</span><span class="p">(</span> <span class="n">secondParticle</span> <span class="p">)</span>
            <span class="k">elif</span><span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">C</span> <span class="o">==</span> <span class="mi">73</span> <span class="p">)</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="k">print</span> <span class="s">&quot;73&quot;</span><span class="p">,</span>
                <span class="n">firstParticle</span> <span class="o">=</span> <span class="n">newGNDParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="mi">9</span> <span class="p">),</span> <span class="n">attributes</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&#39;scattering&#39;</span> <span class="p">:</span> <span class="s">&#39;photo-electric&#39;</span> <span class="p">}</span> <span class="p">)</span>
                <span class="n">secondParticle</span> <span class="o">=</span> <span class="n">newGNDParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">residuals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">outputChannel</span> <span class="o">=</span> <span class="n">gnd</span><span class="o">.</span><span class="n">channels</span><span class="o">.</span><span class="n">NBodyOutputChannel</span><span class="p">(</span> <span class="n">returnConstantQ</span><span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">getQ</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">outputChannel</span><span class="o">.</span><span class="n">addProduct</span><span class="p">(</span> <span class="n">firstParticle</span> <span class="p">)</span>
                <span class="n">outputChannel</span><span class="o">.</span><span class="n">addProduct</span><span class="p">(</span> <span class="n">secondParticle</span> <span class="p">)</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="k">if</span><span class="p">(</span> <span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">C</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">C</span> <span class="o">&lt;</span> <span class="mi">57</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> 
                    <span class="k">if</span><span class="p">(</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="k">print</span> <span class="s">&quot;production&quot;</span><span class="p">,</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">yos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">4</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s">&#39;Does not appear to be production channel. Internal error. C = </span><span class="si">%d</span><span class="s">, yos = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">C</span><span class="p">,</span> <span class="sb">`yos`</span> <span class="p">)</span> <span class="p">)</span>
                    <span class="n">attributes</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="k">if</span><span class="p">(</span> <span class="p">(</span><span class="n">I0</span><span class="o">.</span><span class="n">S</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">yos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">7</span><span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">attributes</span><span class="p">[</span><span class="s">&#39;discrete&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">physicalQuantityWithUncertainty</span><span class="o">.</span><span class="n">PhysicalQuantityWithUncertainty</span><span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">getX1</span><span class="p">(</span> <span class="p">),</span> <span class="s">&#39;MeV&#39;</span> <span class="p">)</span>
                    <span class="n">multiplicity</span> <span class="o">=</span> <span class="n">gnd</span><span class="o">.</span><span class="n">productData</span><span class="o">.</span><span class="n">multiplicity</span><span class="o">.</span><span class="n">partialProduction</span><span class="p">(</span> <span class="p">)</span>
                    <span class="n">particle</span> <span class="o">=</span> <span class="n">newGNDParticle</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">getTypeName</span><span class="p">(</span> <span class="n">info</span><span class="p">,</span> <span class="n">yos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">),</span> <span class="n">attributes</span><span class="p">,</span> <span class="n">multiplicity</span> <span class="o">=</span> <span class="n">multiplicity</span> <span class="p">)</span>
                    <span class="n">addDistributionDataAndRemove</span><span class="p">(</span> <span class="n">particle</span><span class="p">,</span> <span class="n">ZAsYos</span><span class="p">[</span><span class="n">yos</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">yosDatas</span> <span class="p">)</span>
                    <span class="n">outputChannel</span> <span class="o">=</span> <span class="n">gnd</span><span class="o">.</span><span class="n">channels</span><span class="o">.</span><span class="n">productionChannel</span><span class="p">(</span> <span class="p">)</span>
                    <span class="n">outputChannel</span><span class="o">.</span><span class="n">addProduct</span><span class="p">(</span> <span class="n">particle</span> <span class="p">)</span>
                <span class="k">else</span> <span class="p">:</span>
                    <span class="k">if</span><span class="p">(</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="k">print</span>
                    <span class="k">print</span> <span class="s">&quot;NONO:&quot;</span><span class="p">,</span> <span class="n">I0</span>
                    <span class="k">continue</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">:</span> <span class="k">print</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">testing</span> <span class="p">)</span> <span class="p">:</span> <span class="k">print</span> <span class="s">&#39;label </span><span class="si">%2d</span><span class="s"> </span><span class="si">%2s</span><span class="s">: </span><span class="si">%-100s</span><span class="s">  ### </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">C</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">reactionSuite</span><span class="o">.</span><span class="n">inputParticlesToReactionString</span><span class="p">(</span> <span class="n">suffix</span> <span class="o">=</span> <span class="s">&#39; --&gt; &#39;</span> <span class="p">)</span> <span class="o">+</span> \
            <span class="nb">str</span><span class="p">(</span> <span class="n">outputChannel</span> <span class="p">),</span> <span class="n">outputChannel</span><span class="o">.</span><span class="n">genre</span> <span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span> <span class="n">outputChannel</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">S</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s">&#39; S2&#39;</span>
        <span class="k">elif</span><span class="p">(</span> <span class="n">C</span> <span class="o">==</span> <span class="mi">9</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s">&#39; n+i&#39;</span>
        <span class="k">elif</span><span class="p">(</span> <span class="n">C</span> <span class="o">==</span> <span class="mi">55</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s">&#39; discreteEnergy = </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">I0</span><span class="o">.</span><span class="n">getX1</span><span class="p">(</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">channelList</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">endlmisc</span><span class="o">.</span><span class="n">printWarning</span><span class="p">(</span> <span class="s">&#39;WARNING: </span><span class="si">%s</span><span class="s"> already in list for </span><span class="si">%d</span><span class="s">: C=</span><span class="si">%s</span><span class="s">, S=</span><span class="si">%s</span><span class="s">, X1=</span><span class="si">%s</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">s</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ZA</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">I0</span><span class="o">.</span><span class="n">getX1</span><span class="p">(</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">channelList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">s</span> <span class="p">)</span>

        <span class="k">if</span><span class="p">(</span> <span class="n">I12</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span> 
            <span class="n">energyDependentQ</span> <span class="o">=</span> <span class="n">gnd</span><span class="o">.</span><span class="n">channelData</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">component</span><span class="p">(</span> <span class="p">)</span>
            <span class="n">axes_</span> <span class="o">=</span> <span class="n">gnd</span><span class="o">.</span><span class="n">channelData</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">pointwise</span><span class="o">.</span><span class="n">defaultAxes</span><span class="p">(</span> <span class="n">energyUnit</span> <span class="o">=</span> <span class="s">&#39;MeV&#39;</span><span class="p">,</span> <span class="n">energyInterpolation</span> <span class="o">=</span> <span class="n">xInterpolationStr</span><span class="p">,</span> <span class="n">QUnit</span> <span class="o">=</span> <span class="s">&#39;MeV&#39;</span><span class="p">,</span> <span class="n">QInterpolation</span> <span class="o">=</span> <span class="n">yInterpolationStr</span> <span class="p">)</span>
            <span class="n">energyDependentQ</span><span class="o">.</span><span class="n">addForm</span><span class="p">(</span> <span class="n">gnd</span><span class="o">.</span><span class="n">channelData</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">pointwise</span><span class="p">(</span> <span class="n">axes_</span><span class="p">,</span> <span class="n">I12</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">ENDL_Accuracy</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">outputChannel</span><span class="o">.</span><span class="n">setQ</span><span class="p">(</span> <span class="n">energyDependentQ</span> <span class="p">)</span>
        <span class="n">crossSection</span> <span class="o">=</span> <span class="n">gnd</span><span class="o">.</span><span class="n">reactionData</span><span class="o">.</span><span class="n">crossSection</span><span class="o">.</span><span class="n">component</span><span class="p">(</span> <span class="n">nativeData</span> <span class="o">=</span> <span class="n">gnd</span><span class="o">.</span><span class="n">tokens</span><span class="o">.</span><span class="n">pointwiseFormToken</span> <span class="p">)</span>
        <span class="n">xInterpolationStr</span><span class="p">,</span> <span class="n">yInterpolationStr</span> <span class="o">=</span> <span class="n">getXYInterpolation</span><span class="p">(</span> <span class="n">I0</span> <span class="p">)</span>
        <span class="n">axes_</span> <span class="o">=</span> <span class="n">gnd</span><span class="o">.</span><span class="n">reactionData</span><span class="o">.</span><span class="n">crossSection</span><span class="o">.</span><span class="n">pointwise</span><span class="o">.</span><span class="n">defaultAxes</span><span class="p">(</span> <span class="n">energyUnit</span> <span class="o">=</span> <span class="s">&#39;MeV&#39;</span><span class="p">,</span> <span class="n">energyInterpolation</span> <span class="o">=</span> <span class="n">xInterpolationStr</span><span class="p">,</span> \
            <span class="n">crossSectionInterpolation</span> <span class="o">=</span> <span class="n">yInterpolationStr</span> <span class="p">)</span>
        <span class="n">crossSection</span><span class="o">.</span><span class="n">addForm</span><span class="p">(</span> <span class="n">gnd</span><span class="o">.</span><span class="n">reactionData</span><span class="o">.</span><span class="n">crossSection</span><span class="o">.</span><span class="n">pointwise</span><span class="p">(</span> <span class="n">axes_</span><span class="p">,</span> <span class="n">I0</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">ENDL_Accuracy</span> <span class="p">)</span> <span class="p">)</span>

        <span class="n">CCounts</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">findDatas</span><span class="p">(</span> <span class="n">C</span> <span class="o">=</span> <span class="n">I0</span><span class="o">.</span><span class="n">C</span><span class="p">,</span> <span class="n">I</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">)</span>
        <span class="n">MT</span> <span class="o">=</span> <span class="n">ENDLCS_To_ENDFMT</span><span class="o">.</span><span class="n">getMTFromCS</span><span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">C</span><span class="p">,</span> <span class="n">I0</span><span class="o">.</span><span class="n">S</span><span class="p">,</span> <span class="n">CCounts</span> <span class="o">=</span> <span class="n">CCounts</span> <span class="p">)</span>
        <span class="n">reaction</span> <span class="o">=</span> <span class="n">gnd</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">reaction</span><span class="p">(</span> <span class="n">outputChannel</span><span class="p">,</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">iChannel</span><span class="p">,</span> <span class="n">ENDF_MT</span> <span class="o">=</span> <span class="n">MT</span><span class="p">,</span> <span class="n">crossSection</span> <span class="o">=</span> <span class="n">crossSection</span><span class="p">,</span> <span class="n">URRProbabilityTable</span> <span class="o">=</span> <span class="n">I20</span> <span class="p">)</span>

        <span class="n">temperature</span> <span class="o">=</span> <span class="n">physicalQuantityWithUncertainty</span><span class="o">.</span><span class="n">PhysicalQuantityWithUncertainty</span><span class="p">(</span> <span class="n">I0</span><span class="o">.</span><span class="n">getTemperature</span><span class="p">(</span> <span class="p">),</span> <span class="s">&#39;MeV&#39;</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">temperature</span> <span class="o">!=</span> <span class="n">reactionSuite</span><span class="o">.</span><span class="n">getAttribute</span><span class="p">(</span> <span class="s">&#39;temperature&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s">&#39;temperatures do not match for reaction </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="sb">`reaction`</span> <span class="p">)</span>

        <span class="c"># date to string:</span>
        <span class="n">maxReactionDate</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">maxReactionDate</span><span class="p">)</span>
        <span class="n">maxReactionDate</span> <span class="o">=</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s">-</span><span class="si">%s</span><span class="s">-</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">maxReactionDate</span><span class="p">[:</span><span class="mi">4</span><span class="p">],</span><span class="n">maxReactionDate</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">],</span><span class="n">maxReactionDate</span><span class="p">[</span><span class="mi">6</span><span class="p">:])</span>
        
        <span class="n">reaction</span><span class="o">.</span><span class="n">setAttribute</span><span class="p">(</span> <span class="s">&#39;date&#39;</span><span class="p">,</span> <span class="n">maxReactionDate</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">S</span> <span class="o">==</span> <span class="mi">8</span> <span class="p">)</span> <span class="p">:</span> <span class="n">reaction</span><span class="o">.</span><span class="n">setAttribute</span><span class="p">(</span> <span class="s">&#39;process&#39;</span><span class="p">,</span> <span class="s">&quot;ENDL_S8&quot;</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">C</span> <span class="o">==</span> <span class="mi">8</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">reaction</span><span class="o">.</span><span class="n">setAttribute</span><span class="p">(</span> <span class="s">&#39;process&#39;</span><span class="p">,</span> <span class="s">&quot;largeAngleCoulombScattering&quot;</span> <span class="p">)</span>
        <span class="k">elif</span><span class="p">(</span> <span class="n">C</span> <span class="o">==</span> <span class="mi">9</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">reaction</span><span class="o">.</span><span class="n">setAttribute</span><span class="p">(</span> <span class="s">&#39;process&#39;</span><span class="p">,</span> <span class="s">&quot;nuclearInterferenceForLargeAngleCoulombScattering&quot;</span> <span class="p">)</span>
        <span class="k">elif</span><span class="p">(</span> <span class="n">specialCase</span> <span class="o">==</span> <span class="s">&#39;Be_9(n, 2n)&#39;</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">reaction</span><span class="o">.</span><span class="n">setAttribute</span><span class="p">(</span> <span class="s">&#39;process&#39;</span><span class="p">,</span> <span class="n">specialCase</span> <span class="p">)</span>

        <span class="k">if</span><span class="p">(</span> <span class="n">C</span> <span class="o">==</span> <span class="mi">55</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">reaction</span><span class="o">.</span><span class="n">__class__</span> <span class="o">=</span> <span class="n">gnd</span><span class="o">.</span><span class="n">partialGammaProduction</span><span class="o">.</span><span class="n">partialGammaProduction</span>
            <span class="n">reaction</span><span class="o">.</span><span class="n">moniker</span> <span class="o">=</span> <span class="n">gnd</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">partialGammaProductionToken</span>
            <span class="n">reactionSuite</span><span class="o">.</span><span class="n">addPartialGammaProduction</span><span class="p">(</span> <span class="n">reaction</span><span class="p">,</span> <span class="n">iChannel</span> <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">reactionSuite</span><span class="o">.</span><span class="n">addReaction</span><span class="p">(</span> <span class="n">reaction</span><span class="p">,</span> <span class="n">iChannel</span> <span class="p">)</span>
        <span class="k">for</span> <span class="n">yo</span> <span class="ow">in</span> <span class="n">yosDatas</span> <span class="p">:</span>
            <span class="k">if</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">yosDatas</span><span class="p">[</span><span class="n">yo</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">endlmisc</span><span class="o">.</span><span class="n">printWarning</span><span class="p">(</span> <span class="s">&#39;WARNING: unused data for ZA = </span><span class="si">%d</span><span class="s">, yo = </span><span class="si">%d</span><span class="se">\n</span><span class="s">    </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">ZA</span><span class="p">,</span> <span class="n">yo</span><span class="p">,</span> <span class="sb">`yosDatas[yo]`</span> <span class="p">)</span> <span class="p">)</span>

    <span class="n">maxDate</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">maxDate</span><span class="p">)</span>
    <span class="n">maxDate</span> <span class="o">=</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s">-</span><span class="si">%s</span><span class="s">-</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">maxDate</span><span class="p">[:</span><span class="mi">4</span><span class="p">],</span><span class="n">maxDate</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">],</span><span class="n">maxDate</span><span class="p">[</span><span class="mi">6</span><span class="p">:])</span>
    <span class="n">evaluatedStyle</span><span class="o">.</span><span class="n">setAttribute</span><span class="p">(</span> <span class="s">&#39;date&#39;</span><span class="p">,</span> <span class="n">maxDate</span> <span class="p">)</span>

    <span class="n">documentation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDocumentation</span><span class="p">()</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">documentation</span> <span class="ow">is</span> <span class="bp">None</span> <span class="p">)</span> <span class="p">:</span> <span class="n">documentation</span> <span class="o">=</span> <span class="s">&quot;No documentation!&quot;</span>
    <span class="n">docs</span> <span class="o">=</span> <span class="n">gnd</span><span class="o">.</span><span class="n">documentation</span><span class="o">.</span><span class="n">documentation</span><span class="p">(</span> <span class="s">&quot;ENDL&quot;</span><span class="p">,</span> <span class="n">documentation</span> <span class="p">)</span>
    <span class="n">reactionSuite</span><span class="o">.</span><span class="n">addDocumentation</span><span class="p">(</span> <span class="n">docs</span> <span class="p">)</span>

    <span class="k">return</span><span class="p">(</span> <span class="n">reactionSuite</span> <span class="p">)</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../../index.html">
              <img class="logo" src="../../../../_static/gnd.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../../index.html">Fudge and GND 1.2 beta documentation</a> &raquo;</li>
          <li><a href="../../../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, B.Beck, D. Brown, C. Mattoon, N. Patel, N. Summers.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>