
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pqu.physicalQuantityWithUncertainty &mdash; Fudge and GND 1.2 beta documentation</title>
    
    <link rel="stylesheet" href="../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.2 beta',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../_static/gnd-20121206-favicon.ico"/>
    <link rel="top" title="Fudge and GND 1.2 beta documentation" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">Fudge and GND 1.2 beta documentation</a> &raquo;</li>
          <li><a href="../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for pqu.physicalQuantityWithUncertainty</h1><div class="highlight"><pre>
<span class="c"># This is *now more than* a slight mod of the</span>
<span class="c"># Scientific/Physics/PhysicalQuantities.py package, Physical quantities with </span>
<span class="c"># units. Written by Konrad Hinsen &lt;hinsen@cnrs-orleans.fr&gt; with contributions</span>
<span class="c"># from Greg Ward. Last revision: 2007-5-25</span>

<span class="c"># What is lacking?</span>
<span class="c">#   -) Cannot handle unitless quantities </span>
<span class="c">#      (e.g., &quot;a = PhysicalQuantityWithUncertainty(&#39;1&#39;)&quot;) and in</span>
<span class="c">#      &quot;a = PhysicalQuantityWithUncertainty(&#39;1 m&#39;); b = a / a&quot;, b is returned as</span>
<span class="c">#      a float not a PhysicalQuantityWithUncertainty.</span>
<span class="c">#   -) Cannot handle numbers starting with &quot;.&quot;, (e.g., &quot;0.001 eV&quot; works but</span>
<span class="c">#      &quot;.001 eV&quot; does not.</span>

<span class="c"># Modified by Nidhi R. Patel &lt;infinidhi@llnl.gov&gt; and Bret Beck &lt;beck6@llnl.gov&gt;</span>
<span class="c"># Last revision: 2012-7-27</span>

<span class="c"># What is new?</span>
<span class="c"># 1. Added support for dimensionless quantity</span>

<span class="c"># What is in the works?</span>
<span class="c"># 1. Various ways to define physical quantity with uncertainty</span>
<span class="c"># 2. Significant figures</span>
<span class="c"># 3. &#39;%&#39; as unit</span>
<span class="c"># 4. Linear propagation of errors</span>
<span class="c"># 5. Fundamental constants read from NIST codata text file</span>


<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">.. rubric:: PHYSICAL QUANTITY WITH UNCERTAINTY</span>

<span class="sd">This module provides a data type that represents a physical quantity together </span>
<span class="sd">with its unit. It is possible to add and subtract these quantities if the units </span>
<span class="sd">are compatible, and a quantity can be converted to another compatible unit. </span>
<span class="sd">Multiplication, subtraction, and raising to integer powers is allowed without </span>
<span class="sd">restriction, and the result will have the correct unit. A quantity can be raised</span>
<span class="sd">to a non-integer power only if the result can be represented by integer powers </span>
<span class="sd">of the base units.</span>

<span class="sd">The values of physical constants are taken from the 1986 recommended values from</span>
<span class="sd">CODATA. Other conversion factors (e.g. for British units) come from various </span>
<span class="sd">sources. I can&#39;t guarantee for the correctness of all entries in the unit table,</span>
<span class="sd">so use this at your own risk.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">re</span><span class="o">,</span> <span class="nn">string</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="nb">reduce</span>

<span class="n">__metaclass__</span> <span class="o">=</span> <span class="nb">type</span>

<span class="k">def</span> <span class="nf">_getUnit</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="n">default</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">&quot;unit&quot; can only be a string (e.g., &#39;&#39;, &#39;MeV&#39;, &#39;b * eV&#39;) or None.</span>

<span class="sd">	&quot;&quot;&quot;</span>

	<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">default</span><span class="p">,</span> <span class="n">PhysicalQuantityWithUncertainty</span><span class="p">):</span>
		<span class="n">default</span> <span class="o">=</span> <span class="n">default</span><span class="o">.</span><span class="n">unit</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">default</span> <span class="o">=</span> <span class="bp">None</span>


	<span class="k">if</span> <span class="n">unit</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
		<span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">None</span>

		<span class="k">return</span> <span class="n">_findUnit</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>

	<span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s">&#39;&#39;</span><span class="p">:</span>
		<span class="k">return</span> <span class="s">&#39;&#39;</span>

	<span class="k">return</span> <span class="n">_findUnit</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>


<div class="viewcode-block" id="valueOrPQ"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.valueOrPQ">[docs]</a><span class="k">def</span> <span class="nf">valueOrPQ</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">unitFrom</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">unitTo</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">asPQU</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">This functions takes a float or a PhysicalQuantityWithUncertainty as input and </span>
<span class="sd">returns, base on asPQU, a float or PhysicalQuantityWithUncertainty. If the </span>
<span class="sd">unitTo is not None, the returned value is in units of unitTo. As </span>
<span class="sd">PhysicalQuantityWithUncertainty does not currently support a dimensionless </span>
<span class="sd">quantity, if the input is a float and unitFrom is not specified then a float is </span>
<span class="sd">returned, independent of asPQU.f value is a PhysicalQuantityWithUncertainty and </span>
<span class="sd">unitFrom is not None, they must be the same unit.</span>

<span class="sd">Options for input are:</span>
<span class="sd">    +-----+--------+------+-----------------+-----------------------------------+</span>
<span class="sd">    |     |        |      |  from _getUnit  |       returned value asPQU        |</span>
<span class="sd">    +-----+--------+------+--------+--------+--------+--------------------------+</span>
<span class="sd">    |value|unitFrom|unitTo|unitFrom|unitTo  |False   |True                      |</span>
<span class="sd">    +-----+--------+------+--------+--------+--------+--------------------------+</span>
<span class="sd">    |float|None    |None  |None    |None    |float   |float                     |</span>
<span class="sd">    |     |        |      |        |        |        |(until PQU supports       |</span>
<span class="sd">    |     |        |      |        |        |        |dimensionless unit)       |</span>
<span class="sd">    +-----+--------+------+--------+--------+--------+--------------------------+</span>
<span class="sd">    |float|string  |None  |&#39;&#39; or PU|None    |float in|PQ in unitFrom            |</span>
<span class="sd">    |     |        |      |        |        |unitFrom|                          |</span>
<span class="sd">    +-----+--------+------+--------+--------+--------+--------------------------+</span>
<span class="sd">    |float|string  |string|&#39;&#39; or PU|&#39;&#39; or PU|float in|PQ in unitTo              |</span>
<span class="sd">    |     |        |      |        |        |unitTo  |                          |</span>
<span class="sd">    +-----+--------+------+--------+--------+--------+--------------------------+</span>
<span class="sd">    |PQU  |None    |None  |PU      |None    |float   |PQ                        |</span>
<span class="sd">    +-----+--------+------+--------+--------+--------+--------------------------+</span>
<span class="sd">    |PQU  |string  |None  |&#39;&#39; or PU|None    |float in|PQU (need to check that PQ|</span>
<span class="sd">    |     |        |      |        |        |unitFrom|and unitFrom are the same)|</span>
<span class="sd">    +-----+--------+------+--------+--------+--------+--------------------------+</span>
<span class="sd">    |PQU  |string  |string|&#39;&#39; or PU|&#39;&#39; or PU|float in|PQU in unitTo (ditto)     | </span>
<span class="sd">    |     |        |      |        |        |unitTo  |                          |</span>
<span class="sd">    +-----+--------+------+--------+--------+--------+--------------------------+</span>
<span class="sd">    |PQU  |None    |string|PU      |&#39;&#39; or PU|float in|PQU in unitTo             |</span>
<span class="sd">    |     |        |      |        |        |unitTo  |                          |</span>
<span class="sd">    +-----+--------+------+--------+--------+--------+--------------------------+</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">unitFrom</span> <span class="o">=</span> <span class="n">_getUnit</span><span class="p">(</span><span class="n">unitFrom</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

	<span class="k">if</span> <span class="n">unitFrom</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
		<span class="k">if</span> <span class="n">unitTo</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
			<span class="k">return</span> <span class="n">value</span>

		<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;Incompatible units: unitFrom is None while unitTo is &quot;</span><span class="si">%s</span><span class="s">&quot;&#39;</span> <span class="o">%</span> <span class="n">unitTo</span><span class="p">)</span>

	<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">PhysicalQuantityWithUncertainty</span><span class="p">):</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">unitFrom</span><span class="p">,</span> <span class="n">PhysicalUnit</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">unitFrom</span> <span class="o">!=</span> <span class="n">value</span><span class="o">.</span><span class="n">unit</span><span class="p">:</span>
				<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;Incompatible units: unitFrom is &quot;</span><span class="si">%s</span><span class="s">&quot; and value has &quot;</span><span class="si">%s</span><span class="s">&quot;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">unitFrom</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;Incompatible units: value has = &quot;</span><span class="si">%s</span><span class="s">&quot; and unitFrom is &quot;&quot;&#39;</span> <span class="o">%</span> <span class="n">value</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span>

		<span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">value</span>

	<span class="c"># At this point value is a float and unitFrom is either &#39;&#39; or PU.</span>
	<span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">unitFrom</span><span class="p">,</span> <span class="n">PhysicalUnit</span><span class="p">)):</span> <span class="c"># Is &#39;&#39; (e.g, dimensionless)</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">unitTo</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">unitTo</span> <span class="o">==</span> <span class="s">&#39;&#39;</span><span class="p">):</span>
			<span class="k">return</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

		<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;Incompatible units: unitFrom is &quot;</span><span class="si">%s</span><span class="s">&quot; and unitTo is &quot;</span><span class="si">%s</span><span class="s">&quot;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">unitFrom</span><span class="p">,</span> <span class="n">unitTo</span><span class="p">))</span>

	<span class="c"># At this point unitFrom has dimensions (i.e., is not &#39;&#39;).</span>
	<span class="k">if</span> <span class="n">unitTo</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
		<span class="n">unitTo</span> <span class="o">=</span> <span class="n">unitFrom</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="k">if</span> <span class="n">unitTo</span> <span class="o">==</span> <span class="s">&#39;&#39;</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;Incompatible units: unitFrom is &quot;</span><span class="si">%s</span><span class="s">&quot; and unitTo is &quot;&quot;&#39;</span> <span class="o">%</span> <span class="n">unitFrom</span><span class="p">)</span>

		<span class="n">unitTo</span> <span class="o">=</span> <span class="n">_findUnit</span><span class="p">(</span><span class="n">unitTo</span><span class="p">)</span>

		<span class="k">if</span> <span class="n">unitFrom</span> <span class="o">!=</span> <span class="n">unitTo</span><span class="p">:</span>
			<span class="n">value</span> <span class="o">=</span> <span class="n">PhysicalQuantityWithUncertainty</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">unitFrom</span><span class="p">)</span><span class="o">.</span><span class="n">getValueAs</span><span class="p">(</span><span class="n">unitTo</span><span class="p">)</span>

	<span class="k">if</span> <span class="n">asPQU</span><span class="p">:</span>
		<span class="k">return</span> <span class="n">PhysicalQuantityWithUncertainty</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">unitTo</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">value</span>
</div>
<div class="viewcode-block" id="toShortestString"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.toShortestString">[docs]</a><span class="k">def</span> <span class="nf">toShortestString</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">precision</span> <span class="o">=</span> <span class="mi">15</span><span class="p">):</span>

	<span class="n">e</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;</span><span class="si">%%</span><span class="s">.</span><span class="si">%d</span><span class="s">e&#39;</span> <span class="o">%</span> <span class="n">precision</span><span class="p">)</span> <span class="o">%</span> <span class="n">value</span>
	<span class="n">e1</span> <span class="o">=</span> <span class="s">&#39;</span><span class="si">%e</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">value</span>

	<span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="n">e1</span><span class="p">):</span>
		<span class="n">e</span> <span class="o">=</span> <span class="n">e1</span>

	<span class="n">s</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">)</span>
	<span class="n">m</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s">&#39;0&#39;</span><span class="p">)</span>

	<span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;.&#39;</span><span class="p">:</span>
		<span class="n">m</span> <span class="o">=</span> <span class="n">m</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

	<span class="n">p</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>
	<span class="n">e</span> <span class="o">=</span> <span class="n">m</span> <span class="o">+</span> <span class="s">&#39;e&#39;</span> <span class="o">+</span> <span class="s">&quot;</span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">p</span>
	<span class="n">p</span> <span class="o">=</span> <span class="n">precision</span> <span class="o">-</span> <span class="n">p</span> <span class="o">-</span> <span class="mi">1</span>

	<span class="k">if</span> <span class="n">p</span> <span class="o">&gt;</span> <span class="mi">25</span><span class="p">:</span>
		<span class="k">return</span> <span class="n">e</span>

	<span class="n">p</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
	<span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;</span><span class="si">%%</span><span class="s">.</span><span class="si">%d</span><span class="s">f&#39;</span> <span class="o">%</span> <span class="n">p</span><span class="p">)</span> <span class="o">%</span> <span class="n">value</span>

	<span class="k">if</span> <span class="s">&#39;e&#39;</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
	<span class="c"># For very large numbers, the &#39;%.?f&#39; format returns &#39;e&#39; format (e.g., .1234e300 --&gt; &quot;1e+299&quot;)</span>
		<span class="k">return</span> <span class="n">e</span>

	<span class="k">if</span> <span class="s">&#39;.&#39;</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
		<span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s">&#39;0&#39;</span><span class="p">)</span>

	<span class="k">if</span> <span class="n">f</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;.&#39;</span><span class="p">:</span>
		<span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

	<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">f</span>

	<span class="k">return</span> <span class="n">e</span>


<span class="c"># Class definitions</span></div>
<div class="viewcode-block" id="PatternRecognition"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PatternRecognition">[docs]</a><span class="k">class</span> <span class="nc">PatternRecognition</span><span class="p">:</span>
	<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">.. rubric:: Regular Expression Matching</span>

<span class="sd">	&quot;&quot;&quot;</span>

	<span class="n">sign</span> <span class="o">=</span> <span class="s">&#39;[+-]?&#39;</span> <span class="c"># optional sign</span>
	<span class="n">num</span> <span class="o">=</span> <span class="s">&#39;(</span><span class="si">%s</span><span class="s">\d*)(\.(\d*))?&#39;</span> <span class="o">%</span> <span class="n">sign</span> <span class="c"># value, can be decimal or integer</span>
	<span class="n">exp</span> <span class="o">=</span> <span class="s">&#39;(([eE])(</span><span class="si">%s</span><span class="s">\d+))?&#39;</span> <span class="o">%</span> <span class="n">sign</span> <span class="c"># optional exponent</span>
	<span class="n">value</span> <span class="o">=</span> <span class="s">&#39;^(</span><span class="si">%s%s</span><span class="s">)$&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">exp</span><span class="p">)</span>
	<span class="n">valueWithPercent</span> <span class="o">=</span> <span class="s">&#39;^((</span><span class="si">%s%s</span><span class="s">)(</span><span class="si">%s</span><span class="s">))$&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="s">&#39;\%&#39;</span><span class="p">)</span>
	<span class="n">valueWithUnit</span> <span class="o">=</span> <span class="s">&#39;^(</span><span class="si">%s%s</span><span class="s">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">exp</span><span class="p">)</span>

	<span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PatternRecognition.number"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PatternRecognition.number">[docs]</a>	<span class="k">def</span> <span class="nf">number</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">:param self: a number</span>
<span class="sd">:type self: `str`</span>
<span class="sd">:returns: components of the number</span>
<span class="sd">:rtype: `tuple` of `str`</span>
<span class="sd">:raises TypeError: if the number string is incompatible </span>

<span class="sd">		&quot;&quot;&quot;</span>

		<span class="k">try</span><span class="p">:</span>
			<span class="n">s0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)</span>
			<span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">PatternRecognition</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">s0</span><span class="p">)</span>

			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">None</span><span class="p">)):</span>
				<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n\t</span><span class="s">incompatible string</span><span class="se">\n\t</span><span class="s">(unable to parse value in </span><span class="si">%s</span><span class="s">)</span><span class="se">\n\n</span><span class="s">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">return</span> <span class="n">m</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n\t</span><span class="s">incompatible string</span><span class="se">\n\t</span><span class="s">(unable to parse number in </span><span class="si">%s</span><span class="s">)</span><span class="se">\n\n</span><span class="s">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="p">)</span>
</div>
	<span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PatternRecognition.isNumber"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PatternRecognition.isNumber">[docs]</a>	<span class="k">def</span> <span class="nf">isNumber</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">:param self: a number</span>
<span class="sd">:type self: `str`</span>
<span class="sd">:returns: `True` if self is a number</span>
<span class="sd">:rtype: `bool`</span>

<span class="sd">		&quot;&quot;&quot;</span>

		<span class="k">try</span><span class="p">:</span>
			<span class="n">m</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">number</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
			<span class="k">return</span> <span class="bp">True</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">False</span>
</div>
	<span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PatternRecognition.numberWithPercent"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PatternRecognition.numberWithPercent">[docs]</a>	<span class="k">def</span> <span class="nf">numberWithPercent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">:param self: a number with percent</span>
<span class="sd">:type self: `str`</span>
<span class="sd">:returns: components of the number with percent</span>
<span class="sd">:rtype: `tuple` of `str`</span>
<span class="sd">:raise TypeError: if the number with percent string is incompatible </span>

<span class="sd">		&quot;&quot;&quot;</span>

		<span class="k">try</span><span class="p">:</span>
			<span class="n">s0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)</span>
			<span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">PatternRecognition</span><span class="o">.</span><span class="n">valueWithPercent</span><span class="p">)</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">s0</span><span class="p">)</span>

			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">None</span><span class="p">)):</span>
				<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n\n\t</span><span class="s">incompatible string</span><span class="se">\n\t</span><span class="s">(unable to parse valueWithPercent in &#39;</span><span class="si">%s</span><span class="s">&#39;)</span><span class="se">\n\n</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">return</span> <span class="n">m</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n\n\t</span><span class="s">incompatible string</span><span class="se">\n\t</span><span class="s">(unable to parse numberWithPercent in &#39;</span><span class="si">%s</span><span class="s">&#39;)</span><span class="se">\n\n</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="p">)</span>
</div>
	<span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PatternRecognition.isNumberWithPercent"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PatternRecognition.isNumberWithPercent">[docs]</a>	<span class="k">def</span> <span class="nf">isNumberWithPercent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">:param self: a number with percent</span>
<span class="sd">:type self: `str`</span>
<span class="sd">:returns: `True` if self is a number with percent</span>
<span class="sd">:rtype: `bool`</span>

<span class="sd">		&quot;&quot;&quot;</span>

		<span class="k">try</span><span class="p">:</span>
			<span class="n">m</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">numberWithPercent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
			<span class="k">return</span> <span class="bp">True</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">False</span>
</div>
	<span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PatternRecognition.numberWithUnit"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PatternRecognition.numberWithUnit">[docs]</a>	<span class="k">def</span> <span class="nf">numberWithUnit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">:param self: a number with units</span>
<span class="sd">:type self: `str`</span>
<span class="sd">:returns: components of the number with units</span>
<span class="sd">:rtype: `tuple` of `str` and `PhysicalUnit`</span>
<span class="sd">:raises TypeError: if the self or number is incompatible </span>

<span class="sd">		&quot;&quot;&quot;</span>

		<span class="k">try</span><span class="p">:</span>
			<span class="n">s0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)</span>
			<span class="n">s00</span> <span class="o">=</span> <span class="n">s0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)</span>
			<span class="n">s01</span> <span class="o">=</span> <span class="n">s0</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)</span>
			<span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">PatternRecognition</span><span class="o">.</span><span class="n">valueWithUnit</span><span class="p">)</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">))</span>
			<span class="n">v</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">PatternRecognition</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">s00</span><span class="p">)</span>
			<span class="n">u</span> <span class="o">=</span> <span class="n">_findUnit</span><span class="p">(</span><span class="n">s01</span><span class="p">)</span>

			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">None</span><span class="p">)):</span>
				<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n\t</span><span class="s">incompatible string</span><span class="se">\n\t</span><span class="s">(unable to parse valueWithUnit in </span><span class="si">%s</span><span class="s">)</span><span class="se">\n\n</span><span class="s">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">None</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">None</span><span class="p">)):</span>
					<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n\t</span><span class="s">incompatible string</span><span class="se">\n\t</span><span class="s">(unable to parse value or unit in </span><span class="si">%s</span><span class="s">)</span><span class="se">\n\n</span><span class="s">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="k">return</span> <span class="n">m</span><span class="o">.</span><span class="n">groups</span><span class="p">(),</span> <span class="n">u</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n\t</span><span class="s">incompatible string</span><span class="se">\n\t</span><span class="s">(unable to parse numberWithUnit in </span><span class="si">%s</span><span class="s">)</span><span class="se">\n\n</span><span class="s">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="p">)</span>
</div>
	<span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PatternRecognition.isNumberWithUnit"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PatternRecognition.isNumberWithUnit">[docs]</a>	<span class="k">def</span> <span class="nf">isNumberWithUnit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">:param self: a number with units</span>
<span class="sd">:type self: `str`</span>
<span class="sd">:returns: `True` if self is a number with units</span>
<span class="sd">:rtype: `bool`</span>

<span class="sd">		&quot;&quot;&quot;</span>

		<span class="k">try</span><span class="p">:</span>
			<span class="n">m</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">numberWithUnit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
			<span class="k">return</span> <span class="bp">True</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">False</span>
</div>
	<span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PatternRecognition.numberWithUncertainty"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PatternRecognition.numberWithUncertainty">[docs]</a>	<span class="k">def</span> <span class="nf">numberWithUncertainty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">:param self: a number with uncertainty and/or units</span>
<span class="sd">:type self: `str`</span>
<span class="sd">:rtype: `dict`</span>
<span class="sd">:raises TypeError: if the number with uncertainty and/or units string is incompatible </span>

<span class="sd">		&quot;&quot;&quot;</span>

		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
			<span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)</span>
			<span class="n">x</span> <span class="o">=</span> <span class="p">{}</span>

			<span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">__contains__</span><span class="p">(</span><span class="s">&#39;+/-&#39;</span><span class="p">):</span>
				<span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&#39;+/-&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
					<span class="n">s0</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;+/-&#39;</span><span class="p">)</span>
					<span class="n">m0</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">number</span><span class="p">(</span><span class="n">s0</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
					<span class="n">x</span><span class="p">[</span><span class="s">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
					<span class="n">m01</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">numberWithUnit</span><span class="p">(</span><span class="n">s0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;%&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">))</span>
					<span class="n">x</span><span class="p">[</span><span class="s">&#39;uncertainty&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m01</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
					<span class="n">x</span><span class="p">[</span><span class="s">&#39;unit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m01</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

					<span class="k">if</span> <span class="n">s0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">__contains__</span><span class="p">(</span><span class="s">&#39;%&#39;</span><span class="p">):</span>
						<span class="n">x</span><span class="p">[</span><span class="s">&#39;uncertaintyType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;%&#39;</span>
						<span class="n">x</span><span class="p">[</span><span class="s">&#39;absoluteUncertainty&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">toShortestString</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s">&#39;uncertainty&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mi">100</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s">&#39;value&#39;</span><span class="p">]))</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="n">x</span><span class="p">[</span><span class="s">&#39;uncertaintyType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;absolute&#39;</span>
						<span class="n">x</span><span class="p">[</span><span class="s">&#39;absoluteUncertainty&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="s">&#39;uncertainty&#39;</span><span class="p">]</span>

					<span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s">&#39;absoluteUncertainty&#39;</span><span class="p">])</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
						<span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s">&#39;value&#39;</span><span class="p">])</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
							<span class="n">y</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">findLeastPrecise</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s">&#39;value&#39;</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="s">&#39;absoluteUncertainty&#39;</span><span class="p">])</span>
							<span class="k">print</span> <span class="n">y</span>
							<span class="n">x</span><span class="p">[</span><span class="s">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="s">&#39;value&#39;</span><span class="p">]</span>

							<span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="s">&#39;uncertainty&#39;</span><span class="p">])</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
								<span class="n">x</span><span class="p">[</span><span class="s">&#39;absoluteUncertainty&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="s">&#39;uncertainty&#39;</span><span class="p">]</span>
								<span class="n">x</span><span class="p">[</span><span class="s">&#39;significantDigits&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">findSignificantDigits</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s">&#39;value&#39;</span><span class="p">])</span>

								<span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="s">&#39;uncertaintyType&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;absolute&#39;</span><span class="p">:</span>
									<span class="n">x</span><span class="p">[</span><span class="s">&#39;uncertainty&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="s">&#39;absoluteUncertainty&#39;</span><span class="p">]</span>
							<span class="k">else</span><span class="p">:</span>
								<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n\t</span><span class="s">incompatible uncertainty value</span><span class="se">\n\t</span><span class="s">(absolute uncertainty cannot be equal to zero</span><span class="se">\n\t</span><span class="s">when truncated to the same precision as the value)</span><span class="se">\n\n</span><span class="s">&#39;</span><span class="p">)</span>
						<span class="k">else</span><span class="p">:</span>
							<span class="n">sD</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">findSignificantDigits</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s">&#39;absoluteUncertainty&#39;</span><span class="p">])</span>

							<span class="k">if</span> <span class="n">sD</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
								<span class="n">x</span><span class="p">[</span><span class="s">&#39;significantDigits&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
							<span class="k">else</span><span class="p">:</span>
								<span class="n">x</span><span class="p">[</span><span class="s">&#39;significantDigits&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sD</span>

							<span class="n">x</span><span class="p">[</span><span class="s">&#39;absoluteUncertainty&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">toSignificantDigits</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s">&#39;absoluteUncertainty&#39;</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="s">&#39;significantDigits&#39;</span><span class="p">])</span>
							<span class="n">x</span><span class="p">[</span><span class="s">&#39;uncertainty&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="s">&#39;absoluteUncertainty&#39;</span><span class="p">]</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n\t</span><span class="s">incompatible uncertainty value</span><span class="se">\n\t</span><span class="s">(absolute uncertainty cannot be equal to zero)&#39;</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n\n\t</span><span class="s">incompatible string</span><span class="se">\n\t</span><span class="s">(too many &#39;+/-&#39; in </span><span class="si">%s</span><span class="se">\n\n</span><span class="s">)&quot;</span> <span class="o">%</span><span class="n">s</span><span class="p">)</span>

			<span class="k">elif</span> <span class="n">s</span><span class="o">.</span><span class="n">__contains__</span><span class="p">(</span><span class="s">&#39;(&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">s</span><span class="o">.</span><span class="n">__contains__</span><span class="p">(</span><span class="s">&#39;)&#39;</span><span class="p">):</span>
				<span class="n">v</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;(&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)</span>
				<span class="n">u</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;(&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;)&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)</span>
				<span class="n">e</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;(&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;)&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
				<span class="n">ve</span> <span class="o">=</span> <span class="n">v</span> <span class="o">+</span> <span class="n">e</span>
				<span class="n">m0</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">numberWithUnit</span><span class="p">(</span><span class="n">ve</span><span class="p">)</span>
				<span class="n">x</span><span class="p">[</span><span class="s">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m0</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
				<span class="n">x</span><span class="p">[</span><span class="s">&#39;unit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
				<span class="n">x</span><span class="p">[</span><span class="s">&#39;uncertaintyType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;absolute&#39;</span>
				<span class="n">ue</span> <span class="o">=</span> <span class="n">u</span> <span class="o">+</span> <span class="n">e</span>
				<span class="n">pv</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">findPrecision</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
				<span class="n">m1</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">numberWithUnit</span><span class="p">(</span><span class="n">ue</span><span class="p">)</span>

 				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">m1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">5</span><span class="p">],</span> <span class="nb">type</span><span class="p">(</span><span class="bp">None</span><span class="p">)):</span>
					<span class="n">x</span><span class="p">[</span><span class="s">&#39;uncertainty&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;e&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pv</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">pe</span> <span class="o">=</span> <span class="n">m1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">m1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">5</span><span class="p">])</span>
					<span class="n">ps</span> <span class="o">=</span> <span class="n">m1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)</span>
					<span class="n">x</span><span class="p">[</span><span class="s">&#39;uncertainty&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="n">pe</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;e&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pv</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">m1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">6</span><span class="p">]))</span>

				<span class="n">x</span><span class="p">[</span><span class="s">&#39;absoluteUncertainty&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="s">&#39;uncertainty&#39;</span><span class="p">]</span>

				<span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s">&#39;absoluteUncertainty&#39;</span><span class="p">])</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
					<span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s">&#39;value&#39;</span><span class="p">])</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
						<span class="n">y</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">findLeastPrecise</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s">&#39;value&#39;</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="s">&#39;absoluteUncertainty&#39;</span><span class="p">])</span>
						<span class="n">x</span><span class="p">[</span><span class="s">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="s">&#39;value&#39;</span><span class="p">]</span>

						<span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="s">&#39;uncertainty&#39;</span><span class="p">])</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
							<span class="n">x</span><span class="p">[</span><span class="s">&#39;uncertainty&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="s">&#39;uncertainty&#39;</span><span class="p">]</span>
							<span class="n">x</span><span class="p">[</span><span class="s">&#39;absoluteUncertainty&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="s">&#39;uncertainty&#39;</span><span class="p">]</span>
							<span class="n">x</span><span class="p">[</span><span class="s">&#39;significantDigits&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">findSignificantDigits</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s">&#39;value&#39;</span><span class="p">])</span>
						<span class="k">else</span><span class="p">:</span>
							<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n\t</span><span class="s">incompatible uncertainty value</span><span class="se">\n\t</span><span class="s">(absolute uncertainty cannot be equal to zero</span><span class="se">\n\t</span><span class="s">when truncated to the same precision as the value)</span><span class="se">\n\n</span><span class="s">&#39;</span><span class="p">)</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="n">sD</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">findSignificantDigits</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s">&#39;absoluteUncertainty&#39;</span><span class="p">])</span>

						<span class="k">if</span> <span class="n">sD</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
							<span class="n">x</span><span class="p">[</span><span class="s">&#39;significantDigits&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
						<span class="k">else</span><span class="p">:</span>
							<span class="n">x</span><span class="p">[</span><span class="s">&#39;significantDigits&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sD</span>

						<span class="n">x</span><span class="p">[</span><span class="s">&#39;absoluteUncertainty&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">toSignificantDigits</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s">&#39;absoluteUncertainty&#39;</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="s">&#39;significantDigits&#39;</span><span class="p">])</span>
						<span class="n">x</span><span class="p">[</span><span class="s">&#39;uncertainty&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="s">&#39;absoluteUncertainty&#39;</span><span class="p">]</span>

				<span class="k">else</span><span class="p">:</span>
					<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n\t</span><span class="s">incompatible uncertainty value</span><span class="se">\n\t</span><span class="s">(absolute uncertainty cannot be equal to zero)&#39;</span><span class="p">)</span>

			<span class="k">else</span><span class="p">:</span>
				<span class="n">m</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">numberWithUnit</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
				<span class="n">x</span><span class="p">[</span><span class="s">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
				<span class="n">x</span><span class="p">[</span><span class="s">&#39;unit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

		<span class="k">else</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n\t</span><span class="s">incompatible string</span><span class="se">\n\t</span><span class="s">(argument is not string type)</span><span class="se">\n\n</span><span class="s">&#39;</span> <span class="o">%</span><span class="n">s</span><span class="p">)</span>

		<span class="k">return</span> <span class="n">x</span>
</div>
	<span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PatternRecognition.findLeastPrecise"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PatternRecognition.findLeastPrecise">[docs]</a>	<span class="k">def</span> <span class="nf">findLeastPrecise</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">uncertainty</span><span class="p">,</span> <span class="n">toUncertaintySignificantDigits</span> <span class="o">=</span> <span class="mi">2</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">The uncertainty is reduced to the specified significant digits (default is 2).</span>
<span class="sd">Then the precision of the value and its uncertainty are compared and both are </span>
<span class="sd">reduced to the least precision amongst them.</span>

<span class="sd">:param value: a number</span>
<span class="sd">:type value: `str`</span>
<span class="sd">:param uncertainty: a number</span>
<span class="sd">:type uncertainty: `str`</span>
<span class="sd">:param toUncertaintySignificantDigits: a number</span>
<span class="sd">:type toUncertaintySignificantDigits: `int`</span>
<span class="sd">:returns: new value and its uncertainty</span>
<span class="sd">:rtype: `dict`</span>

<span class="sd">		&quot;&quot;&quot;</span>

		<span class="n">uncertaintySD</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">findSignificantDigits</span><span class="p">(</span><span class="n">uncertainty</span><span class="p">)</span>

		<span class="k">if</span> <span class="n">uncertaintySD</span> <span class="o">&gt;=</span> <span class="n">toUncertaintySignificantDigits</span><span class="p">:</span>
			<span class="n">uncertainty0</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">toSignificantDigits</span><span class="p">(</span><span class="n">uncertainty</span><span class="p">,</span> <span class="n">toUncertaintySignificantDigits</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">uncertainty0</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">toSignificantDigits</span><span class="p">(</span><span class="n">uncertainty</span><span class="p">,</span> <span class="n">uncertaintySD</span><span class="p">)</span>

		<span class="n">uncertaintySD</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">findSignificantDigits</span><span class="p">(</span><span class="n">uncertainty0</span><span class="p">)</span>
		<span class="n">valueP</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">findPrecision</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
		<span class="n">uncertaintyP</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">findPrecision</span><span class="p">(</span><span class="n">uncertainty0</span><span class="p">)</span>
		<span class="n">leastPrecise</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">valueP</span><span class="p">,</span> <span class="n">uncertaintyP</span><span class="p">)</span>
		<span class="n">x</span> <span class="o">=</span> <span class="p">{}</span>

		<span class="k">if</span> <span class="n">leastPrecise</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
			<span class="n">x</span><span class="p">[</span><span class="s">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">toPrecision</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">leastPrecise</span><span class="p">)</span>
			<span class="n">x</span><span class="p">[</span><span class="s">&#39;uncertainty&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">toPrecision</span><span class="p">(</span><span class="n">uncertainty</span><span class="p">,</span> <span class="n">leastPrecise</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">x</span><span class="p">[</span><span class="s">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">toPrecision</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
			<span class="n">x</span><span class="p">[</span><span class="s">&#39;uncertainty&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">toPrecision</span><span class="p">(</span><span class="n">uncertainty0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

		<span class="k">return</span> <span class="n">x</span>
</div>
	<span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PatternRecognition.findSignificantDigitsWithUncertainty"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PatternRecognition.findSignificantDigitsWithUncertainty">[docs]</a>	<span class="k">def</span> <span class="nf">findSignificantDigitsWithUncertainty</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">uncertainty</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">Using findLeastPrecise method with 2 significant digits set to the uncertainty,</span>
<span class="sd">it finds significant digits of the value.</span>

<span class="sd">:param value: a number</span>
<span class="sd">:type value: `str`</span>
<span class="sd">:param uncertainty: a number</span>
<span class="sd">:type uncertainty: `str`</span>
<span class="sd">:returns: significant digit of a number</span>
<span class="sd">:rtype: `int`</span>

<span class="sd">		&quot;&quot;&quot;</span>

		<span class="k">return</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">findSignificantDigits</span><span class="p">(</span><span class="n">PatternRecognition</span><span class="o">.</span><span class="n">findLeastPrecise</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">uncertainty</span><span class="p">)[</span><span class="s">&#39;value&#39;</span><span class="p">])</span>
</div>
	<span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PatternRecognition.findPrecision"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PatternRecognition.findPrecision">[docs]</a>	<span class="k">def</span> <span class="nf">findPrecision</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">Finds precision of a number, the digit&#39;s place following a decimal point.</span>

<span class="sd">:param self: a number</span>
<span class="sd">:type self: `str`</span>
<span class="sd">:raises TypeError: if the number string is incompatible</span>
<span class="sd">:returns: a negative integer</span>
<span class="sd">:rtype: `int`</span>

<span class="sd">		&quot;&quot;&quot;</span>

		<span class="k">try</span><span class="p">:</span>
			<span class="n">m</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">number</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

			<span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
				<span class="n">rightOfDecimal</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">rightOfDecimal</span> <span class="o">=</span> <span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

			<span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
				<span class="n">exponent</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">exponent</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>

			<span class="n">precision</span> <span class="o">=</span> <span class="n">rightOfDecimal</span> <span class="o">+</span> <span class="n">exponent</span>

			<span class="k">if</span> <span class="n">precision</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
				<span class="n">precision</span> <span class="o">=</span> <span class="mi">0</span>

			<span class="k">return</span> <span class="n">precision</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n\t</span><span class="s">incompatible string</span><span class="se">\n\t</span><span class="s">(unable to find precision in </span><span class="si">%s</span><span class="s">)</span><span class="se">\n\n</span><span class="s">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="p">)</span>
</div>
	<span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PatternRecognition.toPrecision"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PatternRecognition.toPrecision">[docs]</a>	<span class="k">def</span> <span class="nf">toPrecision</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">desiredPrecision</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">Transform a number to desired precision. The desired precision must be less </span>
<span class="sd">than the precision of the number itself.</span>

<span class="sd">:param self: a number</span>
<span class="sd">:type self: `str`</span>
<span class="sd">:param desiredPrecision: a number</span>
<span class="sd">:type desiredPrecision: `int`</span>
<span class="sd">:returns: a number with desired precision</span>
<span class="sd">:rtype: `str`</span>
<span class="sd">:raises TypeError: if the number string is incompatible and/or if the precision of the number &gt; desired precision &gt; 0</span>

<span class="sd">		&quot;&quot;&quot;</span>

		<span class="n">m</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">number</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
		<span class="n">precision</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">findPrecision</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

		<span class="k">if</span> <span class="n">desiredPrecision</span> <span class="o">&gt;=</span> <span class="n">precision</span> <span class="ow">and</span> <span class="n">desiredPrecision</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
			<span class="n">newSelf</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="s">&quot;&#39;</span><span class="si">%s</span><span class="s">&#39;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s">&#39;%.&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">desiredPrecision</span><span class="p">))</span> <span class="o">+</span> <span class="s">&#39;f&#39;</span><span class="p">))</span> <span class="o">%</span> <span class="nb">float</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
			<span class="k">if</span> <span class="n">desiredPrecision</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
				<span class="n">newSelf</span> <span class="o">+=</span> <span class="s">&#39;.&#39;</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n\t</span><span class="s">incompatible desiredPrecision</span><span class="se">\n\t</span><span class="s">(precision of the value, </span><span class="si">%i</span><span class="s">, must be &lt;= desiredPrecision, </span><span class="si">%i</span><span class="s">, which must be &lt;= 0)</span><span class="se">\n\n</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">precision</span><span class="p">,</span> <span class="n">desiredPrecision</span><span class="p">))</span>

		<span class="k">return</span> <span class="n">newSelf</span>
</div>
	<span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PatternRecognition.findSignificantDigits"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PatternRecognition.findSignificantDigits">[docs]</a>	<span class="k">def</span> <span class="nf">findSignificantDigits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">:param self: a number</span>
<span class="sd">:type self: `str`</span>
<span class="sd">:returns: significant digits in a number</span>
<span class="sd">:rtype: `int`</span>
<span class="sd">:raises TypeError: if the number string is incompatible</span>

<span class="sd">		&quot;&quot;&quot;</span>

		<span class="k">try</span><span class="p">:</span>
			<span class="n">m</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">number</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
			<span class="n">l</span> <span class="o">=</span> <span class="mi">0</span>

			<span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;&#39;</span> <span class="ow">or</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;0&#39;</span> <span class="ow">or</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;+&#39;</span> <span class="ow">or</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;-&#39;</span><span class="p">:</span>
				<span class="n">l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s">&#39;0&#39;</span><span class="p">))</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">m1</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s">&#39;+&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s">&#39;-&#39;</span><span class="p">)</span>

				<span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
					<span class="n">l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">m1</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&#39;0&#39;</span><span class="p">))</span>
				<span class="k">elif</span> <span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;.&#39;</span><span class="p">:</span>
					<span class="n">l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">m1</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s">&#39;0&#39;</span><span class="p">))</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">m1</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s">&#39;0&#39;</span><span class="p">))</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

			<span class="k">return</span> <span class="n">l</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n\t</span><span class="s">incompatible string</span><span class="se">\n\n</span><span class="s">&#39;</span><span class="p">)</span>
</div>
	<span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PatternRecognition.toSignificantDigits"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PatternRecognition.toSignificantDigits">[docs]</a>	<span class="k">def</span> <span class="nf">toSignificantDigits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">toSignificantDigits</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">:param self: a number</span>
<span class="sd">:type self: `str`</span>
<span class="sd">:param toSignificantDigits: a number</span>
<span class="sd">:type toSignificantDigits: `int`</span>
<span class="sd">:returns: a number with desired significant digits</span>
<span class="sd">:rtype: `str`</span>
<span class="sd">:raises TypeError: if the number string is incompatible</span>

<span class="sd">		&quot;&quot;&quot;</span>

		<span class="k">try</span><span class="p">:</span>
			<span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
				<span class="n">m</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">number</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
				<span class="n">es</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="s">&quot;&#39;</span><span class="si">%s</span><span class="s">&#39;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s">&#39;%+.&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">toSignificantDigits</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;e&#39;</span><span class="p">))</span> <span class="o">%</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
				<span class="n">m</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">number</span><span class="p">(</span><span class="n">es</span><span class="p">)</span>

				<span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
					<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__contains__</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">):</span>
						<span class="n">rs</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;.&#39;</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="n">rs</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">rs</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

				<span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
					<span class="k">pass</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">rs</span> <span class="o">+=</span> <span class="n">m</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">6</span><span class="p">]))</span>

				<span class="k">return</span> <span class="n">rs</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;+&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">es</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="s">&quot;&#39;</span><span class="si">%s</span><span class="s">&#39;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s">&#39;%.&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">toSignificantDigits</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;f&#39;</span><span class="p">))</span> <span class="o">%</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
				<span class="k">return</span> <span class="n">es</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n\t</span><span class="s">incompatible string</span><span class="se">\n\n</span><span class="s">&#39;</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="PhysicalQuantityWithUncertainty"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PhysicalQuantityWithUncertainty">[docs]</a><span class="k">class</span> <span class="nc">PhysicalQuantityWithUncertainty</span><span class="p">:</span>
	<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">.. rubric:: PHYSICAL QUANTITY WITH UNCERTAINTY</span>

<span class="sd">PhysicalQuantityWithUncertainty instances allow addition, subtraction, </span>
<span class="sd">multiplication, and division with each other as well as multiplication, </span>
<span class="sd">division, and exponentiation with numbers. Addition and subtraction check that </span>
<span class="sd">the units of the two operands are compatible and return the result in the units </span>
<span class="sd">of the first operand. A limited set of mathematical functions (from module </span>
<span class="sd">Numeric) is applicable as well:</span>

<span class="sd">- sqrt: equivalent to exponentiation with 0.5.</span>
<span class="sd">- sin, cos, tan: applicable only to objects whose unit is compatible with </span>
<span class="sd">  &#39;rad&#39;.</span>

<span class="sd">See the documentation of the PhysicalQuantityWithUncertainty module for a </span>
<span class="sd">list of the available units.</span>
<span class="sd">    </span>
<span class="sd">Here is an example on usage:</span>

<span class="sd">   &gt;&gt;&gt; import pqu</span>
<span class="sd">   &gt;&gt;&gt; from pqu.physicalQuantityWithUncertainty \\</span>
<span class="sd">   ... import PhysicalQuantityWithUncertainty as PQU</span>
<span class="sd">   &gt;&gt;&gt; distance1 = PQU(&#39;10 m&#39;)</span>
<span class="sd">   &gt;&gt;&gt; distance2 = PQU(&#39;10 km&#39;)</span>
<span class="sd">   &gt;&gt;&gt; total = distance1 + distance2</span>
<span class="sd">   &gt;&gt;&gt; total</span>
<span class="sd">   PhysicalQuantityWithUncertainty(10010.0, &#39;m&#39;)</span>
<span class="sd">   &gt;&gt;&gt; total.convertToUnit(&#39;km&#39;)</span>
<span class="sd">   &gt;&gt;&gt; total.getValue()</span>
<span class="sd">   10.01</span>
<span class="sd">   &gt;&gt;&gt; total.getUnitSymbol()</span>
<span class="sd">   &#39;km&#39;</span>
<span class="sd">   &gt;&gt;&gt; total = total.inBaseUnits()</span>
<span class="sd">   &gt;&gt;&gt; total</span>
<span class="sd">   PhysicalQuantityWithUncertainty(10010.0, &#39;m&#39;)</span>
<span class="sd">   &gt;&gt;&gt; t = PQU(314159., &#39;s&#39;)</span>
<span class="sd">   &gt;&gt;&gt; # convert to days, hours, minutes, and second:</span>
<span class="sd">   &gt;&gt;&gt; t2 = t.inUnitsOf(&#39;d&#39;, &#39;h&#39;, &#39;min&#39;, &#39;s&#39;)</span>
<span class="sd">   &gt;&gt;&gt; t2_print = &#39; &#39;.join([str(i) for i in t2])</span>
<span class="sd">   &gt;&gt;&gt; t2_print</span>
<span class="sd">   &#39;3.0 d 15.0 h 15.0 min 59.0 s&#39;</span>
<span class="sd">   &gt;&gt;&gt; e = PQU(&#39;2.7 Hartree * Nav&#39;)</span>
<span class="sd">   &gt;&gt;&gt; e.convertToUnit(&#39;kcal/mol&#39;)</span>
<span class="sd">   &gt;&gt;&gt; e</span>
<span class="sd">   PhysicalQuantityWithUncertainty(1694.2757596034764,&#39;kcal/mol&#39;)</span>
<span class="sd">   &gt;&gt;&gt; e = e.inBaseUnits()</span>
<span class="sd">   &gt;&gt;&gt; str(e)</span>
<span class="sd">   &#39;7088849.77818 kg * m**2/s**2/mol&#39;</span>
<span class="sd">   &gt;&gt;&gt; freeze = PQU(&#39;0 degC&#39;)</span>
<span class="sd">   &gt;&gt;&gt; freeze = freeze.inUnitsOf(&#39;degF&#39;)</span>
<span class="sd">   &gt;&gt;&gt; str(freeze)</span>
<span class="sd">   &#39;32.0 degF&#39;</span>


<span class="sd">.. rubric:: There are three constructor calling patterns:</span>

<span class="sd">1.  PhysicalQuantityWithUncertainty(value, unit, uncertainty, uncertaintyType, </span>
<span class="sd">    significantDigits)</span>

<span class="sd">    Usage:</span>
<span class="sd">    </span>
<span class="sd">        A. value can be a float, int or string if by itself or a string if with unit, </span>
<span class="sd">           uncertainty, &amp; uncertaintyType</span>
<span class="sd">        </span>
<span class="sd">        B. unit must be a string</span>
<span class="sd">        </span>
<span class="sd">    Optional:</span>
<span class="sd">    </span>
<span class="sd">        a. uncertainty can be a float, int or str if by itself</span>
<span class="sd">        </span>
<span class="sd">        b. uncertaintyType must be a string. Choices are &#39;absolute&#39;, or &#39;%&#39;</span>
<span class="sd">        </span>
<span class="sd">        c. significantDigits must be an int.</span>
<span class="sd">    </span>
<span class="sd">    Examples:</span>
<span class="sd">    </span>
<span class="sd">        &gt;&gt;&gt; from pqu.physicalQuantityWithUncertainty import </span>
<span class="sd">        ...    PhysicalQuantityWithUncertainty as PQU</span>
<span class="sd">        &gt;&gt;&gt; x = PQU(3.0, &#39;m&#39;)</span>
<span class="sd">        &gt;&gt;&gt; print x.value, x.unit</span>
<span class="sd">        3.0 m</span>
<span class="sd">        &gt;&gt;&gt; PQU(3., &#39;m&#39;, uncertainty = 0.1)</span>
<span class="sd">        &gt;&gt;&gt; print x.value, x.unit, x.uncertainty, x.uncertaintyType, </span>
<span class="sd">        ...    x.significantDigits</span>
<span class="sd">        3.0 m 0.1 absolute 2</span>
<span class="sd">        &gt;&gt;&gt; PQU(3, &#39;m&#39;, uncertainty = 1, uncertaintyType = &#39;%&#39;)</span>
<span class="sd">        &gt;&gt;&gt; print x.value, x.unit, x.uncertainty, x.uncertaintyType, </span>
<span class="sd">        ...    x.significantDigits</span>
<span class="sd">        3.0 m 1.0 % 1</span>
<span class="sd">        &gt;&gt;&gt; PQU(3, &#39;m&#39;, uncertainty = &#39;1%&#39;)</span>
<span class="sd">        &gt;&gt;&gt; print x.value, x.unit, x.uncertainty, x.uncertaintyType, </span>
<span class="sd">        ...    x.significantDigits</span>
<span class="sd">        3.0 m 1.0 % 2</span>

<span class="sd">2.  PhysicalQuantityWithUncertainty(value_with_unit, uncertainty, </span>
<span class="sd">    uncertaintyType, significantDigits), where value_with_unit is a string that </span>
<span class="sd">    contains both the value and the unit, i.e. &#39;1.5 m/s&#39;.</span>

<span class="sd">3.  PhysicalQuantityWithUncertainty(value) where value is a string that </span>
<span class="sd">    containts the value, the uncertainty, the uncertaintyType, and the unit, i.e </span>
<span class="sd">    PQU(&#39;1. +/- 0.1 m/s&#39;) for absolute or PQU(&#39;1.0 +/- 10% m/s)&#39; for percent </span>
<span class="sd">    uncertaintyType. Other formats are PQU(&#39;1.0(1) m/s&#39;), and PQU(&#39;1.0(1)e-2 m/s&#39;).</span>
<span class="sd">    All of these PQU have value 1.0 and 0.1 as uncertainty. Value can also be </span>
<span class="sd">    another PhysicalQuantityWithUncertainty instance and unit, uncertainty, and</span>
<span class="sd">    uncertaintyType can be specified to overwrite the old values.</span>

<span class="sd">See test/testPhysicalQuantityWithUncertainty.py for more examples.</span>

<span class="sd">	&quot;&quot;&quot;</span>

	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">unit</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">uncertainty</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">uncertaintyType</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">significantDigits</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>

		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>

			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">None</span><span class="p">)):</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">_findUnit</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">_findUnit</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>

		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">PhysicalQuantityWithUncertainty</span><span class="p">):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">value</span>

			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">None</span><span class="p">)):</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">unit</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">_findUnit</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>

			<span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s">&#39;uncertainty&#39;</span><span class="p">):</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">uncertainty</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">uncertaintyType</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">uncertaintyType</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">significantDigits</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">significantDigits</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">absoluteUncertainty</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">absoluteUncertainty</span>

		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
			<span class="n">s</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)</span>
			<span class="n">match</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">numberWithUncertainty</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">match</span><span class="p">[</span><span class="s">&#39;value&#39;</span><span class="p">],</span> <span class="n">match</span><span class="p">[</span><span class="s">&#39;unit&#39;</span><span class="p">]</span>

			<span class="k">if</span> <span class="n">match</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="s">&#39;uncertainty&#39;</span><span class="p">):</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span> <span class="o">=</span> <span class="n">match</span><span class="p">[</span><span class="s">&#39;uncertainty&#39;</span><span class="p">]</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">uncertaintyType</span> <span class="o">=</span> <span class="n">match</span><span class="p">[</span><span class="s">&#39;uncertaintyType&#39;</span><span class="p">]</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">absoluteUncertainty</span> <span class="o">=</span> <span class="n">match</span><span class="p">[</span><span class="s">&#39;absoluteUncertainty&#39;</span><span class="p">]</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">significantDigits</span> <span class="o">=</span> <span class="n">match</span><span class="p">[</span><span class="s">&#39;significantDigits&#39;</span><span class="p">]</span>

			<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">None</span><span class="p">)):</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">isDimensionless</span><span class="p">():</span>
					<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">!=</span> <span class="n">_findUnit</span><span class="p">(</span><span class="n">unit</span><span class="p">):</span>
						<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n\t</span><span class="s">inconsistent units</span><span class="se">\n\t</span><span class="s">(2 different units specified)</span><span class="se">\n\n</span><span class="s">&#39;</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n\t</span><span class="s">incompatible value</span><span class="se">\n\t</span><span class="s">(value must a str or a float or PhysicalQuantityWithUncertainty)</span><span class="se">\n\n</span><span class="s">&#39;</span><span class="p">)</span>

		<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">uncertainty</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">None</span><span class="p">)):</span>
			<span class="n">unc</span><span class="p">,</span> <span class="n">uncType</span><span class="p">,</span> <span class="n">absUnc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">uncertainty</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
				<span class="n">unc</span> <span class="o">=</span> <span class="n">uncertainty</span>

				<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">uncertaintyType</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">None</span><span class="p">)):</span>
					<span class="n">uncType</span> <span class="o">=</span> <span class="n">uncertaintyType</span>

					<span class="k">if</span> <span class="n">uncType</span> <span class="o">==</span> <span class="s">&#39;%&#39;</span><span class="p">:</span>
						<span class="n">absUnc</span> <span class="o">=</span> <span class="n">toShortestString</span><span class="p">(</span><span class="n">unc</span> <span class="o">/</span> <span class="mi">100</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
					<span class="k">elif</span> <span class="n">uncType</span> <span class="o">==</span> <span class="s">&#39;absolute&#39;</span><span class="p">:</span>
						<span class="n">absUnc</span> <span class="o">=</span> <span class="n">toShortestString</span><span class="p">(</span><span class="n">unc</span><span class="p">)</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n\t</span><span class="s">incompatible uncertaintyType</span><span class="se">\n\t</span><span class="s">(unable to parse uncertaintyType in </span><span class="si">%s</span><span class="se">\n\n</span><span class="s">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">uncertaintyType</span><span class="p">))</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">uncType</span> <span class="o">=</span> <span class="s">&#39;absolute&#39;</span>
					<span class="n">absUnc</span> <span class="o">=</span> <span class="n">toShortestString</span><span class="p">(</span><span class="n">unc</span><span class="p">)</span>

			<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">uncertainty</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
				<span class="k">try</span><span class="p">:</span>
					<span class="n">m</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">numberWithPercent</span><span class="p">(</span><span class="n">uncertainty</span><span class="p">)</span>
					<span class="n">unc</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
					<span class="n">uncType</span> <span class="o">=</span> <span class="s">&#39;%&#39;</span>
					<span class="n">absUnc</span> <span class="o">=</span> <span class="n">toShortestString</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">unc</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
				<span class="k">except</span><span class="p">:</span>
					<span class="n">m</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">number</span><span class="p">(</span><span class="n">uncertainty</span><span class="p">)</span>
					<span class="n">unc</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
					<span class="n">absUnc</span> <span class="o">=</span> <span class="n">unc</span>

					<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">uncertaintyType</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">None</span><span class="p">)):</span>
						<span class="n">uncType</span> <span class="o">=</span> <span class="s">&#39;absolute&#39;</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="n">uncType</span> <span class="o">=</span> <span class="n">uncertaintyType</span>

				<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">uncertaintyType</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">None</span><span class="p">)):</span>
					<span class="k">if</span> <span class="n">uncType</span> <span class="o">!=</span> <span class="n">uncertaintyType</span><span class="p">:</span>
						<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n\t</span><span class="s">inconsistent uncertaintyType</span><span class="se">\n\t</span><span class="s">(2 different uncertaintyTypedefined</span><span class="se">\n\n</span><span class="s">&#39;</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n\t</span><span class="s">incompatible uncertainty</span><span class="se">\n\t</span><span class="s">(uncertainty must be a number or a number with percent</span><span class="se">\n\t</span><span class="s">in float, int, or str type)</span><span class="se">\n\n</span><span class="s">&#39;</span><span class="p">)</span>

			<span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">absUnc</span><span class="p">)</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
				<span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
					<span class="n">y</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">findLeastPrecise</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">absUnc</span><span class="p">))</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="s">&#39;value&#39;</span><span class="p">]</span>

					<span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="s">&#39;uncertainty&#39;</span><span class="p">])</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
						<span class="k">if</span> <span class="n">uncType</span> <span class="o">==</span> <span class="s">&#39;%&#39;</span><span class="p">:</span>
							<span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span> <span class="o">=</span> <span class="n">unc</span>
							<span class="bp">self</span><span class="o">.</span><span class="n">uncertaintyType</span> <span class="o">=</span> <span class="s">&#39;%&#39;</span>
							<span class="bp">self</span><span class="o">.</span><span class="n">absoluteUncertainty</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="s">&#39;uncertainty&#39;</span><span class="p">]</span>
						<span class="k">else</span><span class="p">:</span>
							<span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="s">&#39;uncertainty&#39;</span><span class="p">]</span>
							<span class="bp">self</span><span class="o">.</span><span class="n">uncertaintyType</span> <span class="o">=</span> <span class="s">&#39;absolute&#39;</span>
							<span class="bp">self</span><span class="o">.</span><span class="n">absoluteUncertainty</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="s">&#39;uncertainty&#39;</span><span class="p">]</span>

						<span class="bp">self</span><span class="o">.</span><span class="n">significantDigits</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">findSignificantDigits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n\t</span><span class="s">incompatible uncertainty value</span><span class="se">\n\t</span><span class="s">(absolute uncertainty cannot be equal to zero</span><span class="se">\n\t</span><span class="s">when truncated to the same precision as the value)</span><span class="se">\n\n</span><span class="s">&#39;</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">uncertaintyType</span> <span class="o">=</span> <span class="s">&#39;absolute&#39;</span>
					<span class="n">sD</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">findSignificantDigits</span><span class="p">(</span><span class="n">absUnc</span><span class="p">)</span>

					<span class="k">if</span> <span class="n">sD</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
						<span class="bp">self</span><span class="o">.</span><span class="n">significantDigits</span> <span class="o">=</span> <span class="mi">2</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="bp">self</span><span class="o">.</span><span class="n">significantDigits</span> <span class="o">=</span> <span class="n">sD</span>

					<span class="bp">self</span><span class="o">.</span><span class="n">absoluteUncertainty</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">toSignificantDigits</span><span class="p">(</span><span class="n">absUnc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">significantDigits</span><span class="p">)</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">absoluteUncertainty</span>

				<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">significantDigits</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">None</span><span class="p">)):</span>
					<span class="k">if</span> <span class="n">significantDigits</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">significantDigits</span><span class="p">:</span>
						<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n\t</span><span class="s">inconsistent significantDigits</span><span class="se">\n\t</span><span class="s">(calculated significantDigits != significantDigits)</span><span class="se">\n\n</span><span class="s">&#39;</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n\t</span><span class="s">incompatible uncertainty value</span><span class="se">\n\t</span><span class="s">(absolute uncertainty cannot be equal to zero)</span><span class="se">\n\n</span><span class="s">&#39;</span><span class="p">)</span>

		<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">None</span><span class="p">)):</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">isDimensionless</span><span class="p">():</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">_findUnit</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">!=</span> <span class="n">_findUnit</span><span class="p">(</span><span class="n">unit</span><span class="p">):</span>
					<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n\t</span><span class="s">incompatible units</span><span class="se">\n\t</span><span class="s">(2 different units specified)&#39;</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

		<span class="k">try</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">uncertaintyType</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uncertaintyType</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">absoluteUncertainty</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">absoluteUncertainty</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">significantDigits</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">significantDigits</span><span class="p">)</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="k">pass</span>

	<span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">s</span> <span class="o">=</span> <span class="n">toShortestString</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

		<span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;uncertainty&#39;</span><span class="p">):</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">uncertaintyType</span> <span class="o">==</span> <span class="s">&#39;%&#39;</span><span class="p">:</span>
				<span class="n">s</span> <span class="o">+=</span> <span class="s">&#39; +/- &#39;</span> <span class="o">+</span> <span class="n">toShortestString</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;%&#39;</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
					<span class="n">s0</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">toSignificantDigits</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">significantDigits</span><span class="p">)</span>
					<span class="n">s</span> <span class="o">+=</span> <span class="s">&#39; +/- &#39;</span> <span class="o">+</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">toPrecision</span><span class="p">(</span><span class="n">toShortestString</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">absoluteUncertainty</span><span class="p">),</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">findPrecision</span><span class="p">(</span><span class="n">s0</span><span class="p">))</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">s</span> <span class="o">+=</span> <span class="s">&#39; +/- &#39;</span> <span class="o">+</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">toSignificantDigits</span><span class="p">(</span><span class="n">toShortestString</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">absoluteUncertainty</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">significantDigits</span><span class="p">)</span>

		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">isDimensionless</span><span class="p">():</span>
			<span class="n">s</span> <span class="o">+=</span> <span class="s">&#39; &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">symbol</span><span class="p">()</span>

		<span class="k">return</span> <span class="n">s</span>

	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span> <span class="o">+</span> <span class="s">&#39;(&#39;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
		<span class="n">s</span> <span class="o">+=</span> <span class="s">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">symbol</span><span class="p">())</span>

		<span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;uncertainty&#39;</span><span class="p">):</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">uncertaintyType</span> <span class="o">==</span> <span class="s">&#39;%&#39;</span><span class="p">:</span>
				<span class="n">s</span> <span class="o">+=</span> <span class="s">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uncertainty</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
					<span class="n">s0</span> <span class="o">=</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">toSignificantDigits</span><span class="p">(</span><span class="n">toShortestString</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">significantDigits</span><span class="p">)</span>
					<span class="n">s</span> <span class="o">+=</span> <span class="s">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">PatternRecognition</span><span class="o">.</span><span class="n">toPrecision</span><span class="p">(</span><span class="n">toShortestString</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">absoluteUncertainty</span><span class="p">),</span> <span class="n">PatternRecognition</span><span class="o">.</span><span class="n">findPrecision</span><span class="p">(</span><span class="n">s0</span><span class="p">)))</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">s</span> <span class="o">+=</span> <span class="s">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">PatternRecognition</span><span class="o">.</span><span class="n">toSignificantDigits</span><span class="p">(</span><span class="n">toShortestString</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">absoluteUncertainty</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">significantDigits</span><span class="p">))</span>

			<span class="n">s</span> <span class="o">+=</span> <span class="s">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uncertaintyType</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">significantDigits</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;)&#39;</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">s</span> <span class="o">+=</span> <span class="s">&#39;)&#39;</span>

		<span class="k">return</span> <span class="n">s</span>

	<span class="k">def</span> <span class="nf">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="nb">hash</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">factor</span><span class="p">)</span> <span class="o">+</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">powers</span><span class="p">))</span>

	<span class="k">def</span> <span class="nf">_epsilonFactor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">isPhysicalQuantityWithUncertainty</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
			<span class="k">return</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">sys</span><span class="o">.</span><span class="n">float_info</span><span class="o">.</span><span class="n">epsilon</span> <span class="o">*</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">return</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">sys</span><span class="o">.</span><span class="n">float_info</span><span class="o">.</span><span class="n">epsilon</span> <span class="o">*</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">other</span><span class="p">)))</span>

	<span class="k">def</span> <span class="nf">_sum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">sign1</span><span class="p">,</span> <span class="n">sign2</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">isPhysicalQuantityWithUncertainty</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">isDimensionless</span><span class="p">():</span>
				<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">isDimensionless</span><span class="p">():</span>
					<span class="n">new_value</span> <span class="o">=</span> <span class="n">sign1</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">getValueAs</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">sign2</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">getValueAs</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span>
					<span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="n">new_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;Incompatible units&#39;</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">new_value</span> <span class="o">=</span> <span class="n">sign1</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="n">sign2</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">conversionFactorTo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span>
				<span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="n">new_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">isDimensionless</span><span class="p">():</span>
				<span class="k">try</span><span class="p">:</span>
					<span class="n">new_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">sign1</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">getValueAs</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">sign2</span> <span class="o">*</span> <span class="n">other</span><span class="p">)</span>
					<span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="n">new_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span>
				<span class="k">except</span><span class="p">:</span>
					<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;Incompatible types&#39;</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;Incompatible units&#39;</span><span class="p">)</span>

		<span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilonFactor</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
			<span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span>

		<span class="k">return</span> <span class="n">result</span>

	<span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sum</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

	<span class="n">__radd__</span> <span class="o">=</span> <span class="n">__add__</span>

	<span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sum</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sum</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sum</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">0</span>
		<span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">False</span>

	<span class="k">def</span> <span class="nf">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sum</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="mi">0</span>
		<span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">True</span>

	<span class="k">def</span> <span class="nf">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sum</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;=</span> <span class="mi">0</span>

	<span class="k">def</span> <span class="nf">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sum</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">0</span>

	<span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sum</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span>

	<span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sum</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;</span> <span class="mi">0</span>

	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	def __cmp__(self, other):</span>
<span class="sd">		diff = self._sum(other, 1, -1)</span>
<span class="sd">		return cmp(diff.value, 0)</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="k">def</span> <span class="nf">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">isPhysicalQuantityWithUncertainty</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">*</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span>

		<span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">*</span><span class="n">other</span><span class="o">.</span><span class="n">value</span>
		<span class="n">unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">*</span><span class="n">other</span><span class="o">.</span><span class="n">unit</span>

		<span class="k">if</span> <span class="n">unit</span><span class="o">.</span><span class="n">isDimensionless</span><span class="p">():</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="n">value</span><span class="o">*</span><span class="n">unit</span><span class="o">.</span><span class="n">factor</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>

	<span class="n">__rmul__</span> <span class="o">=</span> <span class="n">__mul__</span>

	<span class="k">def</span> <span class="nf">__div__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">isPhysicalQuantityWithUncertainty</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">/</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span>

		<span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">/</span><span class="n">other</span><span class="o">.</span><span class="n">value</span>
		<span class="n">unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">/</span><span class="n">other</span><span class="o">.</span><span class="n">unit</span>

		<span class="k">if</span> <span class="n">unit</span><span class="o">.</span><span class="n">isDimensionless</span><span class="p">():</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="n">value</span><span class="o">*</span><span class="n">unit</span><span class="o">.</span><span class="n">factor</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">__rdiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">isPhysicalQuantityWithUncertainty</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="n">other</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="nb">pow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>

		<span class="n">value</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span>
		<span class="n">unit</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">unit</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">unit</span>

		<span class="k">if</span> <span class="n">unit</span><span class="o">.</span><span class="n">isDimensionless</span><span class="p">():</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="n">value</span><span class="o">*</span><span class="n">unit</span><span class="o">.</span><span class="n">factor</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">isPhysicalQuantityWithUncertainty</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
			<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;Exponents cannot be a PhysicalQuantityWithUncertainty&#39;</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">isDimensionless</span><span class="p">():</span>
				<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">other</span><span class="p">),</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">other</span><span class="p">),</span> <span class="nb">pow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="p">,</span> <span class="n">other</span><span class="p">))</span>

	<span class="k">def</span> <span class="nf">__rpow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;Exponents cannot be a PhysicalQuantityWithUncertainty&#39;</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">__abs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">__pos__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span>

	<span class="k">def</span> <span class="nf">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">__bool__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="mi">0</span>

	<span class="n">__nonzero__</span> <span class="o">=</span> <span class="n">__bool__</span>  <span class="c"># for python 2.x</span>

<div class="viewcode-block" id="PhysicalQuantityWithUncertainty.convertToUnit"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PhysicalQuantityWithUncertainty.convertToUnit">[docs]</a>	<span class="k">def</span> <span class="nf">convertToUnit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">Change the unit and adjust the value such that the combination is equivalent to </span>
<span class="sd">the original one. The new unit must be compatible with the previous unit of the </span>
<span class="sd">object.</span>

<span class="sd">:param str unit: a unit</span>
<span class="sd">:raises TypeError: if the unit string is not a know unit or a unit incompatible with the current one</span>

<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">unit</span> <span class="o">=</span> <span class="n">_findUnit</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">_convertValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">unit</span>
</div>
<div class="viewcode-block" id="PhysicalQuantityWithUncertainty.inUnitsOf"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PhysicalQuantityWithUncertainty.inUnitsOf">[docs]</a>	<span class="k">def</span> <span class="nf">inUnitsOf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">units</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">Express the quantity in different units. If one unit is specified, a new </span>
<span class="sd">PhysicalQuantityWithUncertainty object is returned that expresses the quantity </span>
<span class="sd">in that unit. If several units are specified, the return value is a tuple of </span>
<span class="sd">PhysicalObject instances with with one element per unit such that the sum of all</span>
<span class="sd">quantities in the tuple equals the the original quantity and all the values </span>
<span class="sd">except for the last one are integers. This is used to convert to irregular unit </span>
<span class="sd">systems like hour/minute/second.</span>

<span class="sd">:param units: one or several units</span>
<span class="sd">:type units: `str` or sequence of `str`</span>
<span class="sd">:returns: one or more physical quantities</span>
<span class="sd">:rtype: `PhysicalQuantityWithUncertainty` or `tuple` of `PhysicalQuantityWithUncertainty`</span>
<span class="sd">:raises TypeError: if any of the specified units are not compatible with the original unit</span>

<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">units</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">_findUnit</span><span class="p">,</span> <span class="n">units</span><span class="p">))</span>

		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">units</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
			<span class="n">unit</span> <span class="o">=</span> <span class="n">units</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
			<span class="n">value</span> <span class="o">=</span> <span class="n">_convertValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">units</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
			<span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
			<span class="n">unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span>

			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">units</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
				<span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">*</span><span class="n">unit</span><span class="o">.</span><span class="n">conversionFactorTo</span><span class="p">(</span><span class="n">units</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

				<span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
					<span class="n">rounded</span> <span class="o">=</span> <span class="n">value</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">rounded</span> <span class="o">=</span> <span class="n">_round</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

				<span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="n">rounded</span><span class="p">,</span> <span class="n">units</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
				<span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="o">-</span> <span class="n">rounded</span>
				<span class="n">unit</span> <span class="o">=</span> <span class="n">units</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

			<span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

	<span class="c"># Contributed by Berthold Hoellmann</span></div>
<div class="viewcode-block" id="PhysicalQuantityWithUncertainty.inBaseUnits"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PhysicalQuantityWithUncertainty.inBaseUnits">[docs]</a>	<span class="k">def</span> <span class="nf">inBaseUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">:returns: the same quantity converted to base units, i.e. SI units in most cases</span>
<span class="sd">:rtype: `PhysicalQuantityWithUncertainty`</span>

<span class="sd">		&quot;&quot;&quot;</span>

		<span class="k">try</span><span class="p">:</span>
			<span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">factor</span>
			<span class="n">num</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
			<span class="n">denom</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>

			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
				<span class="n">unit</span> <span class="o">=</span> <span class="n">_base_symbols</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
				<span class="n">power</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">powers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

				<span class="k">if</span> <span class="n">power</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
					<span class="n">denom</span> <span class="o">=</span> <span class="n">denom</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span> <span class="o">+</span> <span class="n">unit</span>

					<span class="k">if</span> <span class="n">power</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
						<span class="n">denom</span> <span class="o">=</span> <span class="n">denom</span> <span class="o">+</span> <span class="s">&#39;**&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">power</span><span class="p">)</span>

				<span class="k">elif</span> <span class="n">power</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
					<span class="n">num</span> <span class="o">=</span> <span class="n">num</span> <span class="o">+</span> <span class="s">&#39;*&#39;</span> <span class="o">+</span> <span class="n">unit</span>

					<span class="k">if</span> <span class="n">power</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
						<span class="n">num</span> <span class="o">=</span> <span class="n">num</span> <span class="o">+</span> <span class="s">&#39;**&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">power</span><span class="p">)</span>

			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
				<span class="n">num</span> <span class="o">=</span> <span class="s">&#39;1&#39;</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">num</span> <span class="o">=</span> <span class="n">num</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">num</span> <span class="o">+</span> <span class="n">denom</span><span class="p">)</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;Dimensionless unit has no base units&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PhysicalQuantityWithUncertainty.isCompatible"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PhysicalQuantityWithUncertainty.isCompatible">[docs]</a>	<span class="k">def</span> <span class="nf">isCompatible</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">:param unit: a unit</span>
<span class="sd">:type unit: `str`</span>
<span class="sd">:returns: `True` if the specified unit is compatible with the one of the quantity</span>
<span class="sd">:rtype: `bool`</span>

<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">unit</span> <span class="o">=</span> <span class="n">_findUnit</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">isCompatible</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PhysicalQuantityWithUncertainty.getValue"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PhysicalQuantityWithUncertainty.getValue">[docs]</a>	<span class="k">def</span> <span class="nf">getValue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">Return value (float) of physical quantity (no unit).</span>

<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</div>
<div class="viewcode-block" id="PhysicalQuantityWithUncertainty.getUnitSymbol"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PhysicalQuantityWithUncertainty.getUnitSymbol">[docs]</a>	<span class="k">def</span> <span class="nf">getUnitSymbol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">Return unit (string) of physical quantity.</span>

<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">symbol</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="PhysicalQuantityWithUncertainty.getValueAs"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PhysicalQuantityWithUncertainty.getValueAs">[docs]</a>	<span class="k">def</span> <span class="nf">getValueAs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">Returns value (float) in units of unit.</span>

<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">unit</span> <span class="o">=</span> <span class="n">_findUnit</span> <span class="p">(</span><span class="n">unit</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">_convertValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PhysicalQuantityWithUncertainty.sqrt"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PhysicalQuantityWithUncertainty.sqrt">[docs]</a>	<span class="k">def</span> <span class="nf">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="nb">pow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PhysicalQuantityWithUncertainty.sin"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PhysicalQuantityWithUncertainty.sin">[docs]</a>	<span class="k">def</span> <span class="nf">sin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">isAngle</span><span class="p">():</span>
			<span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">conversionFactorTo</span><span class="p">(</span><span class="n">_unit_table</span><span class="p">[</span><span class="s">&#39;rad&#39;</span><span class="p">]))</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;Argument of sin must be an angle&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PhysicalQuantityWithUncertainty.cos"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PhysicalQuantityWithUncertainty.cos">[docs]</a>	<span class="k">def</span> <span class="nf">cos</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">isAngle</span><span class="p">():</span>
			<span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">conversionFactorTo</span><span class="p">(</span><span class="n">_unit_table</span><span class="p">[</span><span class="s">&#39;rad&#39;</span><span class="p">]))</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;Argument of cos must be an angle&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PhysicalQuantityWithUncertainty.tan"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PhysicalQuantityWithUncertainty.tan">[docs]</a>	<span class="k">def</span> <span class="nf">tan</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">isAngle</span><span class="p">():</span>
			<span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">conversionFactorTo</span><span class="p">(</span><span class="n">_unit_table</span><span class="p">[</span><span class="s">&#39;rad&#39;</span><span class="p">]))</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;Argument of tan must be an angle&#39;</span><span class="p">)</span>
</div>
	<span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PhysicalQuantityWithUncertainty.isPhysicalUnitOf"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PhysicalQuantityWithUncertainty.isPhysicalUnitOf">[docs]</a>	<span class="k">def</span> <span class="nf">isPhysicalUnitOf</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">unit</span> <span class="p">)</span> <span class="p">:</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Returns True if self has units as the argument unit and False otherwise. Self and unit can be an instance of string,</span>
<span class="sd">		PhysicalUnit or PhysicalQuantityWithUncertainty.</span>
<span class="sd">		&quot;&quot;&quot;</span>

		<span class="k">if</span><span class="p">(</span> <span class="nb">type</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span> <span class="s">&#39;&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="bp">self</span> <span class="o">=</span> <span class="n">_findUnit</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span>
		<span class="n">selfUnit</span> <span class="o">=</span> <span class="n">_getPhysicalUnit</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span>
		<span class="k">if</span><span class="p">(</span> <span class="nb">type</span><span class="p">(</span> <span class="n">unit</span> <span class="p">)</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span> <span class="s">&#39;&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="n">unit</span> <span class="o">=</span> <span class="n">_findUnit</span><span class="p">(</span> <span class="n">unit</span> <span class="p">)</span>
		<span class="n">unitUnit</span> <span class="o">=</span> <span class="n">_getPhysicalUnit</span><span class="p">(</span> <span class="n">unit</span> <span class="p">)</span>
		<span class="k">return</span><span class="p">(</span> <span class="n">selfUnit</span><span class="o">.</span><span class="n">isCompatible</span><span class="p">(</span> <span class="n">unitUnit</span> <span class="p">)</span> <span class="p">)</span>
</div>
	<span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PhysicalQuantityWithUncertainty.isLength"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PhysicalQuantityWithUncertainty.isLength">[docs]</a>	<span class="k">def</span> <span class="nf">isLength</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
		<span class="s">&quot;Returns True if self has units of length and False otherwise.&quot;</span>

		<span class="k">return</span><span class="p">(</span> <span class="n">PhysicalQuantityWithUncertainty</span><span class="o">.</span><span class="n">isPhysicalUnitOf</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="s">&#39;m&#39;</span> <span class="p">)</span> <span class="p">)</span>
</div>
	<span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PhysicalQuantityWithUncertainty.isMass"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PhysicalQuantityWithUncertainty.isMass">[docs]</a>	<span class="k">def</span> <span class="nf">isMass</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
		<span class="s">&quot;Returns True if self has units of mass and False otherwise.&quot;</span>

		<span class="k">return</span><span class="p">(</span> <span class="n">PhysicalQuantityWithUncertainty</span><span class="o">.</span><span class="n">isPhysicalUnitOf</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="s">&#39;g&#39;</span> <span class="p">)</span> <span class="p">)</span>
</div>
	<span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PhysicalQuantityWithUncertainty.isTime"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PhysicalQuantityWithUncertainty.isTime">[docs]</a>	<span class="k">def</span> <span class="nf">isTime</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
		<span class="s">&quot;Returns True if self has units of time and False otherwise.&quot;</span>

		<span class="k">return</span><span class="p">(</span> <span class="n">PhysicalQuantityWithUncertainty</span><span class="o">.</span><span class="n">isPhysicalUnitOf</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="s">&#39;s&#39;</span> <span class="p">)</span> <span class="p">)</span>
</div>
	<span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PhysicalQuantityWithUncertainty.isCurrent"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PhysicalQuantityWithUncertainty.isCurrent">[docs]</a>	<span class="k">def</span> <span class="nf">isCurrent</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
		<span class="s">&quot;Returns True if self has units of current and False otherwise.&quot;</span>

		<span class="k">return</span><span class="p">(</span> <span class="n">PhysicalQuantityWithUncertainty</span><span class="o">.</span><span class="n">isPhysicalUnitOf</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="s">&#39;A&#39;</span> <span class="p">)</span> <span class="p">)</span>
</div>
	<span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PhysicalQuantityWithUncertainty.isTemperature"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PhysicalQuantityWithUncertainty.isTemperature">[docs]</a>	<span class="k">def</span> <span class="nf">isTemperature</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
		<span class="s">&quot;Returns True if self has units of temperature and False otherwise.&quot;</span>

		<span class="k">return</span><span class="p">(</span> <span class="n">PhysicalQuantityWithUncertainty</span><span class="o">.</span><span class="n">isPhysicalUnitOf</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="s">&#39;K&#39;</span> <span class="p">)</span> <span class="p">)</span>
</div>
	<span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PhysicalQuantityWithUncertainty.isMoles"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PhysicalQuantityWithUncertainty.isMoles">[docs]</a>	<span class="k">def</span> <span class="nf">isMoles</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
		<span class="s">&quot;Returns True if self has units of mol and False otherwise.&quot;</span>

		<span class="k">return</span><span class="p">(</span> <span class="n">PhysicalQuantityWithUncertainty</span><span class="o">.</span><span class="n">isPhysicalUnitOf</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="s">&#39;mol&#39;</span> <span class="p">)</span> <span class="p">)</span>
</div>
	<span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PhysicalQuantityWithUncertainty.isLuminousIntensity"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PhysicalQuantityWithUncertainty.isLuminousIntensity">[docs]</a>	<span class="k">def</span> <span class="nf">isLuminousIntensity</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
		<span class="s">&quot;Returns True if self has units of luminous intensity and False otherwise.&quot;</span>

		<span class="k">return</span><span class="p">(</span> <span class="n">PhysicalQuantityWithUncertainty</span><span class="o">.</span><span class="n">isPhysicalUnitOf</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="s">&#39;cd&#39;</span> <span class="p">)</span> <span class="p">)</span>
</div>
	<span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PhysicalQuantityWithUncertainty.isAngle"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PhysicalQuantityWithUncertainty.isAngle">[docs]</a>	<span class="k">def</span> <span class="nf">isAngle</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
		<span class="s">&quot;Returns True if self has units of angle and False otherwise.&quot;</span>

		<span class="k">return</span><span class="p">(</span> <span class="n">PhysicalQuantityWithUncertainty</span><span class="o">.</span><span class="n">isPhysicalUnitOf</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="s">&#39;rad&#39;</span> <span class="p">)</span> <span class="p">)</span>
</div>
	<span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PhysicalQuantityWithUncertainty.isSolidAngle"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PhysicalQuantityWithUncertainty.isSolidAngle">[docs]</a>	<span class="k">def</span> <span class="nf">isSolidAngle</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
		<span class="s">&quot;Returns True if self has units of solid angle and False otherwise.&quot;</span>

		<span class="k">return</span><span class="p">(</span> <span class="n">PhysicalQuantityWithUncertainty</span><span class="o">.</span><span class="n">isPhysicalUnitOf</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="s">&#39;sr&#39;</span> <span class="p">)</span> <span class="p">)</span>
</div>
	<span class="nd">@staticmethod</span>
<div class="viewcode-block" id="PhysicalQuantityWithUncertainty.isEnergy"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PhysicalQuantityWithUncertainty.isEnergy">[docs]</a>	<span class="k">def</span> <span class="nf">isEnergy</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>
		<span class="s">&quot;Returns True if self has units of energy and False otherwise.&quot;</span>

		<span class="k">return</span><span class="p">(</span> <span class="n">PhysicalQuantityWithUncertainty</span><span class="o">.</span><span class="n">isPhysicalUnitOf</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="s">&#39;J&#39;</span> <span class="p">)</span> <span class="p">)</span>

<span class="c"># Dictionary containing numbers</span>
<span class="c"># These objects are meant to be used like arrays with generalized indices. Non-existent elements default to zero. Global operations are addition, subtraction, and multiplication/division by a scalar.</span>
<span class="c"># Written by Konrad Hinsen &lt;hinsen@cnrs-orleans.fr&gt;</span>
<span class="c"># Last revision: 2006-10-16</span></div></div>
<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">DICTIONARY STORING NUMERICAL VALUES</span>

<span class="sd">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="NumberDict"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.NumberDict">[docs]</a><span class="k">class</span> <span class="nc">NumberDict</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">.. rubric:: DICTIONARY STORING NUMERICAL VALUES</span>

<span class="sd">Constructor: NumberDict()</span>

<span class="sd">An instance of this class acts like an array of number with generalized </span>
<span class="sd">(non-integer) indices. A value of zero is assumed for undefined entries. </span>
<span class="sd">NumberDict instances support addition, and subtraction with other NumberDict </span>
<span class="sd">instances, and multiplication and division by scalars.</span>

<span class="sd">	&quot;&quot;&quot;</span>

	<span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="k">return</span> <span class="nb">dict</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
		<span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
			<span class="k">return</span> <span class="mi">0</span>

	<span class="k">def</span> <span class="nf">__coerce__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="nb">type</span><span class="p">({}):</span>
			<span class="n">other</span> <span class="o">=</span> <span class="n">NumberDict</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

		<span class="n">other</span><span class="o">.</span><span class="n">removeUnneededDimensionlessUnits</span><span class="p">()</span>
		<span class="k">return</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span>

	<span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="n">sum_dict</span> <span class="o">=</span> <span class="n">NumberDict</span><span class="p">()</span>

		<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
			<span class="n">sum_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

		<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
			<span class="n">sum_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">sum_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">+</span> <span class="n">other</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

		<span class="n">sum_dict</span><span class="o">.</span><span class="n">removeUnneededDimensionlessUnits</span><span class="p">()</span>
		<span class="k">return</span> <span class="n">sum_dict</span>

	<span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="n">sum_dict</span> <span class="o">=</span> <span class="n">NumberDict</span><span class="p">()</span>

		<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
			<span class="n">sum_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

		<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
			<span class="n">sum_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">sum_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">-</span> <span class="n">other</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

		<span class="n">sum_dict</span><span class="o">.</span><span class="n">removeUnneededDimensionlessUnits</span><span class="p">()</span>
		<span class="k">return</span> <span class="n">sum_dict</span>

	<span class="k">def</span> <span class="nf">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="n">new</span> <span class="o">=</span> <span class="n">NumberDict</span><span class="p">()</span>

		<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
			<span class="n">new</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">other</span> <span class="o">*</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

		<span class="n">new</span><span class="o">.</span><span class="n">removeUnneededDimensionlessUnits</span><span class="p">()</span>
		<span class="k">return</span> <span class="n">new</span>

	<span class="n">__rmul__</span> <span class="o">=</span> <span class="n">__mul__</span>

	<span class="k">def</span> <span class="nf">__div__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="n">new</span> <span class="o">=</span> <span class="n">NumberDict</span><span class="p">()</span>

		<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
			<span class="n">new</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">/</span> <span class="n">other</span>

		<span class="n">new</span><span class="o">.</span><span class="n">removeUnneededDimensionlessUnits</span><span class="p">()</span>
		<span class="k">return</span> <span class="n">new</span>

<div class="viewcode-block" id="NumberDict.removeUnneededDimensionlessUnits"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.NumberDict.removeUnneededDimensionlessUnits">[docs]</a>	<span class="k">def</span> <span class="nf">removeUnneededDimensionlessUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">if</span> <span class="p">((</span><span class="s">&#39;&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
			<span class="k">del</span> <span class="bp">self</span><span class="p">[</span><span class="s">&#39;&#39;</span><span class="p">]</span>

</div></div>
<div class="viewcode-block" id="PhysicalUnit"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PhysicalUnit">[docs]</a><span class="k">class</span> <span class="nc">PhysicalUnit</span><span class="p">:</span>
	<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">.. rubric:: PHYSICAL UNIT</span>

<span class="sd">A physical unit is defined by a symbol (possibly composite), a scaling factor, and</span>
<span class="sd">the exponentials of each of the SI base units that enter into it. Units can be </span>
<span class="sd">multiplied, divided, and raised to integer powers.</span>

<span class="sd">:param symbols: a dictionary mapping each symbol component to its associated integer</span>
<span class="sd">                power (e.g. ``{&#39;m&#39;: 1, &#39;s&#39;: -1}``) for `m/s`). As a shorthand, a string may be </span>
<span class="sd">                passed which is assigned an implicit power 1.</span>
<span class="sd">:type symbols: `dict` or `str`</span>
<span class="sd">:param factor: a scaling factor</span>
<span class="sd">:type factor: `float`</span>
<span class="sd">:param powers: the integer powers for each of the nine base units</span>
<span class="sd">:type powers: `list` of `int`</span>
<span class="sd">:param offset: an additive offset to the base unit (used only for temperatures)</span>
<span class="sd">:type offset: `float`</span>


<span class="sd">	&quot;&quot;&quot;</span>
    
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">factor</span><span class="p">,</span> <span class="n">powers</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>

		<span class="k">if</span> <span class="n">symbols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="k">if</span> <span class="s">&#39;1&#39;</span> <span class="ow">in</span> <span class="n">symbols</span><span class="p">:</span>
				<span class="n">rmOne</span> <span class="o">=</span> <span class="bp">False</span>

				<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">symbols</span><span class="p">:</span>
					<span class="k">if</span> <span class="n">symbols</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
						<span class="n">rmOne</span> <span class="o">=</span> <span class="bp">True</span>

				<span class="k">if</span> <span class="n">rmOne</span><span class="p">:</span>
					<span class="k">del</span> <span class="n">symbols</span><span class="p">[</span><span class="s">&#39;1&#39;</span><span class="p">]</span>

		<span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">symbols</span><span class="p">)</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">symbols</span> <span class="o">=</span> <span class="n">NumberDict</span><span class="p">()</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="n">symbols</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">symbols</span> <span class="o">=</span> <span class="n">symbols</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">factor</span> <span class="o">=</span> <span class="n">factor</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="n">offset</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">powers</span> <span class="o">=</span> <span class="n">powers</span>

	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span> <span class="o">+</span> <span class="s">&quot;(&#39;&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;&#39;)&quot;</span>

	<span class="k">def</span> <span class="nf">__cmp__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="k">raise</span> <span class="ne">DeprecationWarning</span><span class="p">(</span><span class="s">&quot;__cmp__ not supported in Python3, use __lt__ and other rich comparison operators&quot;</span><span class="p">)</span>

		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">powers</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;Incompatible units&#39;</span><span class="p">)</span>

		<span class="k">return</span> <span class="nb">cmp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">factor</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">factor</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">powers</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;Incompatible units&#39;</span><span class="p">)</span>

		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span><span class="o">.</span><span class="n">__lt__</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">factor</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">powers</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;Incompatible units&#39;</span><span class="p">)</span>

		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span><span class="o">.</span><span class="n">__eq__</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">factor</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">powers</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;Incompatible units&#39;</span><span class="p">)</span>

		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span><span class="o">.</span><span class="n">__ne__</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">factor</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="p">(</span><span class="n">isPhysicalUnit</span> <span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">offset</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
			<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;cannot multiply units with non-zero offset&quot;</span><span class="p">)</span>

		<span class="k">if</span> <span class="n">isPhysicalUnit</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
			<span class="k">return</span> <span class="n">PhysicalUnit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbols</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">symbols</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">factor</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">powers</span><span class="p">)))</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">return</span> <span class="n">PhysicalUnit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbols</span> <span class="o">+</span> <span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="p">):</span> <span class="mi">1</span><span class="p">},</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span> <span class="o">*</span> <span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">*</span> <span class="n">other</span><span class="p">)</span>

	<span class="n">__rmul__</span> <span class="o">=</span> <span class="n">__mul__</span>

	<span class="k">def</span> <span class="nf">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="p">(</span><span class="n">isPhysicalUnit</span> <span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">offset</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
			<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;cannot divide units with non-zero offset&quot;</span><span class="p">)</span>

		<span class="k">if</span> <span class="n">isPhysicalUnit</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
			<span class="k">return</span> <span class="n">PhysicalUnit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbols</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">symbols</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span> <span class="o">/</span> <span class="n">other</span><span class="o">.</span><span class="n">factor</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">powers</span><span class="p">)))</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">return</span> <span class="n">PhysicalUnit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbols</span> <span class="o">+</span> <span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="p">):</span> <span class="o">-</span><span class="mi">1</span><span class="p">},</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span> <span class="o">/</span> <span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">__rtruediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="p">(</span><span class="n">isPhysicalUnit</span> <span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">offset</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
			<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;cannot divide units with non-zero offset&quot;</span><span class="p">)</span>

		<span class="k">if</span> <span class="n">isPhysicalUnit</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
			<span class="k">return</span> <span class="n">PhysicalUnit</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">symbols</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbols</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">factor</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">powers</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span><span class="p">)))</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">return</span> <span class="n">PhysicalUnit</span><span class="p">(</span><span class="n">NumberDict</span><span class="p">({</span><span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="p">):</span> <span class="mi">1</span><span class="p">})</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbols</span><span class="p">,</span> <span class="n">other</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span><span class="p">])</span>

	<span class="n">__div__</span> <span class="o">=</span> <span class="n">__truediv__</span>   <span class="c"># for python 2.x</span>
	<span class="n">__rdiv__</span> <span class="o">=</span> <span class="n">__rtruediv__</span>

	<span class="k">def</span> <span class="nf">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;cannot exponentiate units with non-zero offset&quot;</span><span class="p">)</span>

		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
			<span class="k">return</span> <span class="n">PhysicalUnit</span><span class="p">(</span><span class="n">other</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbols</span><span class="p">,</span> <span class="nb">pow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">factor</span><span class="p">,</span> <span class="n">other</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">other</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span><span class="p">)))</span>

		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
			<span class="n">inv_exp</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">other</span>
			<span class="n">rounded</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">inv_exp</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">))</span>

			<span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">inv_exp</span><span class="o">-</span><span class="n">rounded</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.e-10</span><span class="p">:</span>
				<span class="k">if</span> <span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="ow">and</span> <span class="n">b</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">rounded</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="n">e</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span><span class="p">))):</span>
					<span class="n">f</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">factor</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
					<span class="n">p</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">rounded</span><span class="p">:</span> <span class="n">x</span> <span class="o">/</span> <span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span><span class="p">))</span>

					<span class="k">if</span> <span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="ow">and</span> <span class="n">b</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">rounded</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="n">e</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbols</span><span class="o">.</span><span class="n">values</span><span class="p">())))):</span>
						<span class="n">symbols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbols</span><span class="o">/</span><span class="n">rounded</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="n">symbols</span> <span class="o">=</span> <span class="n">NumberDict</span><span class="p">()</span>

						<span class="k">if</span> <span class="n">f</span> <span class="o">!=</span> <span class="mf">1.</span><span class="p">:</span>
							<span class="n">symbols</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>

						<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)):</span>
							<span class="n">symbols</span><span class="p">[</span><span class="n">_base_symbols</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

					<span class="k">return</span> <span class="n">PhysicalUnit</span><span class="p">(</span><span class="n">symbols</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;Illegal exponent&#39;</span><span class="p">)</span>

		<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;Only integer and inverse integer exponents allowed&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="PhysicalUnit.conversionFactorTo"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PhysicalUnit.conversionFactorTo">[docs]</a>	<span class="k">def</span> <span class="nf">conversionFactorTo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">:param other: another unit</span>
<span class="sd">:type other: `PhysicalUnit`</span>
<span class="sd">:returns: the conversion factor from this unit to another unit</span>
<span class="sd">:rtype: `float`</span>
<span class="sd">:raises TypeError: if the units are not compatible</span>

<span class="sd">		&quot;&quot;&quot;</span>

		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">powers</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;Incompatible units&#39;</span><span class="p">)</span>

		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">offset</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">factor</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">((</span><span class="s">&#39;Unit conversion (</span><span class="si">%s</span><span class="s"> to </span><span class="si">%s</span><span class="s">) cannot be expressed &#39;</span> <span class="o">+</span> <span class="s">&#39;as a simple multiplicative factor&#39;</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="p">(),</span> <span class="n">other</span><span class="o">.</span><span class="n">symbol</span><span class="p">()))</span>

		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span> <span class="o">/</span> <span class="n">other</span><span class="o">.</span><span class="n">factor</span>
</div>
<div class="viewcode-block" id="PhysicalUnit.conversionTupleTo"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PhysicalUnit.conversionTupleTo">[docs]</a>	<span class="k">def</span> <span class="nf">conversionTupleTo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span> <span class="c"># added 1998/09/29 GPW</span>
		<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">:param other: another unit</span>
<span class="sd">:type other: `PhysicalUnit`</span>
<span class="sd">:returns: the conversion factor and offset from this unit to another unit</span>
<span class="sd">:rtype: (`float`, `float`)</span>
<span class="sd">:raises TypeError: if the units are not compatible</span>

<span class="sd">		&quot;&quot;&quot;</span>

		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">powers</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;Incompatible units&#39;</span><span class="p">)</span>

<span class="c"># let (s1,d1) be the conversion tuple from &#39;self&#39; to base units (ie. (x+d1)*s1 converts a value x from &#39;self&#39; to base units, and (x/s1)-d1 converts x from base to &#39;self&#39; units) and (s2,d2) be the conversion tuple from &#39;other&#39; to base units then we want to compute the conversion tuple (S,D) from &#39;self&#39; to &#39;other&#39; such that (x+D)*S converts x from &#39;self&#39; units to &#39;other&#39; units the formula to convert x from &#39;self&#39; to &#39;other&#39; units via the base units is (by definition of the conversion tuples):</span>
<span class="c">#    ( ((x+d1)*s1) / s2 ) - d2</span>
<span class="c">#  = ( (x+d1) * s1/s2) - d2</span>
<span class="c">#  = ( (x+d1) * s1/s2 ) - (d2*s2/s1) * s1/s2</span>
<span class="c">#  = ( (x+d1) - (d1*s2/s1) ) * s1/s2</span>
<span class="c">#  = (x + d1 - d2*s2/s1) * s1/s2</span>
<span class="c"># thus, D = d1 - d2*s2/s1 and S = s1/s2</span>

		<span class="n">factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span> <span class="o">/</span> <span class="n">other</span><span class="o">.</span><span class="n">factor</span>
		<span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">-</span> <span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">offset</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">factor</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span><span class="p">)</span>
		<span class="k">return</span> <span class="p">(</span><span class="n">factor</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PhysicalUnit.isCompatible"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PhysicalUnit.isCompatible">[docs]</a>	<span class="k">def</span> <span class="nf">isCompatible</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>     <span class="c"># added 1998/10/01 GPW</span>
		<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">:param other: another unit</span>
<span class="sd">:type other: `PhysicalUnit`</span>
<span class="sd">:returns: `True` if the units are compatible, i.e. if the powers of the base units are the same</span>
<span class="sd">:rtype: `bool`</span>

<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">powers</span>
</div>
<div class="viewcode-block" id="PhysicalUnit.isDimensionless"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PhysicalUnit.isDimensionless">[docs]</a>	<span class="k">def</span> <span class="nf">isDimensionless</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="ow">not</span> <span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="ow">or</span> <span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PhysicalUnit.isAngle"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PhysicalUnit.isAngle">[docs]</a>	<span class="k">def</span> <span class="nf">isAngle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">powers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
</div>
<div class="viewcode-block" id="PhysicalUnit.setSymbol"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PhysicalUnit.setSymbol">[docs]</a>	<span class="k">def</span> <span class="nf">setSymbol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">symbol</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">symbols</span> <span class="o">=</span> <span class="n">NumberDict</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="n">symbol</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</div>
<div class="viewcode-block" id="PhysicalUnit.symbol"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.PhysicalUnit.symbol">[docs]</a>	<span class="k">def</span> <span class="nf">symbol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">num</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
		<span class="n">denom</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>

		<span class="k">for</span> <span class="n">unit</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbols</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
			<span class="n">power</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="n">unit</span><span class="p">]</span>

			<span class="k">if</span> <span class="n">power</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
				<span class="n">denom</span> <span class="o">=</span> <span class="n">denom</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span> <span class="o">+</span> <span class="n">unit</span>

				<span class="k">if</span> <span class="n">power</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
					<span class="n">denom</span> <span class="o">=</span> <span class="n">denom</span> <span class="o">+</span> <span class="s">&#39;**&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">power</span><span class="p">)</span>
			<span class="k">elif</span> <span class="n">power</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
				<span class="n">num</span> <span class="o">=</span> <span class="n">num</span> <span class="o">+</span> <span class="s">&#39;*&#39;</span> <span class="o">+</span> <span class="n">unit</span>

				<span class="k">if</span> <span class="n">power</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
					<span class="n">num</span> <span class="o">=</span> <span class="n">num</span> <span class="o">+</span> <span class="s">&#39;**&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">power</span><span class="p">)</span>

		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
			<span class="n">num</span> <span class="o">=</span> <span class="s">&#39;1&#39;</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">num</span> <span class="o">=</span> <span class="n">num</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

		<span class="k">return</span> <span class="n">num</span> <span class="o">+</span> <span class="n">denom</span>
</div>
	<span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="p">()</span>


<span class="c"># Type checks</span></div>
<div class="viewcode-block" id="isPhysicalUnit"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.isPhysicalUnit">[docs]</a><span class="k">def</span> <span class="nf">isPhysicalUnit</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">:param x: an object</span>
<span class="sd">:type x: any</span>
<span class="sd">:returns: `True if x is a `PhysicalUnit`</span>
<span class="sd">:rtype: `bool`</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">return</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s">&#39;factor&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s">&#39;powers&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="isPhysicalQuantityWithUncertainty"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.isPhysicalQuantityWithUncertainty">[docs]</a><span class="k">def</span> <span class="nf">isPhysicalQuantityWithUncertainty</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">:param x: an object</span>
<span class="sd">:type x: any</span>
<span class="sd">:returns: `True` if x is a `PhysicalQuantityWithUncertainty`</span>
<span class="sd">:rtype: `bool`</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">return</span> <span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s">&#39;value&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s">&#39;unit&#39;</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s">&#39;value&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s">&#39;uncertainty&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s">&#39;uncertaintyType&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s">&#39;significantDigits&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s">&#39;unit&#39;</span><span class="p">))</span>


<span class="c"># Helper functions</span></div>
<span class="k">def</span> <span class="nf">_findUnit</span><span class="p">(</span><span class="n">unit</span><span class="p">):</span>
	<span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">):</span>
		<span class="n">symbol</span> <span class="o">=</span> <span class="n">unit</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

		<span class="k">if</span> <span class="n">symbol</span> <span class="o">==</span> <span class="s">&#39;&#39;</span><span class="p">:</span>
			<span class="n">unit</span> <span class="o">=</span> <span class="n">_unit_table</span><span class="p">[</span><span class="n">symbol</span><span class="p">]</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">unit</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="n">_unit_table</span><span class="p">)</span>

		<span class="k">for</span> <span class="n">cruft</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;__builtins__&#39;</span><span class="p">,</span> <span class="s">&#39;__args__&#39;</span><span class="p">]:</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="k">del</span> <span class="n">_unit_table</span><span class="p">[</span><span class="n">cruft</span><span class="p">]</span>
			<span class="k">except</span><span class="p">:</span>
				<span class="k">pass</span>

	<span class="k">if</span> <span class="ow">not</span> <span class="n">isPhysicalUnit</span><span class="p">(</span><span class="n">unit</span><span class="p">):</span>
		<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39; is not a unit&#39;</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">unit</span>

<span class="k">def</span> <span class="nf">_round</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
	<span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">:</span>
		<span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_convertValue</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">src_unit</span><span class="p">,</span> <span class="n">target_unit</span><span class="p">):</span>
	<span class="p">(</span><span class="n">factor</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span> <span class="o">=</span> <span class="n">src_unit</span><span class="o">.</span><span class="n">conversionTupleTo</span><span class="p">(</span><span class="n">target_unit</span><span class="p">)</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">value</span> <span class="o">+</span> <span class="n">offset</span><span class="p">)</span> <span class="o">*</span> <span class="n">factor</span>

<span class="k">def</span> <span class="nf">_getPhysicalUnit</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span> <span class="p">:</span>

    <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">PhysicalUnit</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="bp">self</span> <span class="p">)</span>
    <span class="k">if</span><span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">PhysicalQuantityWithUncertainty</span> <span class="p">)</span> <span class="p">)</span> <span class="p">:</span> <span class="k">return</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="p">)</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span> <span class="s">&#39;Valid instance for _getPhysicalUnit&#39;</span> <span class="p">)</span>

<span class="c"># SI unit definitions</span>

<span class="n">_base_symbols</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;m&#39;</span><span class="p">,</span> <span class="s">&#39;kg&#39;</span><span class="p">,</span> <span class="s">&#39;s&#39;</span><span class="p">,</span> <span class="s">&#39;A&#39;</span><span class="p">,</span> <span class="s">&#39;K&#39;</span><span class="p">,</span> <span class="s">&#39;mol&#39;</span><span class="p">,</span> <span class="s">&#39;cd&#39;</span><span class="p">,</span> <span class="s">&#39;rad&#39;</span><span class="p">,</span> <span class="s">&#39;sr&#39;</span><span class="p">]</span>

<span class="n">_base_units</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&#39;m&#39;</span><span class="p">,</span>   <span class="n">PhysicalUnit</span><span class="p">(</span><span class="s">&#39;m&#39;</span><span class="p">,</span>   <span class="mf">1.</span><span class="p">,</span>    <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])),</span>
               <span class="p">(</span><span class="s">&#39;g&#39;</span><span class="p">,</span>   <span class="n">PhysicalUnit</span><span class="p">(</span><span class="s">&#39;g&#39;</span><span class="p">,</span>   <span class="mf">0.001</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])),</span>
               <span class="p">(</span><span class="s">&#39;s&#39;</span><span class="p">,</span>   <span class="n">PhysicalUnit</span><span class="p">(</span><span class="s">&#39;s&#39;</span><span class="p">,</span>   <span class="mf">1.</span><span class="p">,</span>    <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])),</span>
               <span class="p">(</span><span class="s">&#39;A&#39;</span><span class="p">,</span>   <span class="n">PhysicalUnit</span><span class="p">(</span><span class="s">&#39;A&#39;</span><span class="p">,</span>   <span class="mf">1.</span><span class="p">,</span>    <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])),</span>
               <span class="p">(</span><span class="s">&#39;K&#39;</span><span class="p">,</span>   <span class="n">PhysicalUnit</span><span class="p">(</span><span class="s">&#39;K&#39;</span><span class="p">,</span>   <span class="mf">1.</span><span class="p">,</span>    <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])),</span>
               <span class="p">(</span><span class="s">&#39;mol&#39;</span><span class="p">,</span> <span class="n">PhysicalUnit</span><span class="p">(</span><span class="s">&#39;mol&#39;</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span>    <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])),</span>
               <span class="p">(</span><span class="s">&#39;cd&#39;</span><span class="p">,</span>  <span class="n">PhysicalUnit</span><span class="p">(</span><span class="s">&#39;cd&#39;</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>    <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])),</span>
               <span class="p">(</span><span class="s">&#39;rad&#39;</span><span class="p">,</span> <span class="n">PhysicalUnit</span><span class="p">(</span><span class="s">&#39;rad&#39;</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span>    <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])),</span>
               <span class="p">(</span><span class="s">&#39;sr&#39;</span><span class="p">,</span>  <span class="n">PhysicalUnit</span><span class="p">(</span><span class="s">&#39;sr&#39;</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>    <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])),</span>
               <span class="p">]</span>

<span class="n">_prefixes</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&#39;Y&#39;</span><span class="p">,</span>  <span class="mf">1.e24</span><span class="p">,</span> <span class="s">&#39;yotta&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s">&#39;Z&#39;</span><span class="p">,</span>  <span class="mf">1.e21</span><span class="p">,</span> <span class="s">&#39;zetta&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s">&#39;E&#39;</span><span class="p">,</span>  <span class="mf">1.e18</span><span class="p">,</span> <span class="s">&#39;exa&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s">&#39;P&#39;</span><span class="p">,</span>  <span class="mf">1.e15</span><span class="p">,</span> <span class="s">&#39;peta&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s">&#39;T&#39;</span><span class="p">,</span>  <span class="mf">1.e12</span><span class="p">,</span> <span class="s">&#39;tera&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s">&#39;G&#39;</span><span class="p">,</span>  <span class="mf">1.e9</span><span class="p">,</span> <span class="s">&#39;giga&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s">&#39;M&#39;</span><span class="p">,</span>  <span class="mf">1.e6</span><span class="p">,</span> <span class="s">&#39;mega&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s">&#39;k&#39;</span><span class="p">,</span>  <span class="mf">1.e3</span><span class="p">,</span> <span class="s">&#39;kilo&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s">&#39;h&#39;</span><span class="p">,</span>  <span class="mf">1.e2</span><span class="p">,</span> <span class="s">&#39;hecto&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s">&#39;da&#39;</span><span class="p">,</span> <span class="mf">1.e1</span><span class="p">,</span> <span class="s">&#39;deka&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span>  <span class="mf">1.e-1</span><span class="p">,</span> <span class="s">&#39;deci&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">,</span>  <span class="mf">1.e-2</span><span class="p">,</span> <span class="s">&#39;centi&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s">&#39;m&#39;</span><span class="p">,</span>  <span class="mf">1.e-3</span><span class="p">,</span> <span class="s">&#39;milli&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s">&#39;mu&#39;</span><span class="p">,</span> <span class="mf">1.e-6</span><span class="p">,</span> <span class="s">&#39;micro&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s">&#39;n&#39;</span><span class="p">,</span>  <span class="mf">1.e-9</span><span class="p">,</span> <span class="s">&#39;nano&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s">&#39;p&#39;</span><span class="p">,</span>  <span class="mf">1.e-12</span><span class="p">,</span> <span class="s">&#39;pico&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span>  <span class="mf">1.e-15</span><span class="p">,</span> <span class="s">&#39;femto&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span>  <span class="mf">1.e-18</span><span class="p">,</span> <span class="s">&#39;atto&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s">&#39;z&#39;</span><span class="p">,</span>  <span class="mf">1.e-21</span><span class="p">,</span> <span class="s">&#39;zepto&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s">&#39;y&#39;</span><span class="p">,</span>  <span class="mf">1.e-24</span><span class="p">,</span> <span class="s">&#39;yocto&#39;</span><span class="p">),</span>
             <span class="p">]</span>

<span class="n">_help</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">_unit_table</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">unit</span> <span class="ow">in</span> <span class="n">_base_units</span><span class="p">:</span>
	<span class="n">_unit_table</span><span class="p">[</span><span class="n">unit</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">unit</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">_addUnit</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">):</span>
	<span class="k">if</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="n">_unit_table</span><span class="p">:</span>
		<span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s">&#39;Unit &#39;</span> <span class="o">+</span> <span class="n">symbol</span> <span class="o">+</span> <span class="s">&#39; already defined&#39;</span><span class="p">)</span>

	<span class="k">if</span> <span class="n">name</span><span class="p">:</span>
		<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">name</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">symbol</span><span class="p">))</span>

	<span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">):</span>
		<span class="n">unit</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="n">_unit_table</span><span class="p">)</span>

		<span class="k">for</span> <span class="n">cruft</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;__builtins__&#39;</span><span class="p">,</span> <span class="s">&#39;__args__&#39;</span><span class="p">]:</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="k">del</span> <span class="n">_unit_table</span><span class="p">[</span><span class="n">cruft</span><span class="p">]</span>
			<span class="k">except</span><span class="p">:</span>
				<span class="k">pass</span>

	<span class="n">unit</span><span class="o">.</span><span class="n">setSymbol</span><span class="p">(</span><span class="n">symbol</span><span class="p">)</span>
	<span class="n">_unit_table</span><span class="p">[</span><span class="n">symbol</span><span class="p">]</span> <span class="o">=</span> <span class="n">unit</span>

<span class="k">def</span> <span class="nf">_addPrefixedUnit</span><span class="p">(</span><span class="n">unit</span><span class="p">):</span>
	<span class="n">_prefixed_symbols</span> <span class="o">=</span> <span class="p">[]</span>

	<span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="n">_prefixes</span><span class="p">:</span>
		<span class="n">symbol</span> <span class="o">=</span> <span class="n">prefix</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">unit</span>
		<span class="n">_addUnit</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="n">prefix</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">_unit_table</span><span class="p">[</span><span class="n">unit</span><span class="p">])</span>
		<span class="n">_prefixed_symbols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">symbol</span><span class="p">)</span>

	<span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">_help</span><span class="p">:</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
				<span class="n">name0</span><span class="p">,</span> <span class="n">unit0</span><span class="p">,</span> <span class="n">symbol0</span> <span class="o">=</span> <span class="n">entry</span>
				<span class="n">i</span> <span class="o">=</span> <span class="n">_help</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="n">symbol0</span><span class="p">:</span>
					<span class="n">_help</span><span class="o">.</span><span class="n">__setitem__</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">name0</span><span class="p">,</span> <span class="n">unit0</span><span class="p">,</span> <span class="n">symbol0</span><span class="p">,</span> <span class="n">_prefixed_symbols</span><span class="p">))</span>

<span class="c"># SI derived units; these automatically get prefixes</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;.. rubric:: Prefixes: </span><span class="se">\n</span><span class="s"> </span><span class="se">\n</span><span class="s">::&#39;</span><span class="p">)</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;    ----  ------ ------</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">+</span> <span class="s">&#39;    name  factor symbol</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">+</span> <span class="s">&#39;    ----  ------ ------&#39;</span><span class="p">)</span>
<span class="n">_help_prefix</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c">#for i in range(20):</span>
<span class="c">#	_help_prefix.append(&#39;%-5s %-6s %-.0e&#39; % (_prefixes[i][2], _prefixes[i][0], _prefixes[i][1]))</span>

<span class="c">#_help.append(&#39;\n&#39;.join(_help_prefix))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
	<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s">&#39;</span><span class="si">%-5s</span><span class="s"> </span><span class="si">%-6.0e</span><span class="s"> </span><span class="si">%-s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">_prefixes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">_prefixes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">_prefixes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span> <span class="s">&#39;&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">))</span>

<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">    </span><span class="si">%-26s</span><span class="s"> </span><span class="si">%-32s</span><span class="s"> </span><span class="si">%-s</span><span class="se">\n</span><span class="s">    </span><span class="si">%-26s</span><span class="s"> </span><span class="si">%-32s</span><span class="s"> </span><span class="si">%-s</span><span class="se">\n</span><span class="s">    </span><span class="si">%-26s</span><span class="s"> </span><span class="si">%-32s</span><span class="s"> </span><span class="si">%-s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s">&#39;--------------------------&#39;</span><span class="p">,</span> <span class="s">&#39;--------------------------------&#39;</span><span class="p">,</span> <span class="s">&#39;------&#39;</span><span class="p">,</span> <span class="s">&#39;name&#39;</span><span class="p">,</span> <span class="s">&#39;value&#39;</span><span class="p">,</span> <span class="s">&#39;symbol&#39;</span><span class="p">,</span> <span class="s">&#39;--------------------------&#39;</span><span class="p">,</span> <span class="s">&#39;--------------------------------&#39;</span><span class="p">,</span> <span class="s">&#39;------&#39;</span><span class="p">))</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;    SI derived units; these automatically get prefixes ............... &#39;</span><span class="p">)</span>

<span class="n">_unit_table</span><span class="p">[</span><span class="s">&#39;kg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PhysicalUnit</span><span class="p">(</span><span class="s">&#39;kg&#39;</span><span class="p">,</span>   <span class="mf">1.</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;Hz&#39;</span><span class="p">,</span> <span class="s">&#39;1./s&#39;</span><span class="p">,</span> <span class="s">&#39;Hertz&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;N&#39;</span><span class="p">,</span> <span class="s">&#39;m*kg/s**2&#39;</span><span class="p">,</span> <span class="s">&#39;Newton&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;Pa&#39;</span><span class="p">,</span> <span class="s">&#39;N/m**2&#39;</span><span class="p">,</span> <span class="s">&#39;Pascal&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;J&#39;</span><span class="p">,</span> <span class="s">&#39;N*m&#39;</span><span class="p">,</span> <span class="s">&#39;Joule&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;W&#39;</span><span class="p">,</span> <span class="s">&#39;J/s&#39;</span><span class="p">,</span> <span class="s">&#39;Watt&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="s">&#39;s*A&#39;</span><span class="p">,</span> <span class="s">&#39;Coulomb&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;V&#39;</span><span class="p">,</span> <span class="s">&#39;W/A&#39;</span><span class="p">,</span> <span class="s">&#39;Volt&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;F&#39;</span><span class="p">,</span> <span class="s">&#39;C/V&#39;</span><span class="p">,</span> <span class="s">&#39;Farad&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;ohm&#39;</span><span class="p">,</span> <span class="s">&#39;V/A&#39;</span><span class="p">,</span> <span class="s">&#39;Ohm&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;S&#39;</span><span class="p">,</span> <span class="s">&#39;A/V&#39;</span><span class="p">,</span> <span class="s">&#39;Siemens&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;Wb&#39;</span><span class="p">,</span> <span class="s">&#39;V*s&#39;</span><span class="p">,</span> <span class="s">&#39;Weber&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;T&#39;</span><span class="p">,</span> <span class="s">&#39;Wb/m**2&#39;</span><span class="p">,</span> <span class="s">&#39;Tesla&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;H&#39;</span><span class="p">,</span> <span class="s">&#39;Wb/A&#39;</span><span class="p">,</span> <span class="s">&#39;Henry&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;lm&#39;</span><span class="p">,</span> <span class="s">&#39;cd*sr&#39;</span><span class="p">,</span> <span class="s">&#39;Lumen&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;lx&#39;</span><span class="p">,</span> <span class="s">&#39;lm/m**2&#39;</span><span class="p">,</span> <span class="s">&#39;Lux&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;Bq&#39;</span><span class="p">,</span> <span class="s">&#39;1./s&#39;</span><span class="p">,</span> <span class="s">&#39;Becquerel&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;Gy&#39;</span><span class="p">,</span> <span class="s">&#39;J/kg&#39;</span><span class="p">,</span> <span class="s">&#39;Gray&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;Sv&#39;</span><span class="p">,</span> <span class="s">&#39;J/kg&#39;</span><span class="p">,</span> <span class="s">&#39;Sievert&#39;</span><span class="p">)</span>

<span class="k">del</span> <span class="n">_unit_table</span><span class="p">[</span><span class="s">&#39;kg&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">unit</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">_unit_table</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
	<span class="n">_addPrefixedUnit</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>

<span class="c"># NOTE everything below does not have prefixes added to units</span>

<span class="c"># Dimensionless quantities</span>
<span class="n">_unit_table</span><span class="p">[</span><span class="s">&#39;&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PhysicalUnit</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>

<span class="c"># Fundamental constants</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;    Fundamental constants ............................................ &#39;</span><span class="p">)</span>

<span class="n">_unit_table</span><span class="p">[</span><span class="s">&#39;pi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="s">&#39;299792458.*m/s&#39;</span><span class="p">,</span> <span class="s">&#39;speed of light&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;mu0&#39;</span><span class="p">,</span> <span class="s">&#39;4.e-7*pi*N/A**2&#39;</span><span class="p">,</span> <span class="s">&#39;permeability of vacuum&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;eps0&#39;</span><span class="p">,</span> <span class="s">&#39;1./mu0/c**2&#39;</span><span class="p">,</span> <span class="s">&#39;permittivity of vacuum&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;Grav&#39;</span><span class="p">,</span> <span class="s">&#39;6.67259e-11*m**3/kg/s**2&#39;</span><span class="p">,</span> <span class="s">&#39;gravitational constant&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;hplanck&#39;</span><span class="p">,</span> <span class="s">&#39;6.6260755e-34*J*s&#39;</span><span class="p">,</span> <span class="s">&#39;Planck constant&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;hbar&#39;</span><span class="p">,</span> <span class="s">&#39;hplanck/(2*pi)&#39;</span><span class="p">,</span> <span class="s">&#39;Planck constant / 2pi&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="s">&#39;1.60217733e-19*C&#39;</span><span class="p">,</span> <span class="s">&#39;elementary charge&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;me&#39;</span><span class="p">,</span> <span class="s">&#39;9.1093897e-31*kg&#39;</span><span class="p">,</span> <span class="s">&#39;electron mass&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;mp&#39;</span><span class="p">,</span> <span class="s">&#39;1.6726231e-27*kg&#39;</span><span class="p">,</span> <span class="s">&#39;proton mass&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;Nav&#39;</span><span class="p">,</span> <span class="s">&#39;6.0221367e23/mol&#39;</span><span class="p">,</span> <span class="s">&#39;Avogadro number&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;k&#39;</span><span class="p">,</span> <span class="s">&#39;1.380658e-23*J/K&#39;</span><span class="p">,</span> <span class="s">&#39;Boltzmann constant&#39;</span><span class="p">)</span>

<span class="c"># Time units</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;    Time units ....................................................... &#39;</span><span class="p">)</span>

<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;min&#39;</span><span class="p">,</span> <span class="s">&#39;60.*s&#39;</span><span class="p">,</span> <span class="s">&#39;minute&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;h&#39;</span><span class="p">,</span> <span class="s">&#39;60.*min&#39;</span><span class="p">,</span> <span class="s">&#39;hour&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="s">&#39;24.*h&#39;</span><span class="p">,</span> <span class="s">&#39;day&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;wk&#39;</span><span class="p">,</span> <span class="s">&#39;7.*d&#39;</span><span class="p">,</span> <span class="s">&#39;week&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;yr&#39;</span><span class="p">,</span> <span class="s">&#39;365.25*d&#39;</span><span class="p">,</span> <span class="s">&#39;year&#39;</span><span class="p">)</span>

<span class="c"># Length units</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;    Length units ..................................................... &#39;</span><span class="p">)</span>

<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;inch&#39;</span><span class="p">,</span> <span class="s">&#39;2.54*cm&#39;</span><span class="p">,</span> <span class="s">&#39;inch&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;ft&#39;</span><span class="p">,</span> <span class="s">&#39;12.*inch&#39;</span><span class="p">,</span> <span class="s">&#39;foot&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;yd&#39;</span><span class="p">,</span> <span class="s">&#39;3.*ft&#39;</span><span class="p">,</span> <span class="s">&#39;yard&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;mi&#39;</span><span class="p">,</span> <span class="s">&#39;5280.*ft&#39;</span><span class="p">,</span> <span class="s">&#39;(British) mile&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;nmi&#39;</span><span class="p">,</span> <span class="s">&#39;1852.*m&#39;</span><span class="p">,</span> <span class="s">&#39;Nautical mile&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;Ang&#39;</span><span class="p">,</span> <span class="s">&#39;1.e-10*m&#39;</span><span class="p">,</span> <span class="s">&#39;Angstrom&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;lyr&#39;</span><span class="p">,</span> <span class="s">&#39;c*yr&#39;</span><span class="p">,</span> <span class="s">&#39;light year&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;Bohr&#39;</span><span class="p">,</span> <span class="s">&#39;4.*pi*eps0*hbar**2/me/e**2&#39;</span><span class="p">,</span> <span class="s">&#39;Bohr radius&#39;</span><span class="p">)</span>

<span class="c"># Area units</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;    Area units ....................................................... &#39;</span><span class="p">)</span>

<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;ha&#39;</span><span class="p">,</span> <span class="s">&#39;10000*m**2&#39;</span><span class="p">,</span> <span class="s">&#39;hectare&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;acres&#39;</span><span class="p">,</span> <span class="s">&#39;mi**2/640&#39;</span><span class="p">,</span> <span class="s">&#39;acre&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="s">&#39;1.e-28*m**2&#39;</span><span class="p">,</span> <span class="s">&#39;barn&#39;</span><span class="p">)</span>

<span class="n">_addPrefixedUnit</span><span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">)</span>

<span class="c"># Volume units</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;    Volume units ..................................................... &#39;</span><span class="p">)</span>

<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;l&#39;</span><span class="p">,</span> <span class="s">&#39;dm**3&#39;</span><span class="p">,</span> <span class="s">&#39;liter&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;dl&#39;</span><span class="p">,</span> <span class="s">&#39;0.1*l&#39;</span><span class="p">,</span> <span class="s">&#39;deci liter&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;cl&#39;</span><span class="p">,</span> <span class="s">&#39;0.01*l&#39;</span><span class="p">,</span> <span class="s">&#39;centi liter&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;ml&#39;</span><span class="p">,</span> <span class="s">&#39;0.001*l&#39;</span><span class="p">,</span> <span class="s">&#39;milli liter&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;tsp&#39;</span><span class="p">,</span> <span class="s">&#39;4.92892159375*ml&#39;</span><span class="p">,</span> <span class="s">&#39;teaspoon&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;tbsp&#39;</span><span class="p">,</span> <span class="s">&#39;3.*tsp&#39;</span><span class="p">,</span> <span class="s">&#39;tablespoon&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;floz&#39;</span><span class="p">,</span> <span class="s">&#39;2.*tbsp&#39;</span><span class="p">,</span> <span class="s">&#39;fluid ounce&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;cup&#39;</span><span class="p">,</span> <span class="s">&#39;8.*floz&#39;</span><span class="p">,</span> <span class="s">&#39;cup&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;pt&#39;</span><span class="p">,</span> <span class="s">&#39;16.*floz&#39;</span><span class="p">,</span> <span class="s">&#39;pint&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;qt&#39;</span><span class="p">,</span> <span class="s">&#39;2.*pt&#39;</span><span class="p">,</span> <span class="s">&#39;quart&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;galUS&#39;</span><span class="p">,</span> <span class="s">&#39;4.*qt&#39;</span><span class="p">,</span> <span class="s">&#39;US gallon&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;galUK&#39;</span><span class="p">,</span> <span class="s">&#39;4.54609*l&#39;</span><span class="p">,</span> <span class="s">&#39;British gallon&#39;</span><span class="p">)</span>

<span class="c"># Mass units</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;    Mass units ....................................................... &#39;</span><span class="p">)</span>

<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;amu&#39;</span><span class="p">,</span> <span class="s">&#39;1.6605402e-27*kg&#39;</span><span class="p">,</span> <span class="s">&#39;atomic mass units&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;oz&#39;</span><span class="p">,</span> <span class="s">&#39;28.349523125*g&#39;</span><span class="p">,</span> <span class="s">&#39;ounce&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;lb&#39;</span><span class="p">,</span> <span class="s">&#39;16.*oz&#39;</span><span class="p">,</span> <span class="s">&#39;pound&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;ton&#39;</span><span class="p">,</span> <span class="s">&#39;2000.*lb&#39;</span><span class="p">,</span> <span class="s">&#39;ton&#39;</span><span class="p">)</span>

<span class="c"># Force units</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;    Force units ...................................................... &#39;</span><span class="p">)</span>

<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;dyn&#39;</span><span class="p">,</span> <span class="s">&#39;1.e-5*N&#39;</span><span class="p">,</span> <span class="s">&#39;dyne (cgs unit)&#39;</span><span class="p">)</span>

<span class="c"># Energy units</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;    Energy units ..................................................... &#39;</span><span class="p">)</span>

<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;erg&#39;</span><span class="p">,</span> <span class="s">&#39;1.e-7*J&#39;</span><span class="p">,</span> <span class="s">&#39;erg (cgs unit)&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;eV&#39;</span><span class="p">,</span> <span class="s">&#39;e*V&#39;</span><span class="p">,</span> <span class="s">&#39;electron volt&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;Hartree&#39;</span><span class="p">,</span> <span class="s">&#39;me*e**4/16/pi**2/eps0**2/hbar**2&#39;</span><span class="p">,</span> <span class="s">&#39;Wavenumbers/inverse cm&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;Ken&#39;</span><span class="p">,</span> <span class="s">&#39;k*K&#39;</span><span class="p">,</span> <span class="s">&#39;Kelvin as energy unit&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;cal&#39;</span><span class="p">,</span> <span class="s">&#39;4.184*J&#39;</span><span class="p">,</span> <span class="s">&#39;thermochemical calorie&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;kcal&#39;</span><span class="p">,</span> <span class="s">&#39;1000.*cal&#39;</span><span class="p">,</span> <span class="s">&#39;thermochemical kilocalorie&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;cali&#39;</span><span class="p">,</span> <span class="s">&#39;4.1868*J&#39;</span><span class="p">,</span> <span class="s">&#39;international calorie&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;kcali&#39;</span><span class="p">,</span> <span class="s">&#39;1000.*cali&#39;</span><span class="p">,</span> <span class="s">&#39;international kilocalorie&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;Btu&#39;</span><span class="p">,</span> <span class="s">&#39;1055.05585262*J&#39;</span><span class="p">,</span> <span class="s">&#39;British thermal unit&#39;</span><span class="p">)</span>

<span class="n">_addPrefixedUnit</span><span class="p">(</span><span class="s">&#39;eV&#39;</span><span class="p">)</span>

<span class="c"># Power units</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;    Power units ...................................................... &#39;</span><span class="p">)</span>

<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;hp&#39;</span><span class="p">,</span> <span class="s">&#39;745.7*W&#39;</span><span class="p">,</span> <span class="s">&#39;horsepower&#39;</span><span class="p">)</span>

<span class="c"># Pressure units</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;    Pressure units ................................................... &#39;</span><span class="p">)</span>

<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;bar&#39;</span><span class="p">,</span> <span class="s">&#39;1.e5*Pa&#39;</span><span class="p">,</span> <span class="s">&#39;bar (cgs unit)&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;atm&#39;</span><span class="p">,</span> <span class="s">&#39;101325.*Pa&#39;</span><span class="p">,</span> <span class="s">&#39;standard atmosphere&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;torr&#39;</span><span class="p">,</span> <span class="s">&#39;atm/760&#39;</span><span class="p">,</span> <span class="s">&#39;torr = mm of mercury&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;psi&#39;</span><span class="p">,</span> <span class="s">&#39;6894.75729317*Pa&#39;</span><span class="p">,</span> <span class="s">&#39;pounds per square inch&#39;</span><span class="p">)</span>

<span class="c"># Angle units</span>
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;    Angle units ...................................................... &#39;</span><span class="p">)</span>

<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;deg&#39;</span><span class="p">,</span> <span class="s">&#39;pi*rad/180.&#39;</span><span class="p">,</span> <span class="s">&#39;degrees&#39;</span><span class="p">)</span>

<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;    Temperature units ................................................ &#39;</span><span class="p">)</span>
<span class="c"># Temperature units -- can&#39;t use the &#39;eval&#39; trick that _addUnit provides</span>
<span class="c"># for degC and degF because you can&#39;t add units</span>
<span class="n">Kelvin</span> <span class="o">=</span> <span class="n">_findUnit</span><span class="p">(</span><span class="s">&#39;K&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;degR&#39;</span><span class="p">,</span> <span class="s">&#39;(5./9.)*K&#39;</span><span class="p">,</span> <span class="s">&#39;degrees Rankine&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;degC&#39;</span><span class="p">,</span> <span class="n">PhysicalUnit</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">Kelvin</span><span class="o">.</span><span class="n">powers</span><span class="p">,</span> <span class="mf">273.15</span><span class="p">),</span>
          <span class="s">&#39;degrees Celcius&#39;</span><span class="p">)</span>
<span class="n">_addUnit</span><span class="p">(</span><span class="s">&#39;degF&#39;</span><span class="p">,</span> <span class="n">PhysicalUnit</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="mf">5.</span><span class="o">/</span><span class="mf">9.</span><span class="p">,</span> <span class="n">Kelvin</span><span class="o">.</span><span class="n">powers</span><span class="p">,</span> <span class="mf">459.67</span><span class="p">),</span>
          <span class="s">&#39;degree Fahrenheit&#39;</span><span class="p">)</span>
          
<span class="n">_help</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

<span class="k">del</span> <span class="n">Kelvin</span>

<div class="viewcode-block" id="description"><a class="viewcode-back" href="../../fudge/pqu.html#pqu.physicalQuantityWithUncertainty.description">[docs]</a><span class="k">def</span> <span class="nf">description</span><span class="p">():</span>
	<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">Return a string describing all available units.</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">s</span> <span class="o">=</span> <span class="p">[]</span> <span class="c"># collector for description text</span>

	<span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">_help</span><span class="p">:</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">entry</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
<span class="c">#				s.append(&#39;\n%-s\n&#39; % (&#39;-&#39; * len(entry)) + entry + &#39;\n%-s\n&#39; % (&#39;-&#39; * len(entry)))</span>
				<span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>  <span class="o">+</span> <span class="n">entry</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">pass</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
				<span class="n">name</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">symbol</span><span class="p">,</span> <span class="n">prefixes</span> <span class="o">=</span> <span class="n">entry</span>
			<span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
				<span class="n">name</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">symbol</span> <span class="o">=</span> <span class="n">entry</span>

			<span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;    </span><span class="si">%-26s</span><span class="s"> </span><span class="si">%-32s</span><span class="s"> </span><span class="si">%-s</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">symbol</span><span class="p">))</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="c"># impossible</span>
			<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;wrong construction of _help list&#39;</span><span class="p">)</span>

	<span class="n">entry</span> <span class="o">=</span> <span class="s">&#39;    ------------- ------ --------------</span><span class="se">\n</span><span class="s">    </span><span class="si">%-13s</span><span class="s"> </span><span class="si">%-6s</span><span class="s"> prefixed units</span><span class="se">\n</span><span class="s">    ------------- ------ --------------&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">,</span> <span class="s">&#39;symbol&#39;</span><span class="p">)</span>
<span class="c">#	s.append(&#39;\n%-s\n&#39; % (&#39;-&#39; * len(entry)) + entry + &#39;\n%-s\n&#39; % (&#39;-&#39; * len(entry)))</span>
	<span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>  <span class="o">+</span> <span class="n">entry</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

	<span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">_help</span><span class="p">:</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
			<span class="k">pass</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
				<span class="n">name</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">symbol</span><span class="p">,</span> <span class="n">prefixes</span> <span class="o">=</span> <span class="n">entry</span>
				<span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;    </span><span class="si">%-13s</span><span class="s"> </span><span class="si">%-6s</span><span class="s"> </span><span class="si">%-s</span><span class="se">\n</span><span class="s">    </span><span class="si">%-13s</span><span class="s"> </span><span class="si">%-6s</span><span class="s"> </span><span class="si">%-s</span><span class="se">\n\n</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">symbol</span><span class="p">,</span> <span class="s">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">prefixes</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]),</span> <span class="s">&#39; &#39;</span><span class="p">,</span> <span class="s">&#39; &#39;</span><span class="p">,</span> <span class="s">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">prefixes</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">20</span><span class="p">])))</span>

	<span class="k">return</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

<span class="c"># add the description of the units to the module&#39;s doc string:</span></div>
<span class="n">__doc__</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">+</span> <span class="n">description</span><span class="p">()</span>

<span class="c"># Some demonstration code. Run with &quot;python -i PhysicalQuantityWithUncertainty.py&quot;</span>
<span class="c"># to have this available.</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>

	<span class="n">l</span> <span class="o">=</span> <span class="n">PhysicalQuantityWithUncertainty</span><span class="p">(</span><span class="mf">10.</span><span class="p">,</span> <span class="s">&#39;m&#39;</span><span class="p">)</span>
	<span class="n">big_l</span> <span class="o">=</span> <span class="n">PhysicalQuantityWithUncertainty</span><span class="p">(</span><span class="mf">10.</span><span class="p">,</span> <span class="s">&#39;km&#39;</span><span class="p">)</span>
	<span class="k">print</span> <span class="n">big_l</span> <span class="o">+</span> <span class="n">l</span>

	<span class="n">t</span> <span class="o">=</span> <span class="n">PhysicalQuantityWithUncertainty</span><span class="p">(</span><span class="mf">314159.</span><span class="p">,</span> <span class="s">&#39;s&#39;</span><span class="p">)</span>
	<span class="k">print</span> <span class="n">t</span><span class="o">.</span><span class="n">inUnitsOf</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="s">&#39;h&#39;</span><span class="p">,</span> <span class="s">&#39;min&#39;</span><span class="p">,</span> <span class="s">&#39;s&#39;</span><span class="p">)</span>

	<span class="n">pqu</span> <span class="o">=</span> <span class="n">PhysicalQuantityWithUncertainty</span> <span class="c"># just a shorthand...</span>

	<span class="n">e</span> <span class="o">=</span> <span class="n">pqu</span><span class="p">(</span><span class="s">&#39;2.7 Hartree * Nav&#39;</span><span class="p">)</span>
	<span class="n">e</span><span class="o">.</span><span class="n">convertToUnit</span><span class="p">(</span><span class="s">&#39;kcal/mol&#39;</span><span class="p">)</span>
	<span class="k">print</span> <span class="n">e</span>
	<span class="k">print</span> <span class="n">e</span><span class="o">.</span><span class="n">inBaseUnits</span><span class="p">()</span>

	<span class="n">freeze</span> <span class="o">=</span> <span class="n">pqu</span><span class="p">(</span><span class="s">&#39;0 degC&#39;</span><span class="p">)</span>
	<span class="k">print</span> <span class="n">freeze</span><span class="o">.</span><span class="n">inUnitsOf</span><span class="p">(</span><span class="s">&#39;degF&#39;</span><span class="p">)</span>

	<span class="n">E</span> <span class="o">=</span> <span class="n">pqu</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="s">&#39;MeV/c**2&#39;</span><span class="p">)</span>
	<span class="k">print</span> <span class="n">E</span><span class="o">.</span><span class="n">inUnitsOf</span><span class="p">(</span><span class="s">&#39;kg&#39;</span><span class="p">)</span>

	<span class="c"># This is the similar to the last definition for getValueAs because BRB</span>
	<span class="n">E</span> <span class="o">=</span> <span class="n">pqu</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="s">&#39;MeV/c**2&#39;</span><span class="p">)</span> 
	<span class="n">amu</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">getValueAs</span><span class="p">(</span><span class="s">&#39;amu&#39;</span><span class="p">)</span> <span class="c"># coded it to handle masses and energy as the same thing when needed.</span>

	<span class="n">E2</span> <span class="o">=</span> <span class="n">pqu</span><span class="p">(</span><span class="n">pqu</span><span class="p">(</span><span class="n">amu</span><span class="p">,</span> <span class="s">&#39;amu&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">getValueAs</span><span class="p">(</span><span class="s">&#39;MeV/c**2&#39;</span><span class="p">),</span> <span class="s">&#39;MeV/c**2&#39;</span><span class="p">)</span>
	<span class="k">print</span> <span class="n">E</span><span class="p">,</span> <span class="n">amu</span><span class="p">,</span> <span class="s">&#39;amu&#39;</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">E</span><span class="o">.</span><span class="n">getValueAs</span><span class="p">(</span><span class="s">&#39;kg&#39;</span><span class="p">),</span> <span class="s">&#39;kg&#39;</span><span class="p">,</span> <span class="n">pqu</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;kg&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">getValueAs</span><span class="p">(</span><span class="s">&#39;eV/c**2&#39;</span><span class="p">),</span> <span class="s">&#39;eV/c**2&#39;</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/gnd.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">Fudge and GND 1.2 beta documentation</a> &raquo;</li>
          <li><a href="../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, B.Beck, D. Brown, C. Mattoon, N. Patel, N. Summers.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>